(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0c1d1b"],{4856:function(e,t,l){"use strict";l.r(t);var a=function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"container"},[l("div",{staticClass:"title"},[l("el-breadcrumb",{attrs:{separator:"/"}},[l("el-breadcrumb-item",[e._v("种子管控")]),l("el-breadcrumb-item",{staticClass:"actived"},[e._v("上传原料")])],1)],1),l("div",{staticClass:"box"},[l("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"ruleForm",attrs:{model:e.ruleFormValue,rules:e.rules,"label-width":"100px"}},[l("el-row",[l("el-col",{attrs:{span:6}},[l("el-form-item",{attrs:{label:"输入市，区",prop:"cityId"}},[l("el-select",{attrs:{placeholder:"请选择"},model:{value:e.ruleFormValue.cityId,callback:function(t){e.$set(e.ruleFormValue,"cityId",t)},expression:"ruleFormValue.cityId"}},e._l(e.cityList,(function(e){return l("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1),l("el-col",{attrs:{span:6}},[l("el-form-item",{attrs:{label:"输入乡镇",prop:"townId"}},[l("el-select",{attrs:{placeholder:"请选择"},on:{change:e.getCompanyList},model:{value:e.ruleFormValue.townId,callback:function(t){e.$set(e.ruleFormValue,"townId",t)},expression:"ruleFormValue.townId"}},e._l(e.townList,(function(e){return l("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1)],1),l("el-row",[l("el-col",{attrs:{span:6}},[l("el-form-item",{attrs:{label:"输入村",prop:"villageId"}},[l("el-select",{attrs:{placeholder:"请选择"},model:{value:e.ruleFormValue.villageId,callback:function(t){e.$set(e.ruleFormValue,"villageId",t)},expression:"ruleFormValue.villageId"}},e._l(e.villageList,(function(e){return l("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1),l("el-col",{attrs:{span:6}},[l("el-form-item",{attrs:{label:"输入企业",prop:"companyId"}},[l("el-select",{attrs:{placeholder:"请选择"},model:{value:e.ruleFormValue.companyId,callback:function(t){e.$set(e.ruleFormValue,"companyId",t)},expression:"ruleFormValue.companyId"}},e._l(e.companyProduction,(function(e){return l("el-option",{key:e.companyId,attrs:{label:e.companyName,value:e.companyId}})})),1)],1)],1)],1),l("el-form-item",[l("el-col",{attrs:{span:18}},[l("div",{staticClass:"item",staticStyle:{display:"flex"}},[l("div",{staticClass:"item-label",staticStyle:{"margin-bottom":"20px"}},[l("input",{ref:"file",staticStyle:{display:"none"},attrs:{type:"file",id:"file",accept:".xls, .xlsx"},on:{change:function(t){return e.handleFileUpload()}}}),l("el-button",{attrs:{size:"small",type:"warning",plain:""},on:{click:function(t){return e.chooseFile()}}},[e._v("添加附件")])],1),l("div",{staticClass:"item-value",staticStyle:{"margin-left":"10px",display:"flex","align-items":"center","padding-bottom":"20px"}},[e.file?l("span",[e._v(e._s(e.file.name))]):l("span",[e._v("请选择需要上传的文件...")])])]),l("div",{staticClass:"item",staticStyle:{display:"flex"}},[l("div",{staticClass:"item-label",staticStyle:{"margin-bottom":"20px"}},[l("el-button",{attrs:{size:"small",type:"success",plain:""},on:{click:function(t){return e.downloadFile()}}},[e._v("例文档下载")])],1),l("div",{staticClass:"item-value",staticStyle:{"margin-left":"10px",display:"flex","align-items":"center","padding-bottom":"20px"}},[l("span",[e._v("种子.xlsx")])])])])],1),l("el-form-item",[l("el-button",{attrs:{size:"small",type:"success",plain:""},on:{click:function(t){return e.onSubmit("ruleForm")}}},[e._v("保存")]),l("el-button",{attrs:{size:"small",type:"danger",plain:""},on:{click:function(t){return e.$router.go(-1)}}},[e._v("取消")])],1)],1)],1)])},i=[],n=l("55a1"),o=l("d1a0"),s=l("bc3a"),r=l.n(s),c={name:"uploadSeed",data:function(){return{file:null,cityList:[],villageList:[],townList:[],companyProduction:[],listLoading:!1,ruleFormValue:{cityId:null,townId:"",villageId:null,companyId:""},rules:{cityId:[{required:!0,message:"请选择",trigger:"change"}],townId:[{required:!0,message:"请选择"}],villageId:[{required:!0,message:"请选择"}],companyId:[{required:!0,message:"请选择",trigger:"change"}]}}},created:function(){this.getCity(),this.getVillage(),this.getTown()},methods:{getCity:function(){var e=this;this.listLoading=!0,Object(n["a"])().get("/api/city/all").then((function(t){setTimeout((function(){e.listLoading=!1}),50),e.cityList=t})).catch((function(e){console.log(e)}))},getVillage:function(){var e=this;this.listLoading=!0,Object(n["a"])().get("/api/village/all").then((function(t){setTimeout((function(){e.listLoading=!1}),50),e.villageList=t})).catch((function(e){console.log(e)}))},getTown:function(){var e=this;this.listLoading=!0,Object(n["a"])().get("/api/town/all").then((function(t){setTimeout((function(){e.listLoading=!1}),50),e.townList=t})).catch((function(e){console.log(e)}))},getCompany:function(){var e=this;this.listLoading=!0,Object(n["a"])().get("/api/company_production/all",{townId:this.ruleFormValue.townId,sortBy:"companyId"}).then((function(t){setTimeout((function(){e.listLoading=!1}),50),e.companyProduction=t.data})).catch((function(e){console.log(e)}))},getCompanyList:function(){this.getCompany()},onSubmit:function(e){var t=this;this.$refs[e].validate((function(e){if(e){t.listLoading=!0;var l=new FormData;l=t.makeFormData(),t.listLoading=!0,Object(n["a"])().post("/api/seed/create",l).then((function(e){setTimeout((function(){t.listLoading=!1}),500),t.$router.push({path:"/seed"})})).catch((function(e){console.log(e)}))}}))},makeFormData:function(){var e=new FormData;return this.file&&e.append("file",this.file),e.append("id",0),e.append("cityId",this.ruleFormValue.cityId),e.append("companyId",this.ruleFormValue.companyId),e.append("townId",this.ruleFormValue.townId),e.append("villageId",this.ruleFormValue.villageId),e},chooseFile:function(){this.$refs.file.click()},handleFileUpload:function(){this.file=this.$refs.file.files[0]},downloadFile:function(){var e=this,t="/uploads/default.xlsx";r()({url:o["b"].DOWNLOAD_URL()+t,method:"GET",responseType:"blob"}).then((function(l){if(e.isIE()){var a=new Blob([l.data],{type:"application/octet-stream"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)return void window.navigator.msSaveOrOpenBlob(a,t.replace("/uploads/",""))}else{var i=window.URL.createObjectURL(new Blob([l.data])),n=document.createElement("a");n.href=i,n.setAttribute("download",t.replace("/uploads/","")),document.body.appendChild(n),n.click(),n.remove()}}))},isIE:function(){var e=navigator.userAgent;return e.indexOf("MSIE ")>-1||e.indexOf("Trident/")>-1}}},u=c,d=l("2877"),m=Object(d["a"])(u,a,i,!1,null,null,null);t["default"]=m.exports}}]);
//# sourceMappingURL=chunk-2d0c1d1b.813ca620.js.map
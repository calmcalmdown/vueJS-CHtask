(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1741a52e"],{"671a":function(e,t,l){"use strict";l.r(t);var r=function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"container"},[l("div",{staticClass:"title"},[l("el-breadcrumb",{attrs:{separator:"/"}},[l("el-breadcrumb-item",[e._v("监管记录")]),l("el-breadcrumb-item",{staticClass:"actived"},[e._v("添加监管记录")])],1)],1),l("div",{staticClass:"box"},[l("el-dialog",{attrs:{visible:e.dialogVisible,width:"30%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[l("span",[l("i",{staticClass:"el-icon-warning"},[e._v(" 请选择图片 !!!")])]),l("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{attrs:{size:"small",type:"primary",plain:""},on:{click:function(t){e.dialogVisible=!1}}},[e._v("Cancel")])],1)]),l("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"ruleForm",attrs:{model:e.ruleFormValue,rules:e.rules}},[l("el-row",[l("el-col",{attrs:{span:12}},[l("el-form-item",{attrs:{prop:"companyType"}},[l("el-radio-group",{model:{value:e.ruleFormValue.companyType,callback:function(t){e.$set(e.ruleFormValue,"companyType",t)},expression:"ruleFormValue.companyType"}},[l("el-radio",{attrs:{label:"1"}},[e._v("企业")]),l("el-radio",{attrs:{label:"2"}},[e._v("农户")])],1)],1)],1)],1),l("el-row",[l("el-col",{attrs:{span:6}},[l("el-form-item",{attrs:{label:"乡镇",prop:"townShip"}},[l("el-select",{attrs:{placeholder:"请选择"},model:{value:e.ruleFormValue.townShip,callback:function(t){e.$set(e.ruleFormValue,"townShip",t)},expression:"ruleFormValue.townShip"}},e._l(e.township,(function(e){return l("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1),l("el-col",{attrs:{span:6}},[l("el-form-item",{attrs:{label:"企业",prop:"companyID"}},[l("el-select",{attrs:{placeholder:"请选择"},model:{value:e.ruleFormValue.companyID,callback:function(t){e.$set(e.ruleFormValue,"companyID",t)},expression:"ruleFormValue.companyID"}},e._l(e.companyList,(function(e){return l("el-option",{key:e.companyId,attrs:{label:e.companyName,value:e.companyId}})})),1)],1)],1),l("el-col",{attrs:{span:6}},[l("el-form-item",{attrs:{label:"选择日期",prop:"date"}},[l("el-date-picker",{attrs:{align:"right",type:"date",placeholder:"选择日期"},model:{value:e.ruleFormValue.date,callback:function(t){e.$set(e.ruleFormValue,"date",t)},expression:"ruleFormValue.date"}})],1)],1),l("el-col",{attrs:{span:6}},[l("el-form-item",{attrs:{label:"检查人",prop:"checker"}},[l("el-input",{staticStyle:{width:"60%"},model:{value:e.ruleFormValue.checker,callback:function(t){e.$set(e.ruleFormValue,"checker",t)},expression:"ruleFormValue.checker"}})],1)],1)],1),l("div",{staticClass:"bg-blue"},[e._v("检查内容与结果")]),l("el-row",[l("el-col",{attrs:{span:5}},[l("el-form-item",{attrs:{label:""}},[l("div",{staticClass:"left-margin"},[e._v("生产记录(种养殖档案)")])])],1),l("el-col",{attrs:{span:5}},[l("el-form-item",{attrs:{label:""}},[l("el-radio-group",{model:{value:e.ruleFormValue.productionRecord,callback:function(t){e.$set(e.ruleFormValue,"productionRecord",t)},expression:"ruleFormValue.productionRecord"}},[l("el-radio",{attrs:{label:"1"}},[e._v("有")]),l("el-radio",{attrs:{label:"2"}},[e._v("真实完整")])],1)],1)],1),l("el-col",{attrs:{span:5}},[l("el-form-item",{attrs:{label:""}},[l("div",{staticClass:"left-margin"},[e._v("农产品产地准出证明(销售记录)")])])],1),l("el-col",{attrs:{span:5}},[l("el-form-item",{attrs:{label:""}},[l("el-radio-group",{model:{value:e.ruleFormValue.proofOfProduct,callback:function(t){e.$set(e.ruleFormValue,"proofOfProduct",t)},expression:"ruleFormValue.proofOfProduct"}},[l("el-radio",{attrs:{label:"1"}},[e._v("有")]),l("el-radio",{attrs:{label:"2"}},[e._v("真实完整")])],1)],1)],1)],1),l("el-row",[l("el-col",{attrs:{span:5}},[l("el-form-item",{attrs:{label:""}},[l("div",{staticClass:"left-margin"},[e._v("农产品产投入品记录（进、销、使用）")])])],1),l("el-col",{attrs:{span:5}},[l("el-form-item",{attrs:{label:""}},[l("el-radio-group",{model:{value:e.ruleFormValue.productInputRecord,callback:function(t){e.$set(e.ruleFormValue,"productInputRecord",t)},expression:"ruleFormValue.productInputRecord"}},[l("el-radio",{attrs:{label:"1"}},[e._v("有")]),l("el-radio",{attrs:{label:"2"}},[e._v("真实完整")])],1)],1)],1),l("el-col",{attrs:{span:5}},[l("el-form-item",{attrs:{label:""}},[l("div",{staticClass:"left-margin"},[e._v("检验记录")])])],1),l("el-col",{attrs:{span:5}},[l("el-form-item",{attrs:{label:""}},[l("el-radio-group",{model:{value:e.ruleFormValue.testRecord,callback:function(t){e.$set(e.ruleFormValue,"testRecord",t)},expression:"ruleFormValue.testRecord"}},[l("el-radio",{attrs:{label:"1"}},[e._v("有")]),l("el-radio",{attrs:{label:"2"}},[e._v("真实完整")])],1)],1)],1)],1),l("el-row",[l("el-col",{attrs:{span:5}},[l("el-form-item",{attrs:{label:""}},[l("div",{staticClass:"left-margin"},[e._v("禁用投入品及滥用添加剂行为")])])],1),l("el-col",{attrs:{span:5}},[l("el-form-item",{attrs:{label:""}},[l("el-checkbox",{attrs:{"true-label":"1","false-label":"0"},model:{value:e.ruleFormValue.isDisableInput,callback:function(t){e.$set(e.ruleFormValue,"isDisableInput",t)},expression:"ruleFormValue.isDisableInput"}},[e._v("有")])],1)],1),l("el-col",{attrs:{span:5}},[l("el-form-item",{attrs:{label:""}},[l("div",{staticClass:"left-margin"},[e._v("“三品一标使用”")])])],1),l("el-col",{attrs:{span:5}},[l("el-form-item",{attrs:{label:""}},[l("el-checkbox",{attrs:{"true-label":"1","false-label":"0"},model:{value:e.ruleFormValue.isThreeProduct,callback:function(t){e.$set(e.ruleFormValue,"isThreeProduct",t)},expression:"ruleFormValue.isThreeProduct"}},[e._v("合规")])],1)],1)],1),l("el-row",[l("el-col",{attrs:{span:10}},[l("el-form-item",{staticClass:"left-margin",attrs:{label:"常用语",prop:"commonLang"}},[l("el-select",{attrs:{multiple:"",placeholder:"请插入"},model:{value:e.wordValue,callback:function(t){e.wordValue=t},expression:"wordValue"}},e._l(e.wordsList,(function(e){return l("el-option",{key:e.id,attrs:{label:e.word,value:e.word}})})),1)],1)],1),l("el-col",{attrs:{span:5}},[l("el-form-item",[l("div",{staticClass:"left-margin"},[e._v("现场发现的其他问题")])])],1),l("el-col",{attrs:{span:8}},[l("el-form-item",{attrs:{prop:"otherProblems"}},[l("el-input",{attrs:{type:"textarea",rows:5},model:{value:e.ruleFormValue.otherProblems,callback:function(t){e.$set(e.ruleFormValue,"otherProblems",t)},expression:"ruleFormValue.otherProblems"}})],1)],1)],1),l("el-row",[l("el-col",{attrs:{span:12}},[l("div",{staticClass:"left-margin"},[l("table",[l("tbody",[l("tr",[l("td",{attrs:{rowspan:"2"}},[e._v("结论")]),l("td",[e._v("合格")]),l("td",[l("el-checkbox",{attrs:{"true-label":"1","false-label":"0"},model:{value:e.ruleFormValue.conclusion,callback:function(t){e.$set(e.ruleFormValue,"conclusion",t)},expression:"ruleFormValue.conclusion"}})],1)]),l("tr",[l("td",[e._v("不合格")]),l("td",[l("table",{staticClass:"no-border"},[l("tbody",[l("tr",[l("td",[e._v("责令修改")]),l("td",[l("el-input",{staticStyle:{width:"100%"},attrs:{disabled:1==e.ruleFormValue.conclusion},model:{value:e.ruleFormValue.orderToAmend,callback:function(t){e.$set(e.ruleFormValue,"orderToAmend",t)},expression:"ruleFormValue.orderToAmend"}})],1)]),l("tr",[l("td",[e._v("建议处罚")]),l("td",[l("el-input",{staticStyle:{width:"100%"},attrs:{disabled:1==e.ruleFormValue.conclusion},model:{value:e.ruleFormValue.recommendPunishment,callback:function(t){e.$set(e.ruleFormValue,"recommendPunishment",t)},expression:"ruleFormValue.recommendPunishment"}})],1)]),l("tr",[l("td",[e._v("其他处理")]),l("td",[l("el-input",{staticStyle:{width:"100%"},attrs:{disabled:1==e.ruleFormValue.conclusion},model:{value:e.ruleFormValue.otherProcessing,callback:function(t){e.$set(e.ruleFormValue,"otherProcessing",t)},expression:"ruleFormValue.otherProcessing"}})],1)])])])])])])])])]),l("el-col",{attrs:{span:11}},[l("table",{staticClass:"image-upload-table"},[l("tbody",[l("tr",[l("td",[e._v("现场图片")]),l("td",[l("div",{staticClass:"img-container",on:{click:function(t){return e.chooseFile_Live()}}},e._l(e.images,(function(e){return l("img",{key:e,staticClass:"preview",attrs:{src:e}})})),0),l("p",[e._v(e._s(e.fileName))]),l("div",{staticClass:"image-box"},[l("input",{ref:"file_live_1",staticClass:"image-upload",staticStyle:{display:"none"},attrs:{type:"file",id:"file",accept:"image/*",name:"images"},on:{change:function(t){return e.handleFileUpload_Live()}}})])])]),l("tr",[l("td",[e._v("签名")]),l("td",[l("div",{staticClass:"img-container",on:{click:function(t){return e.chooseFile_Sign()}}},e._l(e.signs,(function(e){return l("img",{key:e,staticClass:"preview",attrs:{src:e}})})),0),l("p",[e._v(e._s(e.signName))]),l("div",{staticClass:"image-box"},[l("input",{ref:"file_sign",staticClass:"image-upload",staticStyle:{display:"none"},attrs:{type:"file",id:"file1",accept:"image/*",name:"signs"},on:{change:function(t){return e.handleFileUpload_Sign()}}})])])])])])])],1),l("el-form-item",{staticClass:"left-margin"},[l("el-button",{attrs:{size:"small",type:"success",plain:""},on:{click:function(t){return e.onSubmit("ruleForm")}}},[e._v("保存")]),l("el-button",{attrs:{size:"small",type:"danger",plain:""},on:{click:function(t){return e.$router.go(-1)}}},[e._v("取消")])],1)],1)],1)])},a=[],o=(l("a481"),l("7f7f"),l("96cf"),l("3b8d")),i=l("55a1"),s=(l("d1a0"),l("0010")),n={data:function(){return{images:[],fileName:"",signs:[],signName:"",listLoading:!1,ruleFormValue:{companyType:"1",townShip:"",companyID:"",date:"",checker:"",productionRecord:"1",productInputRecord:"1",proofOfProduct:"1",testRecord:"1",isDisableInput:"1",isThreeProduct:"1",commonLang:"",otherProblems:"",conclusion:"1",orderToAmend:"",recommendPunishment:"",otherProcessing:""},township:[],companyList:[],imageUrl_Live:"",imageUrl_Sign:"",file_live_1:null,file_sign:null,wordsList:[],wordValue:0,dialogVisible:!1,rules:{townShip:[{required:!0,message:"请选择",trigger:"change"}],companyID:[{required:!0,message:"请选择",trigger:"change"}],date:[{required:!0,message:"请选择",trigger:"change"}],checker:[{required:!0,message:"请插入",trigger:"change"}],otherProblems:[{required:!0,message:"请插入",trigger:"change"}]}}},created:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getTown();case 2:return e.next=4,this.getCompanyProduct();case 4:this.getWords();case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),methods:{getTown:function(){var e=this;return this.listLoading=!0,Object(i["a"])().get("/api/town/all").then((function(t){e.township=e.township.concat(t)})).catch((function(e){console.log(e)}))},getCompanyProduct:function(){var e=this;return Object(i["a"])().get("/api/company_production/name").then((function(t){e.companyList=e.companyList.concat(t)})).catch((function(e){console.log(e)}))},onSubmit:function(e){var t=this;this.$refs[e].validate((function(e){if(e){t.listLoading=!0;var l=new FormData;l=t.makeFormData(),Object(i["a"])().post("/api/supervision_record/create",l).then((function(e){setTimeout((function(){t.listLoading=!1}),500),t.$router.push({path:"/regulatoryRecord"})})).catch((function(e){}))}}))},makeFormData:function(){var e=new FormData,t=1==this.ruleFormValue.conclusion?{order:" ",suggestion:" ",others:" "}:{order:this.ruleFormValue.orderToAmend?this.ruleFormValue.orderToAmend:" ",suggestion:this.ruleFormValue.recommendPunishment?this.ruleFormValue.recommendPunishment:" ",others:this.ruleFormValue.otherProcessing?this.ruleFormValue.otherProcessing:" "};t=JSON.stringify(t);var l={production:this.ruleFormValue.productionRecord,input:this.ruleFormValue.isDisableInput,abuse:this.ruleFormValue.proofOfProduct,origin:this.ruleFormValue.testRecord,inspection:this.ruleFormValue.productInputRecord,standard:this.ruleFormValue.isThreeProduct};return l=JSON.stringify(l),e.append("companyId",this.ruleFormValue.companyID),e.append("conclusion",this.ruleFormValue.conclusion),e.append("conclusionFalseInfo",t),e.append("createTime",this.ruleFormValue.date),e.append("inspector",this.ruleFormValue.checker),e.append("otherProblems",this.ruleFormValue.otherProblems),e.append("productionSubjectType",this.ruleFormValue.companyType),e.append("supervisionInfo",l),e.append("townId",this.ruleFormValue.townShip),e.append("createUserId",Object(s["a"])().user().id),e.append("id",0),e.append("scenePhotos",""),e.append("sign",""),e.append("supervisionRecordTime",this.ruleFormValue.date),e.append("updateTime",this.ruleFormValue.date),e.append("updateUserId",Object(s["a"])().user().id),e.append("usefulExpressions",this.selectWords(this.wordValue)),e.append("scenePhotoFile",this.file_live_1),e.append("signFile",this.file_sign),e},chooseFile_Live:function(){document.getElementById("file").click()},chooseFile_Sign:function(){document.getElementById("file1").click()},handleFileUpload_Live:function(e){this.file_live_1=this.$refs.file_live_1.files[0],this.images=[];var t=new FileReader,l=this;t.onload=function(e){l.images.push(e.target.result)},this.file_live_1?(t.readAsDataURL(this.file_live_1),this.fileName=this.file_live_1.name):this.fileName=""},handleFileUpload_Sign:function(){this.file_sign=this.$refs.file_sign.files[0],this.signs=[];var e=new FileReader,t=this;e.onload=function(e){t.signs.push(e.target.result)},this.file_sign?(e.readAsDataURL(this.file_sign),this.signName=this.file_sign.name):this.signName=""},getWords:function(){var e=this;return Object(i["a"])().get("/api/common_word/all",{sortBy:"id"}).then((function(t){e.wordsList=e.wordsList.concat(t.data),setTimeout((function(){e.listLoading=!1}),500)})).catch((function(e){console.log(e)}))},selectWords:function(e){var t=JSON.stringify(e);return t=t.substr(2,t.length-4),t=t.replace('","',","),t}}},u=n,c=(l("c8ed"),l("2877")),m=Object(c["a"])(u,r,a,!1,null,null,null);t["default"]=m.exports},"71f6":function(e,t,l){},c8ed:function(e,t,l){"use strict";var r=l("71f6"),a=l.n(r);a.a}}]);
//# sourceMappingURL=chunk-1741a52e.b74ed48b.js.map
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-018002a6"],{"267c":function(a,t,e){"use strict";var i=e("afd2"),d=e.n(i);d.a},afd2:function(a,t,e){},d3d4:function(a,t,e){"use strict";e.r(t);var i=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"container"},[e("div",{staticClass:"title"},[e("el-breadcrumb",{attrs:{separator:"/"}},[e("el-breadcrumb-item",{staticClass:"actived"},[a._v("评级详情")])],1)],1),e("div",{staticClass:"box"},[a.data?e("el-form",{directives:[{name:"loading",rawName:"v-loading",value:a.updateLoading,expression:"updateLoading"}]},[e("div",{staticClass:"item-row"},[e("div",{staticClass:"item"},[e("div",{staticClass:"item-label"},[a._v("状态")]),e("div",{staticClass:"item-value"},[a._v(a._s(a.allStatus[a.data.approvalStatus]))])])]),e("div",{staticClass:"item-row"},[e("div",{staticClass:"item inline-block-IE"},[e("div",{staticClass:"item-label"},[a._v("评级时间")]),e("div",{staticClass:"item-value"},[a._v(a._s(a._f("formatDate")(a.data.gradeTime)))])]),e("div",{staticClass:"item inline-block-IE"},[e("div",{staticClass:"item-label"},[a._v("名称")]),e("div",{staticClass:"item-value"},[a._v(a._s(a.companyName))])])]),e("div",{staticClass:"item-row"},[e("div",{staticClass:"item"},[e("div",{staticClass:"item-label"},[a._v("原信用评级")]),e("div",{staticClass:"item-value"},[a._v(a._s(a.options[a.grades.indexOf(a.data.originalGrade)]))])])]),e("div",{staticClass:"item-row"},[e("div",{staticClass:"item"},[e("div",{staticClass:"item-label"},[a._v("现信用评级")]),e("div",{staticClass:"item-value"},[e("el-select",{attrs:{placeholder:"请选择",disabled:""},model:{value:a.data.approvalGrade,callback:function(t){a.$set(a.data,"approvalGrade",t)},expression:"data.approvalGrade"}},a._l(a.options,(function(t,i){return e("el-option",{key:t,attrs:{label:t,value:a.grades[i]}})})),1)],1)])]),e("div",{staticClass:"item-row"},[e("div",{staticClass:"item"},[e("div",{staticClass:"item-label"},[a._v("评级单位")]),e("div",{staticClass:"item-value"},[a._v(a._s(a.data.gradeUnit))])])]),e("div",{staticClass:"item-row"},[e("div",{staticClass:"item"},[e("div",{staticClass:"item-label"},[e("input",{ref:"file",staticStyle:{display:"none"},attrs:{type:"file",id:"file"},on:{change:function(t){return a.handleFileUpload()}}}),e("el-button",{attrs:{size:"small",type:"warning",plain:"",disabled:!a.data.uploadFileName},on:{click:function(t){return a.downloadFile()}}},[a._v("下载附件")])],1),!a.file&&a.data.uploadFileName?e("div",{staticClass:"item-value"},[e("el-link",{on:{click:function(t){return a.downloadFile()}}},[a._v("\n              "+a._s(a.data.uploadFileName.replace("/uploads/",""))+"\n            ")])],1):a._e(),a.file?e("div",{staticClass:"item-value"},[a._v(a._s(a.file.name))]):a._e()])]),e("div",{staticClass:"item-row"},[e("div",{staticClass:"item"},[e("div",{staticClass:"item-value"},[e("el-button",{attrs:{size:"small",type:"success",plain:"",disabled:0!=a.data.approvalStatus},on:{click:function(t){return a.assignGrade()}}},[a._v("同意")]),e("el-button",{attrs:{size:"small",type:"danger",plain:"",disabled:0!=a.data.approvalStatus},on:{click:function(t){return a.rejectGrade()}}},[a._v("拒绝")]),e("el-button",{attrs:{size:"small",type:"danger",plain:""},on:{click:function(t){return a.$router.go(-1)}}},[a._v("返回")])],1)])])]):a._e(),a.data?a._e():e("el-form",[a._v("装货...")])],1)])},d=[],s=(e("a481"),e("7f7f"),e("55a1")),n=e("d1a0"),l=e("bc3a"),r=e.n(l),o={name:"EditRating",data:function(){return{updateLoading:!1,id:-1,file:null,pageName:this.$route.name,data:null,grades:["A","B","C"],options:["A级（守信）","B级（基本守信）","C级（失信）"],allStatus:["待审批","已通过","已拒绝"],companyName:"",is_ie:null}},created:function(){this.isIE(),this.companyName=this.$route.query.company,this.id=this.$route.params.id,this.getData(this.$route.params.id)},methods:{getData:function(a){var t=this;Object(s["a"])().get("/api/company_credit_grade/get/"+a).then((function(a){t.data=a})).catch((function(a){console.log(a)}))},chooseFile:function(){this.$refs.file.click()},handleFileUpload:function(){this.file=this.$refs.file.files[0]},assignGrade:function(){var a=this;this.updateLoading=!0;var t=new FormData;t.append("updatedNowGrade",this.data.approvalGrade),t.append("id",this.data.creditGradeId),t.append("approvalGrade",this.data.approvalGrade),t.append("originGrade",this.data.nowGrade),t.append("approvalStatus",1),this.file&&t.append("file",this.file),t.append("data",this.data),Object(s["a"])().put("/api/company_credit_grade/update/"+this.data.creditGradeId,t).then((function(t){a.saveChangeUpdateGrade(1,a.data.approvalGrade)})).catch((function(a){}))},rejectGrade:function(){var a=this;this.updateLoading=!0;var t=new FormData;t.append("updatedNowGrade",this.data.nowGrade),t.append("id",this.data.creditGradeId),t.append("approvalGrade",this.data.nowGrade),t.append("originGrade",this.data.originGrade),t.append("approvalStatus",2),this.file&&t.append("file",this.file),t.append("data",this.data),Object(s["a"])().put("/api/company_credit_grade/update/"+this.data.creditGradeId,t).then((function(t){a.saveChangeUpdateGrade(2,a.data.nowGrade)})).catch((function(a){}))},saveChangeUpdateGrade:function(a,t){var e=this,i=[];i.push({approvalStatus:2,creditCode:this.data.creditCode,grade:this.data.nowGrade}),Object(s["a"])().put("/api/company_production/updateGrade/"+this.data.creditCode+"?approvalStatus="+a+"&grade"+t).then((function(a){e.updateLoading=!1,e.$router.push({path:"/creditRating"})})).catch((function(a){}))},downloadFile:function(){var a=this;r()({url:n["b"].DOWNLOAD_URL()+this.data.uploadFileName,method:"GET",responseType:"blob"}).then((function(t){if(a.is_ie){var e=new Blob([t.data],{type:"application/octet-stream"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)return void window.navigator.msSaveOrOpenBlob(e,a.data.uploadFileName.replace("/uploads/",""))}else{var i=window.URL.createObjectURL(new Blob([t.data])),d=document.createElement("a");d.href=i,d.setAttribute("download",a.data.uploadFileName.replace("/uploads/","")),document.body.appendChild(d),d.click(),d.remove()}}))},isIE:function(){var a=navigator.userAgent;this.is_ie=a.indexOf("MSIE ")>-1||a.indexOf("Trident/")>-1}}},c=o,p=(e("267c"),e("2877")),u=Object(p["a"])(c,i,d,!1,null,"7fa5bd99",null);t["default"]=u.exports}}]);
//# sourceMappingURL=chunk-018002a6.018cfd93.js.map
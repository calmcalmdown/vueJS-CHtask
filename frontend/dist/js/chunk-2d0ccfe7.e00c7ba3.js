(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0ccfe7"],{"4ffe":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container"},[r("div",{staticClass:"title"},[r("el-breadcrumb",{attrs:{separator:"/"}},[r("el-breadcrumb-item",[e._v("工作任务")]),r("el-breadcrumb-item",{staticClass:"actived"},[e._v("汇报任务")])],1)],1),e.workData?r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticClass:"box"},[r("el-row",{staticClass:"w-100 text-center margin-bottom-30"},[r("el-col",[r("h1",{staticClass:"middle-font"},[e._v(e._s(e.workData.title))])])],1),r("el-row",{staticClass:"w-100 text-center margin-bottom-30 flex-justify-center"},[r("el-col",{attrs:{span:5}},[e._v("发布日期："+e._s(e._f("formatDate")(e.workData.releaseTime)))]),r("el-col",{attrs:{span:5}},[e._v("发布者："+e._s(e.workData.releasePerson))])],1),r("el-row",{staticClass:"w-100 text-center flex-justify-center margin-bottom-30"},[r("el-col",{attrs:{span:12}},[e._v(e._s(e.workData.content))])],1),e.workData.workTaskProfiles?r("el-row",{staticClass:"w-100 flex-justify-center margin-bottom-30"},[r("el-col",{attrs:{span:12}},[r("el-button",{attrs:{size:"small",type:"warning",plain:""},on:{click:function(t){return e.downloadFile()}}},[e._v("附件下载")]),r("span",{staticClass:"margin-left-20"},[e._v(e._s(e.workData.workTaskProfiles.replace("/uploads/","")))])],1)],1):e._e(),r("el-row",{staticClass:"margin-bottom-30"},[r("el-col",{staticClass:"middle-font margin-left-20"},[e._v("工作任务汇报")])],1),r("el-form",{ref:"ruleForm",attrs:{model:e.ruleFormValue,rules:e.rules,"label-width":"100px"}},[r("el-row",[r("el-col",{attrs:{span:4}},[r("el-form-item",{attrs:{label:"汇报日期：",prop:"reportTime"}},[r("el-date-picker",{staticClass:"w-100",attrs:{align:"right",type:"date",placeholder:"汇报日期"},model:{value:e.ruleFormValue.reportTime,callback:function(t){e.$set(e.ruleFormValue,"reportTime",t)},expression:"ruleFormValue.reportTime"}})],1)],1),r("el-col",{attrs:{span:4}},[r("el-form-item",{attrs:{label:"汇报单位：",prop:"townId"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.ruleFormValue.townId,callback:function(t){e.$set(e.ruleFormValue,"townId",t)},expression:"ruleFormValue.townId"}},e._l(e.township,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1),r("el-col",{attrs:{span:4}},[r("el-form-item",{attrs:{label:"汇报人：",prop:"reportPerson"}},[r("el-input",{model:{value:e.ruleFormValue.reportPerson,callback:function(t){e.$set(e.ruleFormValue,"reportPerson",t)},expression:"ruleFormValue.reportPerson"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"汇报内容：",prop:"reportContent"}},[r("el-input",{attrs:{type:"textarea",rows:10},model:{value:e.ruleFormValue.reportContent,callback:function(t){e.$set(e.ruleFormValue,"reportContent",t)},expression:"ruleFormValue.reportContent"}})],1)],1)],1),r("el-form-item",{staticClass:"left-margin"},[r("el-button",{attrs:{size:"small",type:"success",plain:""},on:{click:function(t){return e.onSubmit("ruleForm")}}},[e._v("保存")]),r("el-button",{attrs:{size:"small",type:"primary",plain:""},on:{click:function(t){return e.$router.go(-1)}}},[e._v("取消")])],1)],1)],1):r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.pageLoading,expression:"pageLoading"}],staticClass:"box"},[r("div",[e._v("装货...")])])])},o=[],n=(r("a481"),r("55a1")),l=r("d1a0"),s=r("0010"),i=r("bc3a"),u=r.n(i),c={name:"addWorkTaskReport",data:function(){return{file:null,selectedId:null,workData:null,township:[],listLoading:!1,pageLoading:!0,ruleFormValue:{townId:"-1",reportPerson:"",title:"",reportTime:""},rules:{townId:[{required:!0,message:"请选择",trigger:"change"}],reportPerson:[{required:!0,message:"请插入",trigger:"change"}],reportTime:[{required:!0,message:"请选择",trigger:"change"}],reportContent:[{required:!0,message:"请插入",trigger:"change"}]}}},created:function(){this.selectedId=this.$route.query.id,this.getData(this.$route.query.id),this.getTown(),this.ruleFormValue.townId=Object(s["a"])().user().townId?Object(s["a"])().user().townId:""},methods:{getData:function(e){var t=this;Object(n["a"])().get("/api/work_task/get/"+e).then((function(e){t.workData=e})).catch((function(e){console.log(e)}))},getTown:function(){var e=this;Object(n["a"])().get("/api/town/all").then((function(t){e.township=e.township.concat(t)})).catch((function(e){console.log(e)}))},onSubmit:function(e){var t=this;this.$refs[e].validate((function(e){if(e){t.listLoading=!0;var r=new FormData;r=t.makeFormData(),Object(n["a"])().post("/api/work_task_report/create",r).then((function(e){setTimeout((function(){t.listLoading=!1}),500),t.$router.push({path:"/workTask"})})).catch((function(e){console.log(e)}))}}))},makeFormData:function(){var e=new FormData;e.append("id",0),this.ruleFormValue.reportTime=new Date(this.ruleFormValue.reportTime).toDateString("YYYY-MM-DD"),e.append("reportContent",this.ruleFormValue.reportContent),e.append("reportPerson",this.ruleFormValue.reportPerson),e.append("townId",this.ruleFormValue.townId),e.append("reportTime",this.ruleFormValue.reportTime);var t=(new Date).toDateString("YYYY-MM-DD");return e.append("createTime",t),e.append("workTaskId",this.selectedId),e},downloadFile:function(){var e=this;u()({url:l["b"].DOWNLOAD_URL()+this.workData.workTaskProfiles,method:"GET",responseType:"blob"}).then((function(t){if(e.isIE()){var r=new Blob([t.data],{type:"application/octet-stream"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)return void window.navigator.msSaveOrOpenBlob(r,e.workData.workTaskProfiles.replace("/uploads/",""))}else{var a=window.URL.createObjectURL(new Blob([t.data])),o=document.createElement("a");o.href=a,o.setAttribute("download",e.workData.workTaskProfiles.replace("/uploads/","")),document.body.appendChild(o),o.click(),o.remove()}}))},isIE:function(){var e=navigator.userAgent;return e.indexOf("MSIE ")>-1||e.indexOf("Trident/")>-1}}},p=c,d=r("2877"),m=Object(d["a"])(p,a,o,!1,null,null,null);t["default"]=m.exports}}]);
//# sourceMappingURL=chunk-2d0ccfe7.e00c7ba3.js.map
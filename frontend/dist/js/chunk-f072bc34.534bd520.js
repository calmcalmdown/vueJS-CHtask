(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f072bc34","chunk-6051483f","chunk-2d0e2754"],{"062e":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"pagination-container",class:{hidden:e.hidden}},[a("el-pagination",e._b({attrs:{background:e.background,"current-page":e.currentPage,"page-size":e.pageSize,layout:e.layout,"page-sizes":e.pageSizes,total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}},"el-pagination",e.$attrs,!1))],1)},i=[];a("c5f6");Math.easeInOutQuad=function(e,t,a,n){return e/=n/2,e<1?a/2*e*e+t:(e--,-a/2*(e*(e-2)-1)+t)};var r=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();function o(e){document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e}function l(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function s(e,t,a){var n=l(),i=e-n,s=20,c=0;t="undefined"===typeof t?500:t;var d=function e(){c+=s;var l=Math.easeInOutQuad(c,n,i,t);o(l),c<t?r(e):a&&"function"===typeof a&&a()};d()}var c={name:"Pagination",props:{total:{required:!0,type:Number},page:{type:Number,default:1},limit:{type:Number,default:20},pageSizes:{type:Array,default:function(){return[5,10,20,30,50]}},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},computed:{currentPage:{get:function(){return this.page},set:function(e){this.$emit("update:page",e)}},pageSize:{get:function(){return this.limit},set:function(e){this.$emit("update:limit",e)}}},methods:{handleSizeChange:function(e){this.$emit("update:limit",e),this.$emit("pagination",{page:this.currentPage,limit:e}),this.autoScroll&&s(0,800)},handleCurrentChange:function(e){this.$emit("update:page",e),this.$emit("pagination",{page:e,limit:this.pageSize}),this.autoScroll&&s(0,800)}}},d=c,u=(a("8367"),a("2877")),p=Object(u["a"])(d,n,i,!1,null,null,null);t["default"]=p.exports},"0706":function(module,exports){var indexOf=function(e,t){if(e.indexOf)return e.indexOf(t);for(var a=0;a<e.length;a++)if(e[a]===t)return a;return-1},Object_keys=function(e){if(Object.keys)return Object.keys(e);var t=[];for(var a in e)t.push(a);return t},forEach=function(e,t){if(e.forEach)return e.forEach(t);for(var a=0;a<e.length;a++)t(e[a],a,e)},defineProp=function(){try{return Object.defineProperty({},"_",{}),function(e,t,a){Object.defineProperty(e,t,{writable:!0,enumerable:!1,configurable:!0,value:a})}}catch(e){return function(e,t,a){e[t]=a}}}(),globals=["Array","Boolean","Date","Error","EvalError","Function","Infinity","JSON","Math","NaN","Number","Object","RangeError","ReferenceError","RegExp","String","SyntaxError","TypeError","URIError","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","eval","isFinite","isNaN","parseFloat","parseInt","undefined","unescape"];function Context(){}Context.prototype={};var Script=exports.Script=function(e){if(!(this instanceof Script))return new Script(e);this.code=e};Script.prototype.runInContext=function(e){if(!(e instanceof Context))throw new TypeError("needs a 'context' argument.");var t=document.createElement("iframe");t.style||(t.style={}),t.style.display="none",document.body.appendChild(t);var a=t.contentWindow,n=a.eval,i=a.execScript;!n&&i&&(i.call(a,"null"),n=a.eval),forEach(Object_keys(e),(function(t){a[t]=e[t]})),forEach(globals,(function(t){e[t]&&(a[t]=e[t])}));var r=Object_keys(a),o=n.call(a,this.code);return forEach(Object_keys(a),(function(t){(t in e||-1===indexOf(r,t))&&(e[t]=a[t])})),forEach(globals,(function(t){t in e||defineProp(e,t,a[t])})),document.body.removeChild(t),o},Script.prototype.runInThisContext=function(){return eval(this.code)},Script.prototype.runInNewContext=function(e){var t=Script.createContext(e),a=this.runInContext(t);return e&&forEach(Object_keys(t),(function(a){e[a]=t[a]})),a},forEach(Object_keys(Script.prototype),(function(e){exports[e]=Script[e]=function(t){var a=Script(t);return a[e].apply(a,[].slice.call(arguments,1))}})),exports.isContext=function(e){return e instanceof Context},exports.createScript=function(e){return exports.Script(e)},exports.createContext=Script.createContext=function(e){var t=new Context;return"object"===typeof e&&forEach(Object_keys(e),(function(a){t[a]=e[a]})),t}},"0a49":function(e,t,a){var n=a("9b43"),i=a("626a"),r=a("4bf8"),o=a("9def"),l=a("cd1c");e.exports=function(e,t){var a=1==e,s=2==e,c=3==e,d=4==e,u=6==e,p=5==e||u,m=t||l;return function(t,l,g){for(var f,h,b=r(t),v=i(b),w=n(l,g,3),y=o(v.length),D=0,k=a?m(t,y):s?m(t,0):void 0;y>D;D++)if((p||D in v)&&(f=v[D],h=w(f,D,b),e))if(a)k[D]=h;else if(h)switch(e){case 3:return!0;case 5:return f;case 6:return D;case 2:k.push(f)}else if(d)return!1;return u?-1:c||d?d:k}}},"0aca":function(e,t,a){},1169:function(e,t,a){var n=a("2d95");e.exports=Array.isArray||function(e){return"Array"==n(e)}},"1f0c":function(e,t,a){},"221d":function(e,t,a){"use strict";var n=a("2550"),i=a.n(n);i.a},"24b2":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("div",{staticClass:"title"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",{staticClass:"actived"},[e._v("绿色优质产品")])],1)],1),a("div",{staticClass:"box"},[a("el-tabs",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{type:"border-card"},on:{"tab-click":e.getList},model:{value:e.activeTabName,callback:function(t){e.activeTabName=t},expression:"activeTabName"}},[a("el-tab-pane",{attrs:{label:"绿色食品",name:"greeFood"}},[a("greenFood",{attrs:{year:e.year}})],1),a("el-tab-pane",{attrs:{label:"有机农产品",name:"organicProduce"}},[a("organicProduce",{attrs:{year:e.year}})],1),a("el-tab-pane",{attrs:{label:"种植业绿色优质基地",name:"plantingGreenBase"}},[a("plantingGreenBase",{attrs:{year:e.year}})],1),a("el-tab-pane",{attrs:{label:"种植业乡镇统计",name:"plantingTownshipStatistics"}},[a("plantingTownshipStatistics",{attrs:{year:e.year}})],1),a("el-tab-pane",{attrs:{label:"畜牧业绿色优质基地",name:"animalHusbandryBase"}},[a("animalHusbandryBase",{attrs:{year:e.year}})],1),a("el-tab-pane",{attrs:{label:"绿色优质农产品占比",name:"greenAgriculturalProducts"}},[a("greenAgriculturalProducts",{attrs:{year:e.year}})],1)],1)],1)])},i=[],r=a("55a1"),o=(a("d1a0"),a("bc3a"),a("0010")),l=(a("0706"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"box"},[a("el-dialog",{attrs:{visible:e.openDialog,width:"60%","before-close":e.handleClose},on:{"update:visible":function(t){e.openDialog=t}}},[a("el-form",{ref:"dynamicValidateForm",attrs:{model:e.dynamicValidateForm}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"年度："}},[a("el-row",[a("el-col",{attrs:{span:4}},[a("el-input",{attrs:{rules:[{required:!0,message:"请插入",trigger:"blur"},{type:"number",message:"插入号码",trigger:"blur"}],span:3},model:{value:e.inYear,callback:function(t){e.inYear=t},expression:"inYear"}})],1)],1)],1),a("el-form-item",{staticClass:"left-margin flex-box w-100 no-margin-IE"},[e._l(e.dynamicValidateForm.data,(function(t,n){return a("el-row",{key:n,staticClass:"margin-top-10"},[a("el-col",{attrs:{span:1}},[a("el-form-item",{staticClass:"margin-left-20"},[a("el-checkbox",{staticClass:"form-checkbox",attrs:{"true-label":"1","false-label":"0"},on:{change:function(t){return e.changeCheckStatus(n)}},model:{value:e.checked[n],callback:function(t){e.$set(e.checked,n,t)},expression:"checked[index]"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"板块：",prop:"data."+n+".town",rules:{required:!0,message:"请插入",trigger:"blur"}}},[a("el-input",{staticClass:"w-80",model:{value:t.town,callback:function(a){e.$set(t,"town",a)},expression:"rowData.town"}})],1)],1),a("el-col",{attrs:{span:5}},[a("el-form-item",{staticClass:"margin-left-20",attrs:{label:"1-6月实绩:",prop:"data."+n+".halfYear"}},[a("el-input",{staticClass:"w-60",model:{value:t.halfYear,callback:function(a){e.$set(t,"halfYear",e._n(a))},expression:"rowData.halfYear"}})],1)],1),a("el-col",{attrs:{span:5}},[a("el-form-item",{staticClass:"margin-left-20",attrs:{label:"全年实绩:",prop:"data."+n+".fullYear"}},[a("el-input",{staticClass:"w-60",model:{value:t.fullYear,callback:function(a){e.$set(t,"fullYear",e._n(a))},expression:"rowData.fullYear"}})],1)],1)],1)})),a("el-row",{staticClass:"margin-left-40 margin-top-20"},[a("el-col",{attrs:{span:14}},[a("el-button",{attrs:{size:"small",type:"primary",plain:""},on:{click:function(t){return e.addFormRow()}}},[e._v("添加")]),a("el-button",{attrs:{size:"small",type:"danger",plain:""},on:{click:function(t){return e.deleteSelectedRows()}}},[e._v("删除")])],1),a("el-col",{directives:[{name:"show",rawName:"v-show",value:e.dynamicValidateForm.data.length>0,expression:"dynamicValidateForm.data.length > 0"}],attrs:{span:7}},[a("span",[e._v("插入时间: ")]),a("el-date-picker",{attrs:{type:"date"},model:{value:e.registerTime,callback:function(t){e.registerTime=t},expression:"registerTime"}})],1),a("el-col",{directives:[{name:"show",rawName:"v-show",value:e.dynamicValidateForm.data.length>0,expression:"dynamicValidateForm.data.length > 0"}],attrs:{span:2}},[a("el-button",{attrs:{size:"small",type:"success",plain:""},on:{click:function(t){return e.onSubmit("dynamicValidateForm")}}},[e._v("保存")])],1)],1)],2)],1)],1),a("el-dialog",{attrs:{visible:e.confirm_dialogVisible,width:"30%",modal:""},on:{"update:visible":function(t){e.confirm_dialogVisible=t}}},[a("span",[a("i",{staticClass:"el-icon-warning"},[e._v(" 继续？请再次检查")])]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small",type:"primary",plain:""},on:{click:function(t){e.confirm_dialogVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{size:"small",type:"success",plain:""},on:{click:function(t){return e.updateSelectedRows()}}},[e._v("确认")])],1)]),a("el-container",[a("el-header",[e._v("镇（街道）、开发区推进高质量发展考核指标数据填报表")]),a("div",{staticClass:"iptBox"},[a("el-row",[a("el-col",{attrs:{span:2}},[a("el-button",{attrs:{size:"small",type:"success",plain:""},on:{click:function(t){return e.showAddDialog()}}},[e._v("添加")])],1),a("el-col",{attrs:{span:6}},[a("span",[e._v("开始日期: ")]),a("el-date-picker",{attrs:{type:"date"},model:{value:e.registerTimeFrom,callback:function(t){e.registerTimeFrom=t},expression:"registerTimeFrom"}})],1),a("el-col",{attrs:{span:6}},[a("span",[e._v("结束日期: ")]),a("el-date-picker",{attrs:{type:"date"},model:{value:e.registerTimeTo,callback:function(t){e.registerTimeTo=t},expression:"registerTimeTo"}})],1),a("el-col",{attrs:{span:4}},[a("span",[e._v("年度: ")]),a("el-input",{staticClass:"w-60",nativeOn:{keyup:function(t){return e.handleChange(t)}},model:{value:e.searchYear,callback:function(t){e.searchYear=t},expression:"searchYear"}})],1),a("el-col",{attrs:{span:1}},[a("el-button",{staticClass:"margin-left-10",attrs:{size:"small",type:"primary",plain:""},on:{click:function(t){return e.changeFilter()}}},[e._v("搜索")])],1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,"row-class-name":e.rowIndex,"highlight-current-row":"","span-method":e.spanMethod}},[a("el-table-column",{attrs:{formatter:e.order,label:"序号",width:"100"}}),a("el-table-column",{attrs:{prop:"town",label:"板块"}}),a("el-table-column",{attrs:{label:"绿色优质农产品比重(畜牧)",align:"center"}},e._l(e.columns,(function(e){return a("el-table-column",{key:e.prop,attrs:{prop:e.prop,label:e.label,align:"center"}})})),1)],1)],1)],1)}),s=[],c=(a("ac6a"),a("55dd"),a("6b54"),a("c5f6"),{name:"animalHusbandryBase",props:{year:{required:!0,type:Number}},data:function(){return{inYear:0,searchYear:(new Date).getFullYear().toString(),openDialog:!1,columns:[{prop:"halfYear",label:"1-6月实绩"},{prop:"fullYear",label:"全年实绩"}],dynamicValidateForm:{data:[]},selectedRows:[],confirm_dialogVisible:!1,checked:[],registerTime:(new Date).toString("YYYY-MM-DD"),registerTimeFrom:new Date((new Date).getFullYear(),0,1),registerTimeTo:new Date,sendcount:0,alert_dialogVisible:!1,loggedinUserType:null,total:0,tableData:[],listLoading:!0}},created:function(){this.getData()},methods:{showAddDialog:function(){this.dynamicValidateForm.data=[],this.selectedRows=[],this.checked=[],this.inYear=Number((new Date).getFullYear()),this.addFormRow(),this.openDialog=!0},handleClose:function(e){var t=this;this.$confirm("您确定要关闭此对话框吗？").then((function(a){t.getData(),e()})).catch((function(e){}))},addFormRow:function(){this.dynamicValidateForm.data.push({town:"",fullYear:0,halfYear:0})},deleteSelectedRows:function(){if(this.selectedRows.length){for(var e in this.selectedRows=this.selectedRows.sort((function(e,t){return e>t?-1:1})),this.selectedRows){var t=this.dynamicValidateForm.data[this.selectedRows[e]].id;t&&this.deletedRows.push(t),this.checked[this.selectedRows[e]]=!1,this.dynamicValidateForm.data.splice(this.selectedRows[e],1)}this.selectedRows=[]}},onSubmit:function(e){var t=this;this.$refs[e].validate((function(e){e&&(t.confirm_dialogVisible=!0)}))},changeCheckStatus:function(e){var t=this.selectedRows.indexOf(e);t>-1&&this.selectedRows.splice(t,1),1==this.checked[e]&&this.selectedRows.push(e)},updateSelectedRows:function(){var e=this;this.confirm_dialogVisible=!1,this.openDialog=!1;var t=new Date,a=new Date;this.listLoading=!0,this.sendcount=0,this.dynamicValidateForm.data.forEach((function(n){var i=new FormData;i.append("createTime",a.toDateString("YYYY-MM-DD")),i.append("createUserId",Object(o["a"])().user().id),i.append("fullYear",void 0==n.fullYear||""==n.fullYear?-1:n.fullYear),i.append("halfYear",void 0==n.halfYear||""==n.halfYear?-1:n.halfYear),i.append("id",0),i.append("registerTime",e.registerTime.toString("YYYY-MM-DD")),i.append("town",n.town),i.append("year",e.inYear),i.append("updateTime",t.toDateString("YYYY-MM-DD")),i.append("updateUserId",Object(o["a"])().user().id),Object(r["a"])().post("/api/green/livestock/create",i).then((function(t){e.sendcount++,e.sendcount===e.dynamicValidateForm.data.length&&(e.listLoading=!1,e.getData())}))}))},changeFilter:function(){this.getData()},handleChange:function(){this.searchYear>1990&&(this.registerTimeFrom=new Date(this.searchYear,0,1))},getData:function(){var e=this;this.listLoading=!0;var t=new Date(this.registerTimeTo.getFullYear(),this.registerTimeTo.getMonth(),this.registerTimeTo.getDate(),23,59,59);Object(r["a"])().get("/api/green/livestock/all",{registerTimeFrom:""==this.registerTimeFrom||null==this.registerTimeFrom?"":this.registerTimeFrom,registerTimeTo:""==this.registerTimeTo||null==this.registerTimeTo?"":t,sortBy:"id",year:this.searchYear}).then((function(t){e.tableData=t.data,e.total=e.tableData.length,e.calculateTotal(),e.listLoading=!1,e.tableData.forEach((function(e){e.halfYear=-1==e.halfYear?"/":parseFloat(e.halfYear).toFixed(2),e.fullYear=-1==e.fullYear?"/":parseFloat(e.fullYear).toFixed(2)}))}))},calculateTotal:function(){var e=0,t=0;this.tableData.forEach((function(a){e+=-1==a.halfYear?0:a.halfYear,t+=-1==a.fullYear?0:a.fullYear})),this.tableData.push({town:"合计",halfYear:e,fullYear:t})},spanMethod:function(e){e.row,e.column;var t=e.rowIndex,a=e.columnIndex;if(t==this.tableData.length-1){if(1==a)return{rowspan:1,colspan:2};if(0==a)return{rowspan:0,colspan:0}}},rowIndex:function(e){var t=e.row,a=e.rowIndex;t.rowIndex=a},order:function(e){return e.rowIndex+1}}}),d=c,u=(a("3b62"),a("2877")),p=Object(u["a"])(d,l,s,!1,null,null,null),m=p.exports,g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"box"},[a("el-dialog",{attrs:{visible:e.openDialog,width:"90%","before-close":e.handleClose},on:{"update:visible":function(t){e.openDialog=t}}},[a("el-form",{ref:"dynamicValidateForm",attrs:{model:e.dynamicValidateForm}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"年度："}},[a("el-row",[a("el-col",{attrs:{span:2}},[a("el-input",{attrs:{rules:[{required:!0,message:"请插入",trigger:"blur"},{type:"number",message:"插入号码",trigger:"blur"}],span:3},model:{value:e.inYear,callback:function(t){e.inYear=t},expression:"inYear"}})],1)],1)],1),a("el-form-item",{staticClass:"left-margin flex-box w-100 no-margin-IE"},[e._l(e.dynamicValidateForm.data,(function(t,n){return a("el-row",{key:n},[a("el-col",{attrs:{span:1}},[a("el-form-item",{staticClass:"margin-left-20"},[a("el-checkbox",{staticClass:"form-checkbox",attrs:{"true-label":"1","false-label":"0"},on:{change:function(t){return e.changeCheckStatus(n)}},model:{value:e.checked[n],callback:function(t){e.$set(e.checked,n,t)},expression:"checked[index]"}})],1)],1),a("el-col",{attrs:{span:2}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"板块：",prop:"data."+n+".town",rules:{required:!0,message:"请插入",trigger:"blur"}}},[a("el-input",{model:{value:t.town,callback:function(a){e.$set(t,"town",a)},expression:"rowData.town"}})],1)],1),a("el-col",{attrs:{span:2}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"种植业占比:",prop:"data."+n+".planting"}},[a("el-input",{model:{value:t.planting,callback:function(a){e.$set(t,"planting",e._n(a))},expression:"rowData.planting"}})],1)],1),a("el-col",{attrs:{span:2}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"畜牧业占比:",prop:"data."+n+".livestock"}},[a("el-input",{model:{value:t.livestock,callback:function(a){e.$set(t,"livestock",e._n(a))},expression:"rowData.livestock"}})],1)],1),a("el-col",{attrs:{span:4}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"绿色优质农产品占比:",prop:"data."+n+".highQuality"}},[a("el-input",{model:{value:t.highQuality,callback:function(a){e.$set(t,"highQuality",e._n(a))},expression:"rowData.highQuality"}})],1)],1),a("el-col",{attrs:{span:4}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"下半年种植业预计占比:",prop:"data."+n+".plantingHalfPlan"}},[a("el-input",{model:{value:t.plantingHalfPlan,callback:function(a){e.$set(t,"plantingHalfPlan",e._n(a))},expression:"rowData.plantingHalfPlan"}})],1)],1),a("el-col",{attrs:{span:4}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"下半年畜牧业预计占比:",prop:"data."+n+".livestockHalfPlan"}},[a("el-input",{model:{value:t.livestockHalfPlan,callback:function(a){e.$set(t,"livestockHalfPlan",e._n(a))},expression:"rowData.livestockHalfPlan"}})],1)],1),a("el-col",{attrs:{span:4}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"绿色优质农产品预计占比:",prop:"data."+n+".highQualityPlan"}},[a("el-input",{model:{value:t.highQualityPlan,callback:function(a){e.$set(t,"highQualityPlan",e._n(a))},expression:"rowData.highQualityPlan"}})],1)],1)],1)})),a("el-row",{staticClass:"margin-left-40 margin-top-20"},[a("el-col",{attrs:{span:17}},[a("el-button",{attrs:{size:"small",type:"primary",plain:""},on:{click:function(t){return e.addFormRow()}}},[e._v("添加")]),a("el-button",{attrs:{size:"small",type:"danger",plain:""},on:{click:function(t){return e.deleteSelectedRows()}}},[e._v("删除")])],1),a("el-col",{directives:[{name:"show",rawName:"v-show",value:e.dynamicValidateForm.data.length>0,expression:"dynamicValidateForm.data.length > 0"}],attrs:{span:4}},[a("span",[e._v("插入时间: ")]),a("el-date-picker",{attrs:{type:"date"},model:{value:e.registerTime,callback:function(t){e.registerTime=t},expression:"registerTime"}})],1),a("el-col",{directives:[{name:"show",rawName:"v-show",value:e.dynamicValidateForm.data.length>0,expression:"dynamicValidateForm.data.length > 0"}],attrs:{span:2}},[a("el-button",{attrs:{size:"small",type:"success",plain:""},on:{click:function(t){return e.onSubmit("dynamicValidateForm")}}},[e._v("保存")])],1)],1)],2)],1)],1),a("el-dialog",{attrs:{visible:e.confirm_dialogVisible,width:"30%",modal:""},on:{"update:visible":function(t){e.confirm_dialogVisible=t}}},[a("span",[a("i",{staticClass:"el-icon-warning"},[e._v(" 继续？请再次检查")])]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small",type:"primary",plain:""},on:{click:function(t){e.confirm_dialogVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{size:"small",type:"success",plain:""},on:{click:function(t){return e.updateSelectedRows()}}},[e._v("确认")])],1)]),a("el-container",[a("el-header",[e._v("绿色优质农产品统计汇总")]),a("div",{staticClass:"iptBox"},[a("el-row",[a("el-col",{attrs:{span:2}},[a("el-button",{attrs:{size:"small",type:"success",plain:""},on:{click:function(t){return e.showAddDialog()}}},[e._v("添加")])],1),a("el-col",{attrs:{span:6}},[a("span",[e._v("开始日期: ")]),a("el-date-picker",{attrs:{type:"date"},model:{value:e.registerTimeFrom,callback:function(t){e.registerTimeFrom=t},expression:"registerTimeFrom"}})],1),a("el-col",{attrs:{span:6}},[a("span",[e._v("结束日期: ")]),a("el-date-picker",{attrs:{type:"date"},model:{value:e.registerTimeTo,callback:function(t){e.registerTimeTo=t},expression:"registerTimeTo"}})],1),a("el-col",{attrs:{span:4}},[a("span",[e._v("年度: ")]),a("el-input",{staticClass:"w-60",nativeOn:{keyup:function(t){return e.handleChange(t)}},model:{value:e.searchYear,callback:function(t){e.searchYear=t},expression:"searchYear"}})],1),a("el-col",{attrs:{span:1}},[a("el-button",{staticClass:"margin-left-10",attrs:{size:"small",type:"primary",plain:""},on:{click:function(t){return e.changeFilter()}}},[e._v("搜索")])],1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,"row-class-name":e.rowIndex,"highlight-current-row":"",border:"","span-method":e.spanMethod}},[a("el-table-column",{attrs:{formatter:e.order,label:"序号"}}),a("el-table-column",{attrs:{prop:"town",label:"板块"}}),a("el-table-column",{attrs:{prop:"planting",label:"种植业占比"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(a.planting=-1==a.planting?0:a.planting)+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"livestock",label:"畜牧业占比"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(a.livestock=-1==a.livestock?0:a.livestock)+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"highQuality",label:"绿色优质农产品占比"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(a.highQuality=-1==a.highQuality?"/":a.highQuality)+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"plantingHalfPlan",label:"下半年种植业预计占比"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(a.plantingHalfPlan=-1==a.plantingHalfPlan?"/":a.plantingHalfPlan)+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"livestockHalfPlan",label:"下半年畜牧业预计占比"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(a.livestockHalfPlan=-1==a.livestockHalfPlan?"/":a.livestockHalfPlan)+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"highQualityPlan",label:"绿色优质农产品预计占比"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(a.highQualityPlan=-1==a.highQualityPlan?"/":a.highQualityPlan)+"\n        ")]}}])})],1)],1)],1)},f=[],h={name:"greenAgriculturalProducts",props:{year:{required:!0,type:Number}},data:function(){return{inYear:0,searchYear:(new Date).getFullYear().toString(),openDialog:!1,dynamicValidateForm:{data:[]},selectedRows:[],confirm_dialogVisible:!1,checked:[],registerTime:(new Date).toString("YYYY-MM-DD"),registerTimeFrom:new Date((new Date).getFullYear(),0,1),registerTimeTo:new Date,sendcount:0,alert_dialogVisible:!1,total:0,tableData:[],listLoading:!0}},created:function(){this.getData()},methods:{showAddDialog:function(){this.dynamicValidateForm.data=[],this.selectedRows=[],this.checked=[],this.inYear=Number((new Date).getFullYear()),this.addFormRow(),this.openDialog=!0},handleClose:function(e){var t=this;this.$confirm("您确定要关闭此对话框吗？").then((function(a){t.getData(),e()})).catch((function(e){}))},addFormRow:function(){this.dynamicValidateForm.data.push({town:"",fullYear:0,halfYear:0})},deleteSelectedRows:function(){if(this.selectedRows.length){for(var e in this.selectedRows=this.selectedRows.sort((function(e,t){return e>t?-1:1})),this.selectedRows){var t=this.dynamicValidateForm.data[this.selectedRows[e]].id;t&&this.deletedRows.push(t),this.checked[this.selectedRows[e]]=!1,this.dynamicValidateForm.data.splice(this.selectedRows[e],1)}this.selectedRows=[]}},onSubmit:function(e){var t=this;this.$refs[e].validate((function(e){e&&(t.confirm_dialogVisible=!0)}))},changeCheckStatus:function(e){var t=this.selectedRows.indexOf(e);t>-1&&this.selectedRows.splice(t,1),1==this.checked[e]&&this.selectedRows.push(e)},updateSelectedRows:function(){var e=this;this.confirm_dialogVisible=!1,this.openDialog=!1;var t=new Date,a=new Date;this.listLoading=!0,this.sendcount=0,this.dynamicValidateForm.data.forEach((function(n){var i=new FormData;i.append("createTime",a.toDateString("YYYY-MM-DD")),i.append("createUserId",Object(o["a"])().user().id),i.append("highQuality",void 0==n.highQuality||""==n.highQuality?-1:n.highQuality),i.append("highQualityPlan",void 0==n.highQualityPlan||""==n.highQualityPlan?-1:n.highQualityPlan),i.append("id",0),i.append("livestock",void 0==n.livestock||""==n.livestock?-1:n.livestock),i.append("livestockHalfPlan",void 0==n.livestockHalfPlan||""==n.livestockHalfPlan?-1:n.livestockHalfPlan),i.append("planting",void 0==n.planting||""==n.planting?-1:n.planting),i.append("plantingHalfPlan",void 0==n.plantingHalfPlan||""==n.plantingHalfPlan?-1:n.plantingHalfPlan),i.append("registerTime",e.registerTime.toString("YYYY-MM-DD")),i.append("town",n.town),i.append("updateTime",t.toDateString("YYYY-MM-DD")),i.append("updateUserId",Object(o["a"])().user().id),i.append("year",e.inYear),Object(r["a"])().post("/api/green/product_ratio/create",i).then((function(t){e.sendcount++,e.sendcount===e.dynamicValidateForm.data.length&&(e.listLoading=!1,e.getData())}))}))},changeFilter:function(){this.getData()},handleChange:function(){this.searchYear>1990&&(this.registerTimeFrom=new Date(this.searchYear,0,1))},getData:function(){var e=this;this.listLoading=!0;var t=new Date(this.registerTimeTo.getFullYear(),this.registerTimeTo.getMonth(),this.registerTimeTo.getDate(),23,59,59);Object(r["a"])().get("/api/green/product_ratio/all",{registerTimeFrom:""==this.registerTimeFrom||null==this.registerTimeFrom?"":this.registerTimeFrom,registerTimeTo:""==this.registerTimeTo||null==this.registerTimeTo?"":t,sortBy:"id",year:this.searchYear}).then((function(t){e.tableData=t.data,e.total=e.tableData.length,e.calcualteTotal(),e.tableData.forEach((function(e){e.planting=-1==e.planting?"/":parseFloat(e.planting).toFixed(2),e.livestock=-1==e.livestock?"/":parseFloat(e.livestock).toFixed(2),e.highQuality=-1==e.highQuality?"/":parseFloat(e.highQuality).toFixed(2),e.plantingHalfPlan=-1==e.plantingHalfPlan?"/":parseFloat(e.plantingHalfPlan).toFixed(2),e.livestockHalfPlan=-1==e.livestockHalfPlan?"/":parseFloat(e.livestockHalfPlan).toFixed(2),e.highQualityPlan=-1==e.highQualityPlan?"/":parseFloat(e.highQualityPlan).toFixed(2)})),e.listLoading=!1}))},calcualteTotal:function(){var e=0,t=0,a=0,n=0,i=0,r=0;this.tableData.forEach((function(o){e+=-1==o.planting?0:o.planting,t+=-1==o.livestock?0:o.livestock,a+=-1==o.highQuality?0:o.highQuality,n+=-1==o.plantingHalfPlan?0:o.plantingHalfPlan,i+=-1==o.livestockHalfPlan?0:o.livestockHalfPlan,r+=-1==o.highQualityPlan?0:o.highQualityPlan})),this.tableData.push({town:"合计",planting:e,livestock:t,highQuality:a,plantingHalfPlan:n,livestockHalfPlan:i,highQualityPlan:r})},spanMethod:function(e){e.row,e.column;var t=e.rowIndex,a=e.columnIndex;if(t==this.tableData.length-1){if(0==a)return{rowspan:0,colspan:0};if(1==a)return{rowspan:1,colspan:2}}},rowIndex:function(e){var t=e.row,a=e.rowIndex;t.rowIndex=a},order:function(e){return e.rowIndex+1}}},b=h,v=(a("66ec"),Object(u["a"])(b,g,f,!1,null,null,null)),w=v.exports,y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"box padding-top-10"},[a("el-dialog",{attrs:{visible:e.show_addDialog,width:"80%","before-close":e.handleClose,title:"添加绿色食品"},on:{"update:visible":function(t){e.show_addDialog=t}}},[a("el-form",{ref:"dynamicValidateForm",attrs:{model:e.dynamicValidateForm}},[e._l(e.dynamicValidateForm.rowDatas,(function(t,n){return a("el-row",{key:n},[a("el-col",{attrs:{span:1}},[a("el-form-item",{staticClass:"margin-left-20"},[a("el-checkbox",{staticClass:"form-checkbox",attrs:{"true-label":"1","false-label":"0"},on:{change:function(t){return e.changeCheckStatus(n)}},model:{value:e.checked[n],callback:function(t){e.$set(e.checked,n,t)},expression:"checked[index]"}})],1)],1),a("el-col",{staticClass:"margin-left-10",attrs:{span:3}},[a("el-form-item",{attrs:{label:"板块：",prop:"rowDatas."+n+".town",rules:{required:!0,message:"请选择",trigger:"blur"}}},[a("el-select",{staticClass:"w-100",model:{value:t.town,callback:function(a){e.$set(t,"town",a)},expression:"rowData.town"}},e._l(e.township,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1),a("el-col",{staticClass:"margin-left-10",attrs:{span:4}},[a("el-form-item",{attrs:{label:"生产单位:",prop:"rowDatas."+n+".companyId",rules:{required:!0,message:"请选择",trigger:"blur"}}},[a("el-select",{staticClass:"w-100",model:{value:t.companyId,callback:function(a){e.$set(t,"companyId",a)},expression:"rowData.companyId"}},e._l(e.companyProduction,(function(e){return a("el-option",{key:e.companyId,attrs:{label:e.companyName,value:e.companyId}})})),1)],1)],1),a("el-col",{staticClass:"margin-left-10",attrs:{span:4}},[a("el-form-item",{attrs:{label:"产品名称:",prop:"rowDatas."+n+".productName"}},[a("el-input",{model:{value:t.productName,callback:function(a){e.$set(t,"productName",a)},expression:"rowData.productName"}})],1)],1),a("el-col",{staticClass:"margin-left-10",attrs:{span:3}},[a("el-form-item",{attrs:{label:"产品证书编号:",prop:"rowDatas."+n+".productCreditCode"}},[a("el-input",{model:{value:t.productCreditCode,callback:function(a){e.$set(t,"productCreditCode",a)},expression:"rowData.productCreditCode"}})],1)],1),a("el-col",{staticClass:"margin-left-10",attrs:{span:2}},[a("el-form-item",{attrs:{label:"基地面积(亩):",prop:"rowDatas."+n+".area",rules:[{type:"number",message:"插入号码"}]}},[a("el-input",{model:{value:t.area,callback:function(a){e.$set(t,"area",e._n(a))},expression:"rowData.area"}})],1)],1),a("el-col",{staticClass:"margin-left-10",attrs:{span:2}},[a("el-form-item",{attrs:{label:"产量(吨):",prop:"rowDatas."+n+".amount",rules:[{type:"number",message:"插入号码"}]}},[a("el-input",{model:{value:t.amount,callback:function(a){e.$set(t,"amount",e._n(a))},expression:"rowData.amount"}})],1)],1),a("el-col",{staticClass:"margin-left-10",attrs:{span:3}},[a("el-form-item",{attrs:{label:"基地地址(到村):",prop:"rowDatas."+n+".location",rules:{required:!0,message:"请插入",trigger:"blur"}}},[a("el-input",{model:{value:t.location,callback:function(a){e.$set(t,"location",a)},expression:"rowData.location"}})],1)],1)],1)})),a("el-row",[a("el-col",{attrs:{span:15}})],1),a("el-row",{staticClass:"left-margin flex-box w-100 no-margin-IE"},[a("el-col",{attrs:{span:4}},[a("el-button",{attrs:{size:"small",type:"primary",plain:""},on:{click:function(t){return e.addFormRow()}}},[e._v("添加")]),a("el-button",{attrs:{size:"small",type:"danger",plain:""},on:{click:function(t){return e.deleteSelectedRows()}}},[e._v("删除")])],1),a("el-col",{staticClass:"margin-top-10 text-right",attrs:{span:16}},[e._v("插入时间：")]),a("el-col",{attrs:{span:3}},[a("el-date-picker",{staticClass:"w-80",attrs:{align:"right",type:"date"},model:{value:e.registerTime,callback:function(t){e.registerTime=t},expression:"registerTime"}})],1),a("el-col",{attrs:{span:1}},[a("el-button",{staticClass:"margin-right-40",staticStyle:{float:"right"},attrs:{size:"small",type:"success",plain:""},on:{click:function(t){return e.onSubmit("dynamicValidateForm")}}},[e._v("保存")])],1)],1)],2)],1),a("el-dialog",{attrs:{visible:e.confirm_dialogVisible,width:"30%",modal:""},on:{"update:visible":function(t){e.confirm_dialogVisible=t}}},[a("span",[a("i",{staticClass:"el-icon-warning"},[e._v(" 继续？请再次检查")])]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small",type:"primary",plain:""},on:{click:function(t){e.confirm_dialogVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{size:"small",type:"success",plain:""},on:{click:function(t){return e.updateSelectedRows()}}},[e._v("确认")])],1)]),a("el-container",[a("el-header",{staticClass:"margin-bottom-10"},[e._v("常熟市"+e._s(e.curYear)+"年上半年度种植业绿色食品统计汇总")]),a("el-row",{staticClass:"margin-bottom-20"},[a("el-col",{attrs:{span:1}},[a("el-button",{attrs:{plain:"",type:"success",size:"small"},on:{click:function(t){return e.showAddDialog()}}},[e._v("添加")])],1),a("el-col",{attrs:{span:4}},[a("div",{staticClass:"select_label margin-left-20 margin-right-5"},[e._v("\n          开始日期 :\n        ")]),a("el-date-picker",{attrs:{align:"right",type:"date",placeholder:"插入时间 "},model:{value:e.registerTimeFrom,callback:function(t){e.registerTimeFrom=t},expression:"registerTimeFrom"}})],1),a("el-col",{attrs:{span:4}},[a("div",{staticClass:"select_label margin-left-20 margin-right-5"},[e._v("\n          结束日期 :\n        ")]),a("el-date-picker",{attrs:{align:"right",type:"date",placeholder:"插入时间 "},model:{value:e.registerTimeTo,callback:function(t){e.registerTimeTo=t},expression:"registerTimeTo"}})],1),a("el-col",{attrs:{span:4}},[a("div",{staticClass:"select_label margin-left-20 margin-right-5"},[e._v("板块 :")]),a("el-input",{staticClass:"w-60",attrs:{align:"right"},model:{value:e.searchTown,callback:function(t){e.searchTown=t},expression:"searchTown"}})],1),a("el-col",{attrs:{span:4}},[a("div",{staticClass:"select_label no-margin-left margin-right-5"},[e._v("\n          生产单位 :\n        ")]),a("el-input",{staticClass:"w-60",attrs:{align:"right"},model:{value:e.searchCompanyName,callback:function(t){e.searchCompanyName=t},expression:"searchCompanyName"}})],1),a("el-col",{attrs:{span:4}},[a("div",{staticClass:"select_label no-margin-left margin-right-5"},[e._v("\n          已获证书 :\n        ")]),a("el-select",{staticClass:"w-50",attrs:{align:"right",type:"date"},model:{value:e.isCredit,callback:function(t){e.isCredit=t},expression:"isCredit"}},e._l(e.option,(function(e){return a("el-option",{key:e.val,attrs:{label:e.label,value:e.val}})})),1)],1),a("el-col",{attrs:{span:2}},[a("el-button",{attrs:{plain:"",type:"primary",size:"small"},on:{click:function(t){return e.getData()}}},[e._v("搜索")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"","row-class-name":e.rowIndex,"span-method":e.mainSpanMethod,"highlight-current-row":""}},[a("el-table-column",{attrs:{formatter:e.order,label:"序号",width:"100"}}),a("el-table-column",{attrs:{prop:"plate.value",label:"板块"}}),a("el-table-column",{attrs:{prop:"productionUnit.value",label:"生产单位"}}),a("el-table-column",{attrs:{prop:"productName.value",label:"产品名称"}}),a("el-table-column",{attrs:{prop:"productCertificateNum.value",label:"产品证书编号",width:"200"}}),a("el-table-column",{attrs:{prop:"baseArea.value",label:"基地面积(亩)"}}),a("el-table-column",{attrs:{prop:"production.value",label:"产量(吨)"}}),a("el-table-column",{attrs:{prop:"baseAddress.value",label:"基地地址(到村)"}}),a("el-table-column",{staticStyle:{color:"black"},attrs:{label:"面积统计",align:"center"}},e._l(e.columns,(function(e){return a("el-table-column",{key:e.prop,attrs:{prop:e.prop,label:e.label,align:"center"}})})),1)],1)],1),a("div",{staticClass:"pageBox"},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],attrs:{total:e.total,page:e.page.pageIndex,limit:e.page.pageSize},on:{"update:page":function(t){return e.$set(e.page,"pageIndex",t)},"update:limit":function(t){return e.$set(e.page,"pageSize",t)},pagination:e.getData}})],1)],1)},D=[],k=(a("7f7f"),a("7514"),a("062e")),C={name:"greenFood",components:{Pagination:k["default"]},props:{year:{required:!0,type:Number}},data:function(){return{curYear:(new Date).getFullYear(),option:[{val:0,label:"全部"},{val:1,label:"是"},{val:2,label:"否"}],columns:[{prop:"certified.value",label:"已获证"},{prop:"declared.value",label:"已申报"}],isCredit:0,searchTown:"",searchCompanyName:"",registerTimeTo:new Date,registerTimeFrom:new Date((new Date).getFullYear(),0,1),show_addDialog:!1,confirm_dialogVisible:!1,selectedTown:null,selectedRows:[],township:[],companyProduction:[],dynamicValidateForm:{rowDatas:[{town:null,companyId:null,productName:"",productCreditCode:"",area:null,amount:null,location:""}]},registerTime:new Date,page:{pageIndex:1,pageSize:20},checked:[],total:0,tableData:[],objectData:[],listLoading:!1}},created:function(){this.getTown(),this.getCompanyProduction(),this.getData()},methods:{arrangeData:function(){var e=this,t=this.objectData;this.total=t.length;var a=0;t.forEach((function(t){var n=0;t.productionInfo.forEach((function(i){var r=0;i.productUnitInfo.forEach((function(n){e.tableData.push({plate:{value:t.plate,spaning:0},productionUnit:{value:i.productionUnit,spaning:0},productName:{value:n.productName,spaning:0},productCertificateNum:{value:n.productCertificateNum,spaning:0},baseArea:{value:n.baseArea,spaning:0},production:{value:n.production,spaning:0},baseAddress:{value:i.baseAddress,spaning:0},certified:{value:t.certified,spaning:0},declared:{value:t.declared,spaning:0}}),r++,a++})),e.tableData[a-r].productionUnit.spaning=r,e.tableData[a-r].baseAddress.spaning=r,n+=r})),e.tableData[a-n].plate.spaning=n,e.tableData[a-n].certified.spaning=n,e.tableData[a-n].declared.spaning=n})),this.tableData.push({plate:{value:"合计",spaning:0},productionUnit:{value:"",spaning:0},productName:{value:"",spaning:0},productCertificateNum:{value:"",spaning:0},baseArea:{value:this.baseQuality(),spaning:0},production:{value:this.productionQuality(),spaning:0},baseAddress:{value:"",spaning:0},certified:{value:this.cetifiyQuality(),spaning:0},declared:{value:this.declareQuality(),spaning:0}})},baseQuality:function(){var e=0;return this.objectData.forEach((function(t){t.productionInfo.forEach((function(t){t.productUnitInfo.forEach((function(t){e+="/"==t.baseArea?0:parseFloat(t.baseArea)}))}))})),e},productionQuality:function(){var e=0;return this.objectData.forEach((function(t){t.productionInfo.forEach((function(t){t.productUnitInfo.forEach((function(t){e+="/"==t.production?0:parseFloat(t.production)}))}))})),e},cetifiyQuality:function(){var e=0;return this.objectData.forEach((function(t){e+=t.certified})),e},declareQuality:function(){var e=0;return this.objectData.forEach((function(t){e+=t.declared})),e},mainSpanMethod:function(e){var t=e.row,a=(e.column,e.rowIndex),n=e.columnIndex;if(a<this.tableData.length-1){if(1===n)return t.plate.spaning>0?{rowspan:t.plate.spaning,colspan:1}:{rowspan:0,colspan:0};if(2===n)return t.productionUnit.spaning>0?{rowspan:t.productionUnit.spaning,colspan:1}:{rowspan:0,colspan:0};if(7===n)return t.baseAddress.spaning>0?{rowspan:t.baseAddress.spaning,colspan:1}:{rowspan:0,colspan:0};if(8===n)return t.certified.spaning>0?{rowspan:t.certified.spaning,colspan:1}:{rowspan:0,colspan:0};if(9===n)return t.declared.spaning>0?{rowspan:t.declared.spaning,colspan:1}:{rowspan:0,colspan:0}}else if(a==this.tableData.length-1){if(1==n)return{rowspan:1,colspan:2};if(2==n)return{rowspan:1,colspan:3};if(0==n||3==n||4==n)return{rowspan:0,colspan:0}}},getData:function(){var e=this;this.listLoading=!0,this.objectData=[],this.tableData=[];var t=new Date(this.registerTimeTo.getFullYear(),this.registerTimeTo.getMonth(),this.registerTimeTo.getDate(),23,59,59);Object(r["a"])().get("/api/green/green_food/all",{registerTimeTo:t,registerTimeFrom:this.registerTimeFrom,companyName:this.searchCompanyName,town:this.searchTown,isCredit:this.isCredit}).then((function(t){var a,n,i=t.data,r="",o=[],l=[];if(i.length>0){for(var s=0;s<i.length;s++)r!==i[s].town?(o.length>0&&e.objectData.push({plate:r,productionInfo:o,certified:a,declared:n}),r=i[s].town,i[s].productCreditCode?(a=-1==i[s].area?0:i[s].area,n=0):(n=-1==i[s].area?0:i[s].area,a=0),l=[],o=[],l.push({productName:i[s].productName,productCertificateNum:i[s].productCreditCode,baseArea:-1==i[s].area?"/":parseFloat(i[s].area).toFixed(2),production:-1==i[s].amount?"/":parseFloat(i[s].amount).toFixed(2)}),o.push({productionUnit:i[s].companyName,productUnitInfo:l,baseAddress:i[s].location})):(i[s].productCreditCode?a+=parseFloat(-1==i[s].area?0:i[s].area):i[s].productCreditCode||(n+=parseFloat(-1==i[s].area?0:i[s].area)),i[s-1].companyName===i[s].companyName?l.push({productName:i[s].productName,productCertificateNum:i[s].productCreditCode,baseArea:-1==i[s].area?0:parseFloat(i[s].area).toFixed(2),production:-1==i[s].amount?"/":parseFloat(i[s].amount).toFixed(2)}):i[s-1].companyName!==i[s].companyName&&(l=[],l.push({productName:i[s].productName,productCertificateNum:i[s].productCreditCode,baseArea:-1==i[s].area?0:parseFloat(i[s].area).toFixed(2),production:-1==i[s].amount?"/":parseFloat(i[s].amount).toFixed(2)}),o.push({productionUnit:i[s].companyName,productUnitInfo:l,baseAddress:i[s].location})));o.length>0&&e.objectData.push({plate:r,productionInfo:o,certified:a,declared:n}),e.arrangeData()}else e.tableData=[];setTimeout((function(){e.listLoading=!1}),500)})).catch((function(e){console.log(e)}))},rowIndex:function(e){var t=e.row,a=e.rowIndex;t.rowIndex=a},order:function(e){return this.page.pageSize*(this.page.pageIndex-1)+e.rowIndex+1},showAddDialog:function(){this.dynamicValidateForm.rowDatas=[],this.addFormRow(),this.show_addDialog=!0},getTown:function(){var e=this;Object(r["a"])().get("/api/town/all").then((function(t){e.township=e.township.concat(t)})).catch((function(e){console.log(e)}))},getCompanyProduction:function(){var e=this;Object(r["a"])().get("/api/company_production/name").then((function(t){e.companyProduction=t})).catch((function(e){console.log(e)}))},addFormRow:function(){this.dynamicValidateForm.rowDatas.push({town:null,companyId:null,productName:"",productCreditCode:"",area:null,amount:null,location:"",registerTime:new Date})},showDialog:function(e,t){this.showWebMaster=2===t,this.selectedSupervisupervisorType=t,this.dynamicValidateForm.rowDatas=e,this.openDialog=!0,this.header=this.supervisorType[t-1]},changeCheckStatus:function(e){var t=this.selectedRows.indexOf(e);t>-1&&this.selectedRows.splice(t,1),1==this.checked[e]&&this.selectedRows.push(e)},deleteSelectedRows:function(){if(this.selectedRows.length){for(var e in this.selectedRows=this.selectedRows.sort((function(e,t){return e>t?-1:1})),this.selectedRows){var t=this.dynamicValidateForm.rowDatas[this.selectedRows[e]].id;t&&this.deletedRows.push(t),this.checked[this.selectedRows[e]]=!1,this.dynamicValidateForm.rowDatas.splice(this.selectedRows[e],1)}this.selectedRows=[]}},onSubmit:function(e){var t=this;this.$refs[e].validate((function(e){e&&(t.confirm_dialogVisible=!0)}))},handleClose:function(e){var t=this;this.$confirm("您确定要关闭此对话框吗？").then((function(a){t.getData(),t.deletedRows=[],e()})).catch((function(e){}))},updateSelectedRows:function(){var e=this;this.confirm_dialogVisible=!1,this.show_addDialog=!1;var t=new Date,a=new Date;if(this.dynamicValidateForm.rowDatas.length)for(var n=0;n<this.dynamicValidateForm.rowDatas.length;n++){this.listLoading=!0;var i=new FormData;i.append("amount",null==this.dynamicValidateForm.rowDatas[n].amount?-1:this.dynamicValidateForm.rowDatas[n].amount),i.append("area",null==this.dynamicValidateForm.rowDatas[n].area?-1:this.dynamicValidateForm.rowDatas[n].area),i.append("id",0),i.append("companyId",this.dynamicValidateForm.rowDatas[n].companyId),i.append("companyName",this.filterCompnay(this.dynamicValidateForm.rowDatas[n].companyId)),i.append("createTime",a),i.append("createUserId",Object(o["a"])().user().id),i.append("location",this.dynamicValidateForm.rowDatas[n].location),i.append("productCreditCode",this.dynamicValidateForm.rowDatas[n].productCreditCode),i.append("productName",this.dynamicValidateForm.rowDatas[n].productName),i.append("registerTime",this.registerTime),i.append("town",this.filterTownship(this.dynamicValidateForm.rowDatas[n].town)),i.append("updateTime",t),i.append("updateUserId",Object(o["a"])().user().id),Object(r["a"])().post("/api/green/green_food/create",i).then((function(t){setTimeout((function(){e.listLoading=!1}),500),e.getData()}))}},filterCompnay:function(e){var t=this.companyProduction.find((function(t){return t.companyId===e}));return t?t.companyName:""},filterTownship:function(e){var t=this.township.find((function(t){return t.id===e}));return t?t.name:""}}},F=C,x=(a("221d"),Object(u["a"])(F,y,D,!1,null,null,null)),T=x.exports,_=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"box padding-top-10"},[a("el-dialog",{attrs:{visible:e.show_addDialog,width:"85%","before-close":e.handleClose,title:"添加有机农产品"},on:{"update:visible":function(t){e.show_addDialog=t}}},[a("el-form",{ref:"dynamicValidateForm",attrs:{model:e.dynamicValidateForm}},[e._l(e.dynamicValidateForm.rowDatas,(function(t,n){return a("el-row",{key:n},[a("el-col",{attrs:{span:1}},[a("el-form-item",{staticClass:"margin-left-20"},[a("el-checkbox",{staticClass:"form-checkbox",attrs:{"true-label":"1","false-label":"0"},on:{change:function(t){return e.changeCheckStatus(n)}},model:{value:e.checked[n],callback:function(t){e.$set(e.checked,n,t)},expression:"checked[index]"}})],1)],1),a("el-col",{staticClass:"margin-left-10",attrs:{span:3}},[a("el-form-item",{attrs:{label:"所在镇(区)：",prop:"rowDatas."+n+".town",rules:{required:!0,message:"请插入",trigger:"blur"}}},[a("el-input",{staticClass:"w-100",model:{value:t.town,callback:function(a){e.$set(t,"town",a)},expression:"rowData.town"}})],1)],1),a("el-col",{staticClass:"margin-left-10",attrs:{span:4}},[a("el-form-item",{attrs:{label:"申报单位名称:",prop:"rowDatas."+n+".companyId",rules:{required:!0,message:"请选择",trigger:"blur"}}},[a("el-select",{staticClass:"w-100",model:{value:t.companyId,callback:function(a){e.$set(t,"companyId",a)},expression:"rowData.companyId"}},e._l(e.companyProduction,(function(e){return a("el-option",{key:e.companyId,attrs:{label:e.companyName,value:e.companyId}})})),1)],1)],1),a("el-col",{staticClass:"margin-left-10",attrs:{span:3}},[a("el-form-item",{attrs:{label:"编号:",prop:"rowDatas."+n+".productCreditCode",rules:{required:!0,message:"请选择",trigger:"blur"}}},[a("el-input",{model:{value:t.productCreditCode,callback:function(a){e.$set(t,"productCreditCode",a)},expression:"rowData.productCreditCode"}})],1)],1),a("el-col",{staticClass:"margin-left-10",attrs:{span:2}},[a("el-form-item",{attrs:{label:"产品种类:",prop:"rowDatas."+n+".productType"}},[a("el-input",{model:{value:t.productType,callback:function(a){e.$set(t,"productType",a)},expression:"rowData.productType"}})],1)],1),a("el-col",{staticClass:"margin-left-10",attrs:{span:2}},[a("el-form-item",{attrs:{label:"产品名称:",prop:"rowDatas."+n+".productName"}},[a("el-input",{model:{value:t.productName,callback:function(a){e.$set(t,"productName",a)},expression:"rowData.productName"}})],1)],1),a("el-col",{staticClass:"margin-left-10",attrs:{span:2}},[a("el-form-item",{attrs:{label:"面积(亩):",prop:"rowDatas."+n+".area",rules:[{type:"number",message:"插入号码",trigger:"blur"}]}},[a("el-input-number",{staticClass:"w-90",attrs:{controls:!1},model:{value:t.area,callback:function(a){e.$set(t,"area",a)},expression:"rowData.area"}})],1)],1),a("el-col",{attrs:{span:2}},[a("el-form-item",{attrs:{label:"产量(吨):",prop:"rowDatas."+n+".amount",rules:[{type:"number",message:"插入号码",trigger:"blur"}]}},[a("el-input-number",{staticClass:"w-90",attrs:{controls:!1},model:{value:t.amount,callback:function(a){e.$set(t,"amount",a)},expression:"rowData.amount"}})],1)],1),a("el-col",{attrs:{span:3}},[a("el-form-item",{attrs:{label:"详细地址:",prop:"rowDatas."+n+".location"}},[a("el-input",{model:{value:t.location,callback:function(a){e.$set(t,"location",a)},expression:"rowData.location"}})],1)],1)],1)})),a("el-row",[a("el-col",{attrs:{span:15}})],1),a("el-row",{staticClass:"left-margin flex-box w-100 no-margin-IE"},[a("el-col",{attrs:{span:4}},[a("el-button",{attrs:{size:"small",type:"primary",plain:""},on:{click:function(t){return e.addFormRow()}}},[e._v("添加")]),a("el-button",{attrs:{size:"small",type:"danger",plain:""},on:{click:function(t){return e.deleteSelectedRows()}}},[e._v("删除")])],1),a("el-col",{staticClass:"margin-top-10 text-right",attrs:{span:16}},[e._v("插入时间：")]),a("el-col",{attrs:{span:3}},[a("el-date-picker",{staticClass:"w-80",attrs:{align:"right",type:"date"},model:{value:e.registerTime,callback:function(t){e.registerTime=t},expression:"registerTime"}})],1),a("el-col",{attrs:{span:1}},[a("el-button",{staticClass:"margin-right-40",staticStyle:{float:"right"},attrs:{size:"small",type:"success",plain:""},on:{click:function(t){return e.onSubmit("dynamicValidateForm")}}},[e._v("保存")])],1)],1)],2)],1),a("el-dialog",{attrs:{visible:e.confirm_dialogVisible,width:"30%",modal:""},on:{"update:visible":function(t){e.confirm_dialogVisible=t}}},[a("span",[a("i",{staticClass:"el-icon-warning"},[e._v(" 继续？请再次检查")])]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small",type:"primary",plain:""},on:{click:function(t){e.confirm_dialogVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{size:"small",type:"success",plain:""},on:{click:function(t){return e.updateSelectedRows()}}},[e._v("确认")])],1)]),a("el-container",[a("el-header",{staticClass:"margin-bottom-10"},[e._v("有机农产品清单")]),a("el-row",{staticClass:"margin-bottom-20"},[a("el-col",{attrs:{span:1}},[a("el-button",{attrs:{plain:"",type:"success",size:"small"},on:{click:function(t){return e.showAddDialog()}}},[e._v("添加")])],1),a("el-col",{attrs:{span:4}},[a("div",{staticClass:"select_label margin-left-20 margin-right-5"},[e._v("\n          开始日期 :\n        ")]),a("el-date-picker",{attrs:{align:"right",type:"date",placeholder:"插入时间 "},model:{value:e.registerTimeFrom,callback:function(t){e.registerTimeFrom=t},expression:"registerTimeFrom"}})],1),a("el-col",{attrs:{span:4}},[a("div",{staticClass:"select_label margin-left-20 margin-right-5"},[e._v("\n          结束日期 :\n        ")]),a("el-date-picker",{attrs:{align:"right",type:"date",placeholder:"插入时间 "},model:{value:e.registerTimeTo,callback:function(t){e.registerTimeTo=t},expression:"registerTimeTo"}})],1),a("el-col",{attrs:{span:4}},[a("div",{staticClass:"select_label margin-left-20 margin-right-5"},[e._v("\n          所在镇(区) :\n        ")]),a("el-input",{staticClass:"w-50",attrs:{align:"right"},model:{value:e.searchTown,callback:function(t){e.searchTown=t},expression:"searchTown"}})],1),a("el-col",{attrs:{span:4}},[a("div",{staticClass:"select_label no-margin-left margin-right-5"},[e._v("\n          申报单位名称 :\n        ")]),a("el-input",{staticClass:"w-50",attrs:{align:"right"},model:{value:e.searchCompanyName,callback:function(t){e.searchCompanyName=t},expression:"searchCompanyName"}})],1),a("el-col",{attrs:{span:4}},[a("div",{staticClass:"select_label margin-left-20 margin-right-5"},[e._v("\n          已获证书 :\n        ")]),a("el-select",{staticClass:"w-50",attrs:{align:"right",type:"date"},model:{value:e.isCredit,callback:function(t){e.isCredit=t},expression:"isCredit"}},e._l(e.option,(function(e){return a("el-option",{key:e.val,attrs:{label:e.label,value:e.val}})})),1)],1),a("el-col",{attrs:{span:2}},[a("el-button",{staticClass:"margin-left-10",attrs:{plain:"",type:"primary",size:"small"},on:{click:function(t){return e.getData()}}},[e._v("搜索")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"","row-class-name":e.rowIndex,"span-method":e.objectSpanMethod,fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{formatter:e.order,label:"序号",width:"100"}}),a("el-table-column",{attrs:{prop:"townDistrict.value",label:"所在镇(区)"}}),a("el-table-column",{attrs:{prop:"declarationUnitName.value",label:"申报单位名称"}}),a("el-table-column",{attrs:{prop:"numbering.value",label:"编号"}}),a("el-table-column",{attrs:{prop:"kind.value",width:"150"}}),a("el-table-column",{attrs:{prop:"productName.value",label:"产品名称",align:"center"}}),a("el-table-column",{attrs:{prop:"area.value",label:"面积(亩)"}}),a("el-table-column",{attrs:{prop:"production.value",label:"产量(吨)"}}),a("el-table-column",{attrs:{prop:"address.value",label:"详细地址"}})],1)],1),a("div",{staticClass:"pageBox"},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],attrs:{total:e.total,page:e.page.pageIndex,limit:e.page.pageSize},on:{"update:page":function(t){return e.$set(e.page,"pageIndex",t)},"update:limit":function(t){return e.$set(e.page,"pageSize",t)},pagination:e.getData}})],1)],1)},A=[],N={name:"organicProduce",components:{Pagination:k["default"]},props:{year:{required:!0,type:Number}},data:function(){return{option:[{val:0,label:"全部"},{val:1,label:"是"},{val:2,label:"否"}],isCredit:0,searchTown:"",searchCompanyName:"",registerTimeTo:new Date,registerTimeFrom:new Date((new Date).getFullYear(),0,1),show_addDialog:!1,confirm_dialogVisible:!1,selectedTown:null,selectedRows:[],township:[],companyProduction:[],dynamicValidateForm:{rowDatas:[{town:null,companyId:null,productName:"",productType:"",productCreditCode:"",area:null,amount:null,location:""}]},registerTime:new Date,page:{pageIndex:1,pageSize:20},checked:[],total:0,tableData:[],objData:[],listLoading:!1}},created:function(){this.getCompanyProduction(),this.getData()},methods:{arrangData:function(){var e=this,t=this.objData;this.total=t.length;var a=0;t.forEach((function(t){var n=0;t.declarationUnit.forEach((function(i){var r=0;i.declaration.forEach((function(n){var o=0;n.product.forEach((function(r){e.tableData.push({townDistrict:{value:t.townDistrict,spaning:0},declarationUnitName:{value:i.declarationUnitName,spaning:0},kind:{value:n.kind,spaning:0},numbering:{value:n.numbering,spaning:0},productName:{value:r.productName,spaning:0},production:{value:r.production,spaning:0},address:{value:n.address,spaning:0},area:{value:i.area,spaning:0}}),o++,a++})),e.tableData[a-o].numbering.spaning=o,e.tableData[a-o].address.spaning=o,""!==e.tableData[a-o].kind.value&&(e.tableData[a-o].kind.spaning=o),r+=o})),e.tableData[a-r].declarationUnitName.spaning=r,e.tableData[a-r].area.spaning=r,n+=r})),e.tableData[a-n].townDistrict.spaning=n})),this.tableData.push({townDistrict:{value:"合计",spaning:0},declarationUnitName:{value:"",spaning:0},numbering:{value:"",spaning:0},productName:{value:"",spaning:0},production:{value:this.productionQuality(),spaning:0},address:{value:"预计下半年通过15000亩认证面积",spaning:0},area:{value:this.areaQualtiy(),spaning:0}})},areaQualtiy:function(){var e=0;return this.objData.forEach((function(t){t.declarationUnit.forEach((function(t){e+=parseFloat("/"==t.area?0:t.area)}))})),parseFloat(e).toFixed(2)},productionQuality:function(){var e=0;return this.objData.forEach((function(t){t.declarationUnit.forEach((function(t){t.declaration.forEach((function(t){t.product.forEach((function(t){e+=parseFloat("/"==t.production?0:t.production)}))}))}))})),parseFloat(e).toFixed(2)},objectSpanMethod:function(e){var t=e.row,a=(e.column,e.rowIndex),n=e.columnIndex;if(a<this.tableData.length-1){if(1==n)return t.townDistrict.spaning>0?{rowspan:t.townDistrict.spaning,colspan:1}:{rowspan:0,colspan:0};if(2==n)return t.declarationUnitName.spaning>0?{rowspan:t.declarationUnitName.spaning,colspan:1}:{rowspan:0,colspan:0};if(3==n)return t.numbering.spaning>0?{rowspan:t.numbering.spaning,colspan:1}:{rowspan:0,colspan:0};if(4==n)return t.kind.spaning>0?{rowspan:t.kind.spaning,colspan:1}:0==t.kind.spaning&&""===t.kind.value?{rowspan:0,colspan:2}:{rowspan:0,colspan:0};if(6==n)return t.area.spaning>0?{rowspan:t.area.spaning,colspan:1}:{rowspan:0,colspan:0};if(8==n)return t.address.spaning>0?{rowspan:t.address.spaning,colspan:1}:{rowspan:0,colspan:0}}else{if(1==n)return{rowspan:1,colspan:2};if(2==n)return{rowspan:1,colspan:3};if(0==n||3==n||5==n)return{rowspan:0,colspan:0}}},getData:function(){var e=this;this.listLoading=!0,this.objData=[],this.tableData=[];var t=new Date(this.registerTimeTo.getFullYear(),this.registerTimeTo.getMonth(),this.registerTimeTo.getDate(),23,59,59);Object(r["a"])().get("/api/green/organic_product/all",{registerTimeTo:t,registerTimeFrom:this.registerTimeFrom,companyName:this.searchCompanyName,town:this.searchTown,isCredit:this.isCredit}).then((function(t){var a=t.data,n="",i=[],r=[],o=[];if(a.length>0){for(var l=0;l<a.length;l++)n!==a[l].town?(i.length>0&&e.objData.push({townDistrict:n,declarationUnit:i}),n=a[l].town,o=[],r=[],i=[],o.push({productName:a[l].productName,production:-1==a[l].amount?"/":parseFloat(a[l].amount).toFixed(2)}),r.push({numbering:a[l].productCreditCode,kind:a[l].productType,product:o,address:a[l].location}),i.push({declarationUnitName:a[l].companyName,declaration:r,area:-1==a[l].area?"/":parseFloat(a[l].area).toFixed(2)})):a[l-1].companyName===a[l].companyName?a[l-1].productCreditCode===a[l].productCreditCode?o.push({productName:a[l].productName,production:-1==a[l].amount?"/":parseFloat(a[l].amount).toFixed(2)}):(o=[],o.push({productName:a[l].productName,production:-1==a[l].amount?"/":parseFloat(a[l].amount).toFixed(2)}),r.push({numbering:a[l].productCreditCode,kind:a[l].productType,product:o,address:a[l].location})):(o=[],o.push({productName:a[l].productName,production:-1==a[l].amount?"/":parseFloat(a[l].amount).toFixed(2)}),r=[],r.push({numbering:a[l].productCreditCode,kind:a[l].productType,product:o,address:a[l].location}),i.push({declarationUnitName:a[l].companyName,declaration:r,area:-1==a[l].area?"/":parseFloat(a[l].area).toFixed(2)}));i.length>0&&e.objData.push({townDistrict:n,declarationUnit:i}),e.arrangData()}else e.tableData=[];setTimeout((function(){e.listLoading=!1}),500)})).catch((function(e){console.log(e)}))},rowIndex:function(e){var t=e.row,a=e.rowIndex;t.rowIndex=a},order:function(e){return this.page.pageSize*(this.page.pageIndex-1)+e.rowIndex+1},showAddDialog:function(){this.dynamicValidateForm.rowDatas=[],this.addFormRow(),this.show_addDialog=!0},getTown:function(){var e=this;Object(r["a"])().get("/api/town/all").then((function(t){e.township=e.township.concat(t)})).catch((function(e){console.log(e)}))},getCompanyProduction:function(){var e=this;Object(r["a"])().get("/api/company_production/name").then((function(t){e.companyProduction=t})).catch((function(e){console.log(e)}))},addFormRow:function(){this.dynamicValidateForm.rowDatas.push({town:"",companyId:null,productType:"",productName:"",productCreditCode:"",area:null,amount:null,location:"",registerTime:new Date})},showDialog:function(e,t){this.showWebMaster=2===t,this.selectedSupervisupervisorType=t,this.dynamicValidateForm.rowDatas=e,this.openDialog=!0,this.header=this.supervisorType[t-1]},changeCheckStatus:function(e){var t=this.selectedRows.indexOf(e);t>-1&&this.selectedRows.splice(t,1),1==this.checked[e]&&this.selectedRows.push(e)},deleteSelectedRows:function(){if(this.selectedRows.length){for(var e in this.selectedRows=this.selectedRows.sort((function(e,t){return e>t?-1:1})),this.selectedRows){var t=this.dynamicValidateForm.rowDatas[this.selectedRows[e]].id;t&&this.deletedRows.push(t),this.checked[this.selectedRows[e]]=!1,this.dynamicValidateForm.rowDatas.splice(this.selectedRows[e],1)}this.selectedRows=[]}},onSubmit:function(e){var t=this;this.$refs[e].validate((function(e){e&&(t.confirm_dialogVisible=!0)}))},handleClose:function(e){var t=this;this.$confirm("您确定要关闭此对话框吗？").then((function(a){t.getData(),t.deletedRows=[],e()})).catch((function(e){}))},updateSelectedRows:function(){var e=this;this.confirm_dialogVisible=!1,this.show_addDialog=!1;var t=new Date,a=new Date;if(this.dynamicValidateForm.rowDatas.length)for(var n=0;n<this.dynamicValidateForm.rowDatas.length;n++){this.listLoading=!0;var i=new FormData;i.append("amount",null==this.dynamicValidateForm.rowDatas[n].amount||"undefined"==this.dynamicValidateForm.rowDatas[n].amount?-1:this.dynamicValidateForm.rowDatas[n].amount),i.append("area",null==this.dynamicValidateForm.rowDatas[n].area||"undefined"==this.dynamicValidateForm.rowDatas[n].area?-1:this.dynamicValidateForm.rowDatas[n].area),i.append("id",0),i.append("productType",""==this.dynamicValidateForm.rowDatas[n].productType?" ":this.dynamicValidateForm.rowDatas[n].productType),i.append("companyName",this.filterCompnay(this.dynamicValidateForm.rowDatas[n].companyId)),i.append("createTime",a),i.append("createUserId",Object(o["a"])().user().id),i.append("location",this.dynamicValidateForm.rowDatas[n].location),i.append("productCreditCode",this.dynamicValidateForm.rowDatas[n].productCreditCode),i.append("productName",this.dynamicValidateForm.rowDatas[n].productName),i.append("registerTime",this.registerTime),i.append("town",this.dynamicValidateForm.rowDatas[n].town),i.append("updateTime",t),i.append("updateUserId",Object(o["a"])().user().id),Object(r["a"])().post("/api/green/organic_product/create",i).then((function(t){setTimeout((function(){e.listLoading=!1}),500),e.getData()}))}},filterCompnay:function(e){var t=this.companyProduction.find((function(t){return t.companyId===e}));return t?t.companyName:""},filterTownship:function(e){var t=this.township.find((function(t){return t.id===e}));return t?t.name:""}}},S=N,R=(a("bf83"),Object(u["a"])(S,_,A,!1,null,null,null)),V=R.exports,Y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"box"},[a("el-dialog",{attrs:{visible:e.openDialog,width:"90%","before-close":e.handleClose},on:{"update:visible":function(t){e.openDialog=t}}},[a("el-form",{ref:"dynamicValidateForm",attrs:{model:e.dynamicValidateForm}},[a("el-form-item",{staticClass:"left-margin flex-box w-100 no-margin-IE"},[e._l(e.dynamicValidateForm.data,(function(t,n){return a("el-row",{key:n},[a("el-col",{attrs:{span:1}},[a("el-form-item",{staticClass:"margin-left-20"},[a("el-checkbox",{staticClass:"form-checkbox",attrs:{"true-label":"1","false-label":"0"},on:{change:function(t){return e.changeCheckStatus(n)}},model:{value:e.checked[n],callback:function(t){e.$set(e.checked,n,t)},expression:"checked[index]"}})],1)],1),a("el-col",{attrs:{span:2}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"创建单位：",prop:"data."+n+".companyName",rules:{required:!0,message:"请插入",trigger:"blur"}}},[a("el-input",{model:{value:t.companyName,callback:function(a){e.$set(t,"companyName",a)},expression:"rowData.companyName"}})],1)],1),a("el-col",{attrs:{span:2}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"产品类型:",prop:"data."+n+".productType"}},[a("el-input",{model:{value:t.productType,callback:function(a){e.$set(t,"productType",a)},expression:"rowData.productType"}})],1)],1),a("el-col",{attrs:{span:2}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"基地面积:",prop:"data."+n+".area",rules:[{type:"number",message:"插入号码",trigger:"blur"}]}},[a("el-input",{model:{value:t.area,callback:function(a){e.$set(t,"area",e._n(a))},expression:"rowData.area"}})],1)],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"基地地址(到村)：",prop:"data."+n+".location"}},[a("el-input",{model:{value:t.location,callback:function(a){e.$set(t,"location",a)},expression:"rowData.location"}})],1)],1),a("el-col",{attrs:{span:3}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"与部基地,产品基地重合：",prop:"data."+n+".isCoincidence"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.isCoincidence,callback:function(a){e.$set(t,"isCoincidence",a)},expression:"rowData.isCoincidence"}},e._l([{value:0,label:"否"},{value:1,label:"是"}],(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("el-col",{staticClass:"margin-left-10",attrs:{span:3}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"重合企业/部基地：",prop:"data."+n+".coincidenceBase"}},[a("el-input",{attrs:{disabled:0==t.isCoincidence},model:{value:t.coincidenceBase,callback:function(a){e.$set(t,"coincidenceBase",a)},expression:"rowData.coincidenceBase"}})],1)],1),a("el-col",{staticClass:"margin-left-10",attrs:{span:2}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"重合面积：",prop:"data."+n+".coincidneceArea",rules:[{type:"number",message:"插入号码"}]}},[a("el-input",{attrs:{disabled:0==t.isCoincidence},model:{value:t.coincidneceArea,callback:function(a){e.$set(t,"coincidneceArea",e._n(a))},expression:"rowData.coincidneceArea"}})],1)],1),a("el-col",{attrs:{span:2}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"备注：",prop:"data."+n+".other"}},[a("el-input",{model:{value:t.other,callback:function(a){e.$set(t,"other",a)},expression:"rowData.other"}})],1)],1)],1)})),a("el-row",{staticClass:"margin-left-40 margin-top-20"},[a("el-col",{attrs:{span:17}},[a("el-button",{attrs:{size:"small",type:"primary",plain:""},on:{click:function(t){return e.addFormRow()}}},[e._v("添加")]),a("el-button",{attrs:{size:"small",type:"danger",plain:""},on:{click:function(t){return e.deleteSelectedRows()}}},[e._v("删除")])],1),a("el-col",{directives:[{name:"show",rawName:"v-show",value:e.dynamicValidateForm.data.length>0,expression:"dynamicValidateForm.data.length > 0"}],attrs:{span:4}},[a("span",[e._v("插入时间: ")]),a("el-date-picker",{attrs:{type:"date"},model:{value:e.registerTime,callback:function(t){e.registerTime=t},expression:"registerTime"}})],1),a("el-col",{directives:[{name:"show",rawName:"v-show",value:e.dynamicValidateForm.data.length>0,expression:"dynamicValidateForm.data.length > 0"}],attrs:{span:2}},[a("el-button",{attrs:{size:"small",type:"success",plain:""},on:{click:function(t){return e.onSubmit("dynamicValidateForm")}}},[e._v("保存")])],1)],1)],2)],1)],1),a("el-dialog",{attrs:{visible:e.confirm_dialogVisible,width:"30%",modal:""},on:{"update:visible":function(t){e.confirm_dialogVisible=t}}},[a("span",[a("i",{staticClass:"el-icon-warning"},[e._v(" 继续？请再次检查")])]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small",type:"primary",plain:""},on:{click:function(t){e.confirm_dialogVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{size:"small",type:"success",plain:""},on:{click:function(t){return e.updateSelectedRows()}}},[e._v("确认")])],1)]),a("el-container",[a("el-header",[e._v("建设中待验收种植业绿色优质基地")]),a("div",{staticClass:"iptBox"},[a("el-row",[a("el-col",{attrs:{span:2}},[a("el-button",{attrs:{size:"small",type:"success",plain:""},on:{click:function(t){return e.showAddDialog()}}},[e._v("添加")])],1),a("el-col",{attrs:{span:6}},[a("span",[e._v("开始日期: ")]),a("el-date-picker",{attrs:{type:"date"},model:{value:e.registerTimeFrom,callback:function(t){e.registerTimeFrom=t},expression:"registerTimeFrom"}})],1),a("el-col",{attrs:{span:6}},[a("span",[e._v("结束日期: ")]),a("el-date-picker",{attrs:{type:"date"},model:{value:e.registerTimeTo,callback:function(t){e.registerTimeTo=t},expression:"registerTimeTo"}})],1),a("el-col",{attrs:{span:9}},[a("span",[e._v("创建单位: ")]),a("el-input",{staticClass:"w-80",model:{value:e.companyName,callback:function(t){e.companyName=t},expression:"companyName"}})],1),a("el-col",{attrs:{span:1}},[a("el-button",{staticClass:"margin-left-10",attrs:{size:"small",type:"primary",plain:""},on:{click:function(t){return e.changeFilter()}}},[e._v("搜索")])],1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,"row-class-name":e.rowIndex,"span-method":e.objectSpanMethod,"highlight-current-row":""}},[a("el-table-column",{attrs:{formatter:e.order,label:"序号",width:"100"}}),a("el-table-column",{attrs:{prop:"companyName",label:"创建单位"}}),a("el-table-column",{attrs:{prop:"productType",label:"产品类型"}}),a("el-table-column",{attrs:{prop:"area",label:"基地面积"}}),a("el-table-column",{attrs:{prop:"location",label:"基地地址(到村)"}}),a("el-table-column",{attrs:{label:"与部基地,产品基地重合"}},[a("el-table-column",{attrs:{prop:"isCoincidence",label:"(是/否)",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(e._s("0"==a.isCoincidence?"否":"1"==a.isCoincidence?"是":a.isCoincidence))]}}])})],1),a("el-table-column",{attrs:{label:"应扣除的重合部分",align:"center"}},e._l(e.columns,(function(e){return a("el-table-column",{key:e.prop,attrs:{prop:e.prop,label:e.label}})})),1),a("el-table-column",{attrs:{prop:"other",label:"备注",align:"center"}})],1)],1)],1)},I=[],E={name:"plantingGreenBase",props:{year:{required:!0,type:Number}},data:function(){return{openDialog:!1,dynamicValidateForm:{data:[]},selectedRows:[],confirm_dialogVisible:!1,checked:[],registerTime:(new Date).toString("YYYY-MM-DD"),registerTimeFrom:new Date((new Date).getFullYear(),0,1),registerTimeTo:new Date,companyName:"",sendcount:0,columns:[{prop:"coincidenceBase",label:"重合企业/部基地"},{prop:"coincidneceArea",label:"重合面积"}],alert_dialogVisible:!1,total:0,tableData:[],listLoading:!0}},created:function(){this.getData()},methods:{showAddDialog:function(){this.dynamicValidateForm.data=[],this.selectedRows=[],this.checked=[],this.openDialog=!0,this.addFormRow()},handleClose:function(e){var t=this;this.$confirm("您确定要关闭此对话框吗？").then((function(a){t.getData(),e()})).catch((function(e){}))},addFormRow:function(){this.dynamicValidateForm.data.push({companyName:"",productType:"",area:0,location:"",isCoincidence:0,coincidenceBase:"",coincidneceArea:0,other:""})},deleteSelectedRows:function(){if(this.selectedRows.length){for(var e in this.selectedRows=this.selectedRows.sort((function(e,t){return e>t?-1:1})),this.selectedRows){var t=this.dynamicValidateForm.data[this.selectedRows[e]].id;t&&this.deletedRows.push(t),this.checked[this.selectedRows[e]]=!1,this.dynamicValidateForm.data.splice(this.selectedRows[e],1)}this.selectedRows=[]}},onSubmit:function(e){var t=this;this.$refs[e].validate((function(e){e&&(t.confirm_dialogVisible=!0)}))},changeCheckStatus:function(e){var t=this.selectedRows.indexOf(e);t>-1&&this.selectedRows.splice(t,1),1==this.checked[e]&&this.selectedRows.push(e)},updateSelectedRows:function(){var e=this;this.confirm_dialogVisible=!1,this.openDialog=!1;var t=new Date,a=new Date;this.listLoading=!0,this.sendcount=0,this.dynamicValidateForm.data.forEach((function(n){var i=new FormData;i.append("area",null==n.area||void 0==n.area?-1:n.area),i.append("coincidenceBase",0==n.isCoincidence?"":n.coincidenceBase),i.append("coincidneceArea",0==n.isCoincidence?-1:null==n.coincidneceArea||void 0==n.coincidneceArea?-1:n.coincidneceArea),i.append("companyName",n.companyName),i.append("createTime",a.toDateString("YYYY-MM-DD")),i.append("createUserId",Object(o["a"])().user().id),i.append("id",0),i.append("isCoincidence",n.isCoincidence),i.append("location",n.location),i.append("other",n.other),i.append("productType",n.productType),i.append("registerTime",e.registerTime.toString("YYYY-MM-DD")),i.append("updateTime",t.toDateString("YYYY-MM-DD")),i.append("updateUserId",Object(o["a"])().user().id),Object(r["a"])().post("/api/green/green_quality_base/create",i).then((function(t){e.sendcount++,e.sendcount===e.dynamicValidateForm.data.length&&(e.listLoading=!1,e.getData())}))}))},changeFilter:function(){this.getData()},getData:function(){var e=this;this.listLoading=!0;var t=new Date(this.registerTimeTo.getFullYear(),this.registerTimeTo.getMonth(),this.registerTimeTo.getDate(),23,59,59);Object(r["a"])().get("/api/green/green_quality_base/all",{companyName:this.companyName,registerTimeFrom:""==this.registerTimeFrom||null==this.registerTimeFrom?"":this.registerTimeFrom,registerTimeTo:""==this.registerTimeTo||null==this.registerTimeTo?"":t,sortBy:"id"}).then((function(t){e.tableData=t.data,e.total=e.tableData.length,e.calculateTotal(),e.Total(),e.listLoading=!1}))},calculateTotal:function(){this.tableData.forEach((function(e){e.area=-1==e.area?"/":parseFloat(e.area).toFixed(2),e.coincidneceArea=-1==e.coincidneceArea?"/":parseFloat(e.coincidneceArea).toFixed(2)})),this.tableData.push({companyName:"合计",productType:"",area:this.baseQuality(),location:"",isCoincidence:"",coincidenceBase:"",coincidneceArea:this.coincidentQuality(),other:""})},baseQuality:function(){var e=0;return this.tableData.forEach((function(t){"/"!==t.area&&(e+=parseFloat(t.area))})),parseFloat(e).toFixed(2)},coincidentQuality:function(){var e=0;return this.tableData.forEach((function(t){"/"!==t.coincidneceArea&&(e+=parseFloat(t.coincidneceArea))})),parseFloat(e).toFixed(2)},Total:function(){this.tableData.push({companyName:"纳入统计范围的基地面积（扣除重合后）：",productType:"",area:0,location:"",isCoincidence:this.totalQuality(),coincidenceBase:"",coincidneceArea:0,other:""})},totalQuality:function(){var e=this,t=0,a=0;return this.tableData.forEach((function(n){if(a===e.tableData.length-1)return parseFloat(t).toFixed(2);"/"!==n.area&&"/"!==n.coincidneceArea&&(t+=parseFloat(n.area)-parseFloat(n.coincidneceArea)),a++})),parseFloat(t).toFixed(2)},objectSpanMethod:function(e){e.row,e.column;var t=e.rowIndex,a=e.columnIndex;if(t==this.tableData.length-2){if(0==a)return{rowspan:0,colspan:0};if(1==a)return{rowspan:1,colspan:2}}else if(t==this.tableData.length-1){if(1==a)return{rowspan:1,colspan:5};if(5==a)return{rowspan:1,colspan:4};if(0==a||2==a||3==a||4==a||6==a||7==a||8==a)return{rowspan:0,colspan:0}}},rowIndex:function(e){var t=e.row,a=e.rowIndex;t.rowIndex=a},order:function(e){return e.rowIndex+1}}},P=E,Q=(a("dfd2"),Object(u["a"])(P,Y,I,!1,null,null,null)),O=Q.exports,$=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"box"},[a("el-dialog",{attrs:{visible:e.openDialog,width:"90%","before-close":e.handleClose},on:{"update:visible":function(t){e.openDialog=t}}},[a("el-form",{ref:"dynamicValidateForm",attrs:{model:e.dynamicValidateForm}},[a("el-form-item",{staticClass:"left-margin flex-box w-100 no-margin-IE"},[e._l(e.dynamicValidateForm.data,(function(t,n){return a("el-row",{key:n},[a("el-col",{attrs:{span:1}},[a("el-form-item",{staticClass:"margin-left-20"},[a("el-checkbox",{staticClass:"form-checkbox",attrs:{"true-label":"1","false-label":"0"},on:{change:function(t){return e.changeCheckStatus(n)}},model:{value:e.checked[n],callback:function(t){e.$set(e.checked,n,t)},expression:"checked[index]"}})],1)],1),a("el-col",{attrs:{span:2}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"板块：",prop:"data."+n+".town",rules:{required:!0,message:"请插入",trigger:"blur"}}},[a("el-input",{model:{value:t.town,callback:function(a){e.$set(t,"town",a)},expression:"rowData.town"}})],1)],1),a("el-col",{attrs:{span:2}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"绿色食品面积:",prop:"data."+n+".productName"}},[a("el-input",{model:{value:t.productName,callback:function(a){e.$set(t,"productName",a)},expression:"rowData.productName"}})],1)],1),a("el-col",{attrs:{span:2}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"有机面积:",prop:"data."+n+".organicArea"}},[a("el-input",{model:{value:t.organicArea,callback:function(a){e.$set(t,"organicArea",e._n(a))},expression:"rowData.organicArea"}})],1)],1),a("el-col",{attrs:{span:3}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"绿色优质基地面积:",prop:"data."+n+".highQualityArea"}},[a("el-input",{model:{value:t.highQualityArea,callback:function(a){e.$set(t,"highQualityArea",e._n(a))},expression:"rowData.highQualityArea"}})],1)],1),a("el-col",{attrs:{span:2}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"重复面积:",prop:"data."+n+".repeatArea"}},[a("el-input",{model:{value:t.repeatArea,callback:function(a){e.$set(t,"repeatArea",e._n(a))},expression:"rowData.repeatArea"}})],1)],1),a("el-col",{attrs:{span:2}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"合计:",prop:"data."+n+".sum"}},[a("el-input",{model:{value:t.sum,callback:function(a){e.$set(t,"sum",e._n(a))},expression:"rowData.sum"}})],1)],1),a("el-col",{attrs:{span:2}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"耕地面积:",prop:"data."+n+".cultivatedArea"}},[a("el-input",{model:{value:t.cultivatedArea,callback:function(a){e.$set(t,"cultivatedArea",e._n(a))},expression:"rowData.cultivatedArea"}})],1)],1),a("el-col",{attrs:{span:2}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"绿色,有机:",prop:"data."+n+".greenOrganic"}},[a("el-input",{model:{value:t.greenOrganic,callback:function(a){e.$set(t,"greenOrganic",e._n(a))},expression:"rowData.greenOrganic"}})],1)],1),a("el-col",{attrs:{span:2}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"地标:",prop:"data."+n+".target"}},[a("el-input",{model:{value:t.target,callback:function(a){e.$set(t,"target",a)},expression:"rowData.target"}})],1)],1),a("el-col",{attrs:{span:2}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"预计面积:",prop:"data."+n+".predictArea"}},[a("el-input",{model:{value:t.predictArea,callback:function(a){e.$set(t,"predictArea",e._n(a))},expression:"rowData.predictArea"}})],1)],1)],1)})),a("el-row",{staticClass:"margin-left-40 margin-top-20"},[a("el-col",{attrs:{span:17}},[a("el-button",{attrs:{size:"small",type:"primary",plain:""},on:{click:function(t){return e.addFormRow()}}},[e._v("添加")]),a("el-button",{attrs:{size:"small",type:"danger",plain:""},on:{click:function(t){return e.deleteSelectedRows()}}},[e._v("删除")])],1),a("el-col",{directives:[{name:"show",rawName:"v-show",value:e.dynamicValidateForm.data.length>0,expression:"dynamicValidateForm.data.length > 0"}],attrs:{span:4}},[a("span",[e._v("插入时间: ")]),a("el-date-picker",{attrs:{type:"date"},model:{value:e.registerTime,callback:function(t){e.registerTime=t},expression:"registerTime"}})],1),a("el-col",{directives:[{name:"show",rawName:"v-show",value:e.dynamicValidateForm.data.length>0,expression:"dynamicValidateForm.data.length > 0"}],attrs:{span:2}},[a("el-button",{attrs:{size:"small",type:"success",plain:""},on:{click:function(t){return e.onSubmit("dynamicValidateForm")}}},[e._v("保存")])],1)],1)],2)],1)],1),a("el-dialog",{attrs:{visible:e.confirm_dialogVisible,width:"30%",modal:""},on:{"update:visible":function(t){e.confirm_dialogVisible=t}}},[a("span",[a("i",{staticClass:"el-icon-warning"},[e._v(" 继续？请再次检查")])]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small",type:"primary",plain:""},on:{click:function(t){e.confirm_dialogVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{size:"small",type:"success",plain:""},on:{click:function(t){return e.updateSelectedRows()}}},[e._v("确认")])],1)]),a("el-container",[a("el-header",[e._v("种植业绿色优质农产品统计汇总")]),a("div",{staticClass:"iptBox"},[a("el-row",[a("el-col",{attrs:{span:2}},[a("el-button",{attrs:{size:"small",type:"success",plain:""},on:{click:function(t){return e.showAddDialog()}}},[e._v("添加")])],1),a("el-col",{attrs:{span:6}},[a("span",[e._v("开始日期: ")]),a("el-date-picker",{attrs:{type:"date"},model:{value:e.registerTimeFrom,callback:function(t){e.registerTimeFrom=t},expression:"registerTimeFrom"}})],1),a("el-col",{attrs:{span:6}},[a("span",[e._v("结束日期: ")]),a("el-date-picker",{attrs:{type:"date"},model:{value:e.registerTimeTo,callback:function(t){e.registerTimeTo=t},expression:"registerTimeTo"}})],1),a("el-col",{attrs:{span:9}},[a("span",[e._v("创建单位: ")]),a("el-input",{staticClass:"w-80",model:{value:e.town,callback:function(t){e.town=t},expression:"town"}})],1),a("el-col",{attrs:{span:1}},[a("el-button",{staticClass:"margin-left-10",attrs:{size:"small",type:"primary",plain:""},on:{click:function(t){return e.changeFilter()}}},[e._v("搜索")])],1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,"row-class-name":e.rowIndex,"highlight-current-row":"",border:"","span-method":e.objectSpanMethod}},[a("el-table-column",{attrs:{formatter:e.order,label:"序号"}}),a("el-table-column",{attrs:{prop:"town",label:"板块"}}),a("el-table-column",{attrs:{prop:"productName",label:"绿色食品面积"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n        "+e._s(a.productName=-1==a.productName?"/":a.productName)+"\n      ")]}}])}),a("el-table-column",{attrs:{prop:"organicArea",label:"有机面积"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n        "+e._s(a.organicArea=-1==a.organicArea?"/":a.organicArea)+"\n      ")]}}])}),a("el-table-column",{attrs:{prop:"highQualityArea",label:"绿色优质基地面积"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n        "+e._s(a.highQualityArea=-1==a.highQualityArea?"/":a.highQualityArea)+"\n      ")]}}])}),a("el-table-column",{attrs:{prop:"repeatArea",label:"重复面积"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n        "+e._s(a.repeatArea=-1==a.repeatArea?"/":a.repeatArea)+"\n      ")]}}])}),a("el-table-column",{attrs:{prop:"sum",label:"合计"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n        "+e._s(a.sum=-1==a.sum?"/":a.sum)+"\n      ")]}}])}),a("el-table-column",{attrs:{prop:"cultivatedArea",label:"耕地面积"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n        "+e._s(a.cultivatedArea=-1==a.cultivatedArea?"/":a.cultivatedArea)+"\n      ")]}}])}),a("el-table-column",{attrs:{prop:"proportion",label:"占比"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n        "+e._s(a.proportion=-1==a.proportion?"/":a.proportion)+"\n      ")]}}])}),a("el-table-column",{attrs:{prop:"greenOrganic",label:"绿色,有机"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n        "+e._s(a.greenOrganic=-1==a.greenOrganic?"/":a.greenOrganic)+"\n      ")]}}])}),a("el-table-column",{attrs:{prop:"target",label:"地标"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n        "+e._s(a.target=-1==a.target?"/":a.target)+"\n      ")]}}])}),a("el-table-column",{attrs:{prop:"predictArea",label:"预计面积"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n        "+e._s(a.predictArea=-1==a.predictArea?"/":a.predictArea)+"\n      ")]}}])}),a("el-table-column",{attrs:{prop:"expectedRatio",label:"预计占比"}})],1)],1)],1)},L=[],j=(a("28a5"),a("6762"),a("2fdb"),{name:"plantingTownshipStatistics",props:{year:{required:!0,type:Number}},data:function(){return{openDialog:!1,dynamicValidateForm:{data:[]},selectedRows:[],confirm_dialogVisible:!1,checked:[],registerTime:(new Date).toString("YYYY-MM-DD"),registerTimeFrom:new Date((new Date).getFullYear(),0,1),registerTimeTo:new Date,town:"",sendcount:0,alert_dialogVisible:!1,tableData:[],listLoading:!0}},created:function(){this.getData()},methods:{showAddDialog:function(){this.dynamicValidateForm.data=[],this.selectedRows=[],this.checked=[],this.addFormRow(),this.openDialog=!0},handleClose:function(e){var t=this;this.$confirm("您确定要关闭此对话框吗？").then((function(a){t.getData(),e()})).catch((function(e){}))},addFormRow:function(){this.dynamicValidateForm.data.push({town:"",productName:"",organicArea:0,highQualityArea:0,repeatArea:0,sum:0,cultivatedArea:0,greenOrganic:0,target:"",predictArea:0})},deleteSelectedRows:function(){if(this.selectedRows.length){for(var e in this.selectedRows=this.selectedRows.sort((function(e,t){return e>t?-1:1})),this.selectedRows){var t=this.dynamicValidateForm.data[this.selectedRows[e]].id;t&&this.deletedRows.push(t),this.checked[this.selectedRows[e]]=!1,this.dynamicValidateForm.data.splice(this.selectedRows[e],1)}this.selectedRows=[]}},onSubmit:function(e){var t=this;this.$refs[e].validate((function(e){e&&(t.confirm_dialogVisible=!0)}))},changeCheckStatus:function(e){var t=this.selectedRows.indexOf(e);t>-1&&this.selectedRows.splice(t,1),1==this.checked[e]&&this.selectedRows.push(e)},updateSelectedRows:function(){var e=this;this.confirm_dialogVisible=!1,this.openDialog=!1;var t=new Date,a=new Date;this.listLoading=!0,this.sendcount=0,this.dynamicValidateForm.data.forEach((function(n){var i=new FormData;i.append("createTime",a.toDateString("YYYY-MM-DD")),i.append("createUserId",Object(o["a"])().user().id),i.append("cultivatedArea",""==n.cultivatedArea||void 0==n.cultivatedArea?-1:n.cultivatedArea),i.append("greenOrganic",""==n.greenOrganic||void 0==n.greenOrganic?-1:n.greenOrganic),i.append("highQualityArea",""==n.highQualityArea||void 0==n.highQualityArea?-1:n.highQualityArea),i.append("id",0),i.append("organicArea",""==n.organicArea||void 0==n.organicArea?-1:n.organicArea),i.append("predictArea",""==n.predictArea||void 0==n.predictArea?-1:n.predictArea),i.append("productName",n.productName),i.append("registerTime",e.registerTime.toString("YYYY-MM-DD")),i.append("repeatArea",""==n.repeatArea||void 0==n.repeatArea?-1:n.repeatArea),i.append("sum",""==n.sum||void 0==n.sum?-1:n.sum),i.append("target",n.target),i.append("town",n.town),i.append("updateTime",t.toDateString("YYYY-MM-DD")),i.append("updateUserId",Object(o["a"])().user().id),Object(r["a"])().post("/api/green/plants_statistics/create",i).then((function(t){e.sendcount++,e.sendcount===e.dynamicValidateForm.data.length&&(e.listLoading=!1,e.getData())}))}))},changeFilter:function(){this.getData()},getData:function(){var e=this;this.listLoading=!0;var t=new Date(this.registerTimeTo.getFullYear(),this.registerTimeTo.getMonth(),this.registerTimeTo.getDate(),23,59,59);Object(r["a"])().get("/api/green/plants_statistics/all",{town:this.town,registerTimeFrom:""==this.registerTimeFrom||null==this.registerTimeFrom?"":this.registerTimeFrom,registerTimeTo:""==this.registerTimeTo||null==this.registerTimeTo?"":t,sortBy:"id"}).then((function(t){e.tableData=t.data,e.total=e.tableData.length,e.getTotal(),e.tableData.forEach((function(e){-1!==e.organicArea?e.organicArea=parseFloat(e.organicArea).toFixed(2):e.organicArea="/",-1!==e.highQualityArea?e.highQualityArea=parseFloat(e.highQualityArea).toFixed(2):e.highQualityArea="/",-1!==e.repeatArea?e.repeatArea=parseFloat(e.repeatArea).toFixed(2):e.repeatArea="/",-1!==e.sum?e.sum=parseFloat(e.sum).toFixed(2):e.sum="/",-1!==e.cultivatedArea?e.cultivatedArea=parseFloat(e.cultivatedArea).toFixed(2):e.cultivatedArea="/",-1!==e.greenOrganic?e.greenOrganic=parseFloat(e.greenOrganic).toFixed(2):e.greenOrganic="/",-1!==e.predictArea?e.predictArea=parseFloat(e.predictArea).toFixed(2):e.predictArea="/",-1!==e.expectedRatio?e.expectedRatio=parseFloat(e.expectedRatio).toFixed(2):e.expectedRatio="/",-1!==e.proportion?e.proportion=parseFloat(e.proportion).toFixed(2):e.proportion="/"})),e.listLoading=!1}))},getTotal:function(){this.tableData.forEach((function(e){-1!==e.sum&&-1!==e.cultivatedArea?e.proportion=100*e.sum/e.cultivatedArea:e.proportion=-1,-1!==e.predictArea&&-1!==e.cultivatedArea?e.expectedRatio=100*e.predictArea/e.cultivatedArea:e.expectedRatio=-1})),this.tableData.push({town:"合计",productName:"",organicArea:this.organicAreaQuality(),highQualityArea:this.greenHighQuality(),repeatArea:this.repeatAreaQuality(),sum:this.totalQuality(),cultivatedArea:this.cultivateQuality(),proportion:0,greenOrganic:this.greenOrganicQuality(),target:this.landmarkQuality(),predictArea:this.estimateQuality(),expectedRatio:0}),this.tableData[this.tableData.length-1].proportion=this.tableData[this.tableData.length-1].sum/this.tableData[this.tableData.length-1].cultivatedArea,this.tableData[this.tableData.length-1].expectedRatio=this.tableData[this.tableData.length-1].predictArea/this.tableData[this.tableData.length-1].cultivatedArea},greenFoodQuality:function(){var e=0;return this.tableData.forEach((function(t){e+=-1==t.productName?0:t.productName})),e},organicAreaQuality:function(){var e=0;return this.tableData.forEach((function(t){e+=-1==t.organicArea?0:t.organicArea})),e},greenHighQuality:function(){var e=0;return this.tableData.forEach((function(t){e+=-1==t.highQualityArea?0:t.highQualityArea})),e},repeatAreaQuality:function(){var e=0;return this.tableData.forEach((function(t){e+=-1==t.repeatArea?0:t.repeatArea})),e},totalQuality:function(){var e=0;return this.tableData.forEach((function(t){e+=-1==t.sum?0:t.sum})),e},cultivateQuality:function(){var e=0;return this.tableData.forEach((function(t){e+=-1==t.cultivatedArea?0:t.cultivatedArea})),e},proportionQuality:function(){var e=0;return this.tableData.forEach((function(t){e+=-1==t.proportion?0:t.proportion})),e},greenOrganicQuality:function(){var e=0;return this.tableData.forEach((function(t){e+=-1==t.greenOrganic?0:t.greenOrganic})),e},landmarkQuality:function(){var e=0,t=0;return this.tableData.forEach((function(a){if(-1!=a.target)if(a.target.includes("%")){var n=a.target.split("%");e+=Number(n[0]),t+=Number(n[1].substring(1,n[1].length-1))}else isNaN(a.target)||(t+=Number(a.target))})),e>0?parseFloat(e).toFixed(2)+"%("+t+")":t},estimateQuality:function(){var e=0;return this.tableData.forEach((function(t){e+=-1==t.predictArea?0:t.predictArea})),e},objectSpanMethod:function(e){e.row,e.col;var t=e.rowIndex,a=e.columnIndex;if(t==this.tableData.length-1){if(0==a)return{rowspan:0,colspan:0};if(1==a)return{rowspan:1,colspan:2}}},expectedQuality:function(){var e=0;return this.tableData.forEach((function(t){e+=-1==t.expectedRatio?0:t.expectedRatio})),e},rowIndex:function(e){var t=e.row,a=e.rowIndex;t.rowIndex=a},order:function(e){return e.rowIndex+1}}}),M=j,z=(a("fa39"),Object(u["a"])(M,$,L,!1,null,null,null)),U=z.exports,H={name:"greenProducts",components:{animalHusbandryBase:m,greenAgriculturalProducts:w,greenFood:T,organicProduce:V,plantingGreenBase:O,plantingTownshipStatistics:U},data:function(){return{activeTabName:"greeFood",page:{pageIndex:1,pageSize:20},total:0,listLoading:!1,year:2019,options:[{value:2018},{value:2019},{value:2020},{value:2021},{value:2022},{value:2023}]}},created:function(){},methods:{getList:function(){this.listLoading=!1},getYear:function(){},handleClick:function(){},rowIndex:function(e){var t=e.row,a=e.rowIndex;t.rowIndex=a},order:function(e){return this.page.pageSize*(this.page.pageIndex-1)+e.rowIndex+1}}},B=H,q=(a("d53e"),Object(u["a"])(B,n,i,!1,null,null,null));t["default"]=q.exports},2550:function(e,t,a){},"2f21":function(e,t,a){"use strict";var n=a("79e5");e.exports=function(e,t){return!!e&&n((function(){t?e.call(null,(function(){}),1):e.call(null)}))}},3846:function(e,t,a){a("9e1e")&&"g"!=/./g.flags&&a("86cc").f(RegExp.prototype,"flags",{configurable:!0,get:a("0bfb")})},"3b62":function(e,t,a){"use strict";var n=a("51a7"),i=a.n(n);i.a},"51a7":function(e,t,a){},"55dd":function(e,t,a){"use strict";var n=a("5ca1"),i=a("d8e8"),r=a("4bf8"),o=a("79e5"),l=[].sort,s=[1,2,3];n(n.P+n.F*(o((function(){s.sort(void 0)}))||!o((function(){s.sort(null)}))||!a("2f21")(l)),"Array",{sort:function(e){return void 0===e?l.call(r(this)):l.call(r(this),i(e))}})},"5ffa":function(e,t,a){},"66ec":function(e,t,a){"use strict";var n=a("1f0c"),i=a.n(n);i.a},"6b54":function(e,t,a){"use strict";a("3846");var n=a("cb7c"),i=a("0bfb"),r=a("9e1e"),o="toString",l=/./[o],s=function(e){a("2aba")(RegExp.prototype,o,e,!0)};a("79e5")((function(){return"/a/b"!=l.call({source:"a",flags:"b"})}))?s((function(){var e=n(this);return"/".concat(e.source,"/","flags"in e?e.flags:!r&&e instanceof RegExp?i.call(e):void 0)})):l.name!=o&&s((function(){return l.call(this)}))},"6b6c":function(e,t,a){},7514:function(e,t,a){"use strict";var n=a("5ca1"),i=a("0a49")(5),r="find",o=!0;r in[]&&Array(1)[r]((function(){o=!1})),n(n.P+n.F*o,"Array",{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),a("9c6c")(r)},"7f7f":function(e,t,a){var n=a("86cc").f,i=Function.prototype,r=/^\s*function ([^ (]*)/,o="name";o in i||a("9e1e")&&n(i,o,{configurable:!0,get:function(){try{return(""+this).match(r)[1]}catch(e){return""}}})},8367:function(e,t,a){"use strict";var n=a("0aca"),i=a.n(n);i.a},aa77:function(e,t,a){var n=a("5ca1"),i=a("be13"),r=a("79e5"),o=a("fdef"),l="["+o+"]",s="​",c=RegExp("^"+l+l+"*"),d=RegExp(l+l+"*$"),u=function(e,t,a){var i={},l=r((function(){return!!o[e]()||s[e]()!=s})),c=i[e]=l?t(p):o[e];a&&(i[a]=c),n(n.P+n.F*l,"String",i)},p=u.trim=function(e,t){return e=String(i(e)),1&t&&(e=e.replace(c,"")),2&t&&(e=e.replace(d,"")),e};e.exports=u},ac6a:function(e,t,a){for(var n=a("cadf"),i=a("0d58"),r=a("2aba"),o=a("7726"),l=a("32e9"),s=a("84f2"),c=a("2b4c"),d=c("iterator"),u=c("toStringTag"),p=s.Array,m={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},g=i(m),f=0;f<g.length;f++){var h,b=g[f],v=m[b],w=o[b],y=w&&w.prototype;if(y&&(y[d]||l(y,d,p),y[u]||l(y,u,b),s[b]=p,v))for(h in n)y[h]||r(y,h,n[h],!0)}},bdeb:function(e,t,a){},bf83:function(e,t,a){"use strict";var n=a("bdeb"),i=a.n(n);i.a},c5f6:function(e,t,a){"use strict";var n=a("7726"),i=a("69a8"),r=a("2d95"),o=a("5dbc"),l=a("6a99"),s=a("79e5"),c=a("9093").f,d=a("11e9").f,u=a("86cc").f,p=a("aa77").trim,m="Number",g=n[m],f=g,h=g.prototype,b=r(a("2aeb")(h))==m,v="trim"in String.prototype,w=function(e){var t=l(e,!1);if("string"==typeof t&&t.length>2){t=v?t.trim():p(t,3);var a,n,i,r=t.charCodeAt(0);if(43===r||45===r){if(a=t.charCodeAt(2),88===a||120===a)return NaN}else if(48===r){switch(t.charCodeAt(1)){case 66:case 98:n=2,i=49;break;case 79:case 111:n=8,i=55;break;default:return+t}for(var o,s=t.slice(2),c=0,d=s.length;c<d;c++)if(o=s.charCodeAt(c),o<48||o>i)return NaN;return parseInt(s,n)}}return+t};if(!g(" 0o1")||!g("0b1")||g("+0x1")){g=function(e){var t=arguments.length<1?0:e,a=this;return a instanceof g&&(b?s((function(){h.valueOf.call(a)})):r(a)!=m)?o(new f(w(t)),a,g):w(t)};for(var y,D=a("9e1e")?c(f):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),k=0;D.length>k;k++)i(f,y=D[k])&&!i(g,y)&&u(g,y,d(f,y));g.prototype=h,h.constructor=g,a("2aba")(n,m,g)}},cd1c:function(e,t,a){var n=a("e853");e.exports=function(e,t){return new(n(e))(t)}},d53e:function(e,t,a){"use strict";var n=a("d784"),i=a.n(n);i.a},d784:function(e,t,a){},dfd2:function(e,t,a){"use strict";var n=a("5ffa"),i=a.n(n);i.a},e853:function(e,t,a){var n=a("d3f4"),i=a("1169"),r=a("2b4c")("species");e.exports=function(e){var t;return i(e)&&(t=e.constructor,"function"!=typeof t||t!==Array&&!i(t.prototype)||(t=void 0),n(t)&&(t=t[r],null===t&&(t=void 0))),void 0===t?Array:t}},fa39:function(e,t,a){"use strict";var n=a("6b6c"),i=a.n(n);i.a},fdef:function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"}}]);
//# sourceMappingURL=chunk-f072bc34.534bd520.js.map
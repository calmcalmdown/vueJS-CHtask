(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d230825"],{ed1a:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("div",{staticClass:"title"},[a("el-breadcrumb",{attrs:{separator:"/"}},[t.isEnterprise>-1?a("el-breadcrumb-item",{staticClass:"actived"},[t._v("农残自检")]):a("el-breadcrumb-item",{staticClass:"actived"},[t._v("农残检测")])],1)],1),a("div",{staticClass:"box"},[a("div",{staticClass:"iptBox"},["undefined"==typeof this.creditCode?a("div",{staticClass:"select_label no-margin-left"},[t._v("乡镇")]):a("div",{staticClass:"select_label no-margin-left",staticStyle:{display:"none"}},[t._v("乡镇")]),"undefined"==typeof this.creditCode?a("el-select",{attrs:{placeholder:"全部"},on:{change:t.getList},model:{value:t.currTown,callback:function(e){t.currTown=e},expression:"currTown"}},t._l(t.township,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.divisionCode,size:"large"}})})),1):a("div",{staticClass:"select_label"},[t._v(t._s(t.getCompanyName()))]),a("div",{staticClass:"select_label"},[t._v("项目")]),a("el-select",{attrs:{placeholder:"全部"},on:{change:t.getList},model:{value:t.itemValue,callback:function(e){t.itemValue=e},expression:"itemValue"}},t._l(t.items,(function(t){return a("el-option",{key:t.id,attrs:{label:t.item,value:t.item}})})),1),a("div",{staticClass:"select_label"},[t._v("样品")]),a("el-select",{attrs:{placeholder:"全部"},on:{change:t.getList},model:{value:t.samplesValue,callback:function(e){t.samplesValue=e},expression:"samplesValue"}},t._l(t.samples,(function(t){return a("el-option",{key:t.id,attrs:{label:t.sample,value:t.sample}})})),1),a("div",{staticClass:"select_label"},[t._v("定性")]),a("el-select",{attrs:{placeholder:"全部"},on:{change:t.getList},model:{value:t.result,callback:function(e){t.result=e},expression:"result"}},t._l(t.results,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1),t.isShowSearchOption?a("div",{staticClass:"select_label"},[t._v("检测单位")]):t._e(),t.isShowSearchOption?a("el-select",{attrs:{placeholder:"全部"},on:{change:t.getList},model:{value:t.detectionUnitValue,callback:function(e){t.detectionUnitValue=e},expression:"detectionUnitValue"}},t._l(t.detectionUnit,(function(t){return a("el-option",{key:t.id,attrs:{label:t.detectUnit,value:t.detectUnit}})})),1):t._e()],1),a("div",{staticClass:"iptBox"},[a("el-row",{staticClass:"w-100"},[a("el-col",{attrs:{span:5}},[a("div",{staticClass:"select_label no-margin-left"},[t._v("开始日期")]),a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},on:{change:t.getList},model:{value:t.startDate,callback:function(e){t.startDate=e},expression:"startDate"}})],1),a("el-col",{attrs:{span:5}},[a("div",{staticClass:"select_label no-margin-left"},[t._v("结束日期")]),a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},on:{change:t.getList},model:{value:t.endDate,callback:function(e){t.endDate=e},expression:"endDate"}})],1),a("el-col",{staticClass:"flex-center",attrs:{span:5}},[a("el-button",{attrs:{size:"small",type:"success",plain:"",disabled:t.totalNo<1},on:{click:t.handleDownload}},[t._v("导出表格")]),"undefined"!=typeof this.creditCode?a("el-button",{attrs:{size:"small",type:"primary",plain:""},on:{click:function(e){return t.$router.go(-1)}}},[t._v("返回")]):a("el-button",{staticStyle:{display:"none"},attrs:{size:"small",plain:"",type:"primary"},on:{click:function(e){return t.$router.go(-1)}}},[t._v("返回")]),a("span",{staticClass:"margin-left-20 margin-top-10-IE"},[t._v("\n            总计\n            "),a("b",{staticClass:"blue-colored"},[t._v(t._s(t.totalNo))]),t._v(" 条检测\n          ")])],1),a("el-col",{staticClass:"flex-center justify-right",staticStyle:{height:"40px"},attrs:{span:9}},[0!=t.isShowCheckbox?a("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-plus",plain:""},on:{click:function(e){return t.actionConfirm(1)}}},[t._v("添加到专项1")]):t._e(),0!=t.isShowCheckbox?a("el-button",{staticStyle:{"margin-right":"10px"},attrs:{size:"small",type:"danger",icon:"el-icon-minus",plain:""},on:{click:function(e){return t.actionConfirm(0)}}},[t._v("从专项1移除")]):t._e(),a("el-checkbox",{staticClass:"margin-top-10-IE float-right-IE",attrs:{"true-label":"1","false-label":"0",disabled:t.totalNo<1},on:{change:t.showCheckbox},model:{value:t.isShowCheckbox,callback:function(e){t.isShowCheckbox=e},expression:"isShowCheckbox"}},[t._v("专项1:绿色优质农产品生产基地")])],1)],1),a("el-dialog",{attrs:{visible:t.alert_dialogVisible,width:"30%",modal:""},on:{"update:visible":function(e){t.alert_dialogVisible=e}}},[a("span",[a("i",{staticClass:"el-icon-warning"},[t._v(" 请选择 !!!")])]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small",type:"primary",plain:""},on:{click:function(e){t.alert_dialogVisible=!1}}},[t._v("取消")])],1)]),a("el-dialog",{attrs:{visible:t.confirm_dialogVisible,width:"30%",modal:""},on:{"update:visible":function(e){t.confirm_dialogVisible=e}}},[a("span",[a("i",{staticClass:"el-icon-warning"},[t._v(" 继续？请再次检查")])]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small",type:"primary",plain:""},on:{click:function(e){t.confirm_dialogVisible=!1}}},[t._v("取消")]),a("el-button",{attrs:{size:"small",type:t.btnColor,plain:""},on:{click:function(e){return t.updateSelectedRows()}}},[t._v("确认")])],1)])],1),a("el-container",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData,"row-class-name":t.rowIndex}},[0!=t.isShowCheckbox?a("el-table-column",{attrs:{label:"",width:"35"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("el-checkbox",{staticStyle:{"margin-left":"auto"},attrs:{"true-label":"1","false-label":"0"},on:{change:function(e){return t.changeCheckStatus(i.id)}},model:{value:t.checked[i.id],callback:function(e){t.$set(t.checked,i.id,e)},expression:"checked[row.id]"}})]}}],null,!1,574067976)}):t._e(),a("el-table-column",{attrs:{formatter:t.order,label:"序号",width:"80"}}),a("el-table-column",{attrs:{prop:"no",label:"编号"}}),a("el-table-column",{attrs:{prop:"item",label:"检测项目"}}),a("el-table-column",{attrs:{prop:"sample",label:"样品名称"}}),a("el-table-column",{attrs:{prop:"source",label:"来源"}}),a("el-table-column",{attrs:{prop:"resultDl",label:"定量结果"}}),a("el-table-column",{attrs:{prop:"resultDx",label:"定性结果"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v("\n            "+t._s(t.detect(a.resultDx))+"\n          ")]}}])}),a("el-table-column",{attrs:{prop:"detectTime",label:"检测时间",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v(t._s(t._f("formatDate")(a.detectTime)))]}}])}),a("el-table-column",{attrs:{prop:"detectUnit",label:"检测单位",width:"150"}}),a("el-table-column",{attrs:{prop:"operator",label:"检验员"}}),a("el-table-column",{attrs:{label:"专项1"},scopedSlots:t._u([{key:"default",fn:function(t){var e=t.row;return[1==e.specialFlag?a("i",{staticClass:"el-icon-check"}):a("i")]}}])})],1)],1),a("div",{staticClass:"pageBox"},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total > 0"}],attrs:{total:t.total,page:t.page.pageIndex,limit:t.page.pageSize},on:{"update:page":function(e){return t.$set(t.page,"pageIndex",e)},"update:limit":function(e){return t.$set(t.page,"pageSize",e)},pagination:t.getList}})],1)],1)])},l=[],n=(a("7514"),a("8ded")),s=a.n(n),o=a("062e"),c=a("55a1"),r=(a("0010"),{name:"disabilityCheck",components:{Pagination:o["default"]},data:function(){return{isEnterprise:"",listLoading:!1,creditCode:"",page:{pageIndex:1,pageSize:20},total:0,totalNo:0,options:[{value:"全部",label:""}],township:[{id:-1,name:"全部",divisionCode:-1}],currTown:"",status:1,tableData:[],items:[{id:0,item:"全部"}],itemValue:"",samples:[{id:0,sample:"全部"}],samplesValue:"",results:[{id:0,name:"全部"},{id:1,name:"不合格"},{id:2,name:"合格 "},{id:3,name:"疑似"}],result:"",detectionUnit:[{id:"0",detectUnit:"全部"}],detectionUnitValue:"",startDate:"",endDate:"",isShowCheckbox:0,selectedRows:[],alert_dialogVisible:!1,confirm_dialogVisible:!1,btnColor:"",action:"",companyData:[],filename:"农残检测",checked:[],isShowSearchOption:null}},created:function(){this.isEnterprise=s.a.get("authData").indexOf("ent"),this.isShowSearchOption=!!s.a.get("authList").find((function(t){return"searchdisabilityCheck"==t.privilegeCode})),this.getTown(),this.getItem(),this.getSample(),this.getDetectUnit(),this.getList(),this.getCompanyProduction(),this.creditCode=this.$route.query.creditCode},methods:{handleDownload:function(){var t=this;this.downloadLoading=!0,Promise.all([a.e("chunk-6e83591c"),a.e("chunk-5bdd67a2"),a.e("chunk-f97bf932")]).then(a.bind(null,"4bf8d")).then((function(e){var a=["编号","检测项目","样品名称","来源","定量结果","定性结果","检测时间","检测单位","检验员","专项1"],i=["no","item","sample","source","resultDl","resultDx","detectTime","detectUnit","operator","specialFlag"],l=t.formatJson(i,t.tableData);e.export_json_to_excel({header:a,data:l,filename:t.filename,bookType:"csv"}),t.downloadLoading=!1}))},formatJson:function(t,e){var a=this;return e.map((function(e){return t.map((function(t){return"resultDx"===t?a.filterResultDx(e[t]):"detectTime"===t?e[t].substr(0,10):"specialFlag"===t?1===e[t]?"是":"":e[t]}))}))},getCompanyProduction:function(){var t=this;Object(c["a"])().get("/api/company_production/name").then((function(e){t.companyData=e})).catch((function(t){console.log(t)}))},getTown:function(){var t=this;Object(c["a"])().get("/api/town/all").then((function(e){t.township=t.township.concat(e)})).catch((function(t){console.log(t)}))},getItem:function(){var t=this;Object(c["a"])().get("/api/disability_check/item").then((function(e){t.items=t.items.concat(e)})).catch((function(t){console.log(t)}))},getSample:function(){var t=this;Object(c["a"])().get("/api/disability_check/sample ").then((function(e){t.samples=t.samples.concat(e)})).catch((function(t){console.log(t)}))},getDetectUnit:function(){var t=this;Object(c["a"])().get("/api/disability_check/detect_unit").then((function(e){t.detectionUnit=t.detectionUnit.concat(e)})).catch((function(t){console.log(t)}))},getList:function(){var t=this;this.listLoading=!0;var e="";this.endDate&&(e=this.endDate.getFullYear()+"-"+parseInt(this.endDate.getMonth()+1)+"-"+this.endDate.getDate()+"T23:59:59"),Object(c["a"])().get("/api/disability_check/all",{creditCode:this.$route.query.creditCode,detectUnit:"全部"==this.detectionUnitValue?"":this.detectionUnitValue,detectTimeFrom:this.startDate,detectTimeTo:e,sample:"全部"==this.samplesValue?"":this.samplesValue,item:"全部"==this.itemValue?"":this.itemValue,resultDx:this.result,townDivisionCode:-1==this.currTown?"":this.currTown,pageNo:this.page.pageIndex-1,pageSize:this.page.pageSize,sortBy:"detect_time"}).then((function(e){t.tableData=e.data,t.total=e.total,t.totalNo=e.total,setTimeout((function(){t.listLoading=!1}),500)})).catch((function(t){console.log(t)}))},getCompanyName:function(){var t=this,e=this.companyData.find((function(e){return e.creditCode===t.creditCode}));return e?e.companyName:""},detect:function(t){return""==t||"0"==t?"不合格":"1"==t?"合格":"疑似"},rowIndex:function(t){var e=t.row,a=t.rowIndex;e.rowIndex=a},order:function(t){return this.page.pageSize*(this.page.pageIndex-1)+t.rowIndex+1},goAdd:function(){this.$router.push({path:"addDisabilityCheck"})},changeCheckStatus:function(t){var e=this.selectedRows.indexOf(t);e>-1&&this.selectedRows.splice(e,1),1==this.checked[t]&&this.selectedRows.push(t)},actionConfirm:function(t){this.action=t,this.updateSelectedRows()},updateSelectedRows:function(){var t=this;for(var e in this.selectedRows)this.confirm_dialogVisible=!1,this.listLoading=!0,Object(c["a"])().put("/api/disability_check/update_special_flag/"+this.selectedRows[e]+"?specialFlag="+this.action).then((function(e){setTimeout((function(){t.listLoading=!1}),500),t.selectedRows=[],t.checked=[],t.isShowCheckbox=0,t.getList()})).catch((function(t){console.log(t)}))},showCheckbox:function(){0==this.isShowCheckbox&&(this.selectedRows=[],this.checked=[])},filterResultDx:function(t){switch(t){case 0:return"不合格";case 1:return"合格";case 2:return"疑似";default:return"不合格"}}}}),d=r,u=a("2877"),p=Object(u["a"])(d,i,l,!1,null,"640f6eb0",null);e["default"]=p.exports}}]);
//# sourceMappingURL=chunk-2d230825.f7b75e97.js.map
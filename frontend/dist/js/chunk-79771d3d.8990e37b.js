(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-79771d3d"],{"0706":function(module,exports){var indexOf=function(e,t){if(e.indexOf)return e.indexOf(t);for(var a=0;a<e.length;a++)if(e[a]===t)return a;return-1},Object_keys=function(e){if(Object.keys)return Object.keys(e);var t=[];for(var a in e)t.push(a);return t},forEach=function(e,t){if(e.forEach)return e.forEach(t);for(var a=0;a<e.length;a++)t(e[a],a,e)},defineProp=function(){try{return Object.defineProperty({},"_",{}),function(e,t,a){Object.defineProperty(e,t,{writable:!0,enumerable:!1,configurable:!0,value:a})}}catch(e){return function(e,t,a){e[t]=a}}}(),globals=["Array","Boolean","Date","Error","EvalError","Function","Infinity","JSON","Math","NaN","Number","Object","RangeError","ReferenceError","RegExp","String","SyntaxError","TypeError","URIError","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","eval","isFinite","isNaN","parseFloat","parseInt","undefined","unescape"];function Context(){}Context.prototype={};var Script=exports.Script=function(e){if(!(this instanceof Script))return new Script(e);this.code=e};Script.prototype.runInContext=function(e){if(!(e instanceof Context))throw new TypeError("needs a 'context' argument.");var t=document.createElement("iframe");t.style||(t.style={}),t.style.display="none",document.body.appendChild(t);var a=t.contentWindow,i=a.eval,n=a.execScript;!i&&n&&(n.call(a,"null"),i=a.eval),forEach(Object_keys(e),(function(t){a[t]=e[t]})),forEach(globals,(function(t){e[t]&&(a[t]=e[t])}));var r=Object_keys(a),o=i.call(a,this.code);return forEach(Object_keys(a),(function(t){(t in e||-1===indexOf(r,t))&&(e[t]=a[t])})),forEach(globals,(function(t){t in e||defineProp(e,t,a[t])})),document.body.removeChild(t),o},Script.prototype.runInThisContext=function(){return eval(this.code)},Script.prototype.runInNewContext=function(e){var t=Script.createContext(e),a=this.runInContext(t);return e&&forEach(Object_keys(t),(function(a){e[a]=t[a]})),a},forEach(Object_keys(Script.prototype),(function(e){exports[e]=Script[e]=function(t){var a=Script(t);return a[e].apply(a,[].slice.call(arguments,1))}})),exports.isContext=function(e){return e instanceof Context},exports.createScript=function(e){return exports.Script(e)},exports.createContext=Script.createContext=function(e){var t=new Context;return"object"===typeof e&&forEach(Object_keys(e),(function(a){t[a]=e[a]})),t}},"1f0c":function(e,t,a){},"221d":function(e,t,a){"use strict";var i=a("2550"),n=a.n(i);n.a},"24b2":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("div",{staticClass:"title"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",{staticClass:"actived"},[e._v("绿色优质产品")])],1)],1),a("div",{staticClass:"box"},[a("el-tabs",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{type:"border-card"},on:{"tab-click":e.getList},model:{value:e.activeTabName,callback:function(t){e.activeTabName=t},expression:"activeTabName"}},[a("el-tab-pane",{attrs:{label:"绿色食品",name:"greeFood"}},[a("greenFood",{attrs:{year:e.year}})],1),a("el-tab-pane",{attrs:{label:"有机农产品",name:"organicProduce"}},[a("organicProduce",{attrs:{year:e.year}})],1),a("el-tab-pane",{attrs:{label:"种植业绿色优质基地",name:"plantingGreenBase"}},[a("plantingGreenBase",{attrs:{year:e.year}})],1),a("el-tab-pane",{attrs:{label:"种植业乡镇统计",name:"plantingTownshipStatistics"}},[a("plantingTownshipStatistics",{attrs:{year:e.year}})],1),a("el-tab-pane",{attrs:{label:"畜牧业绿色优质基地",name:"animalHusbandryBase"}},[a("animalHusbandryBase",{attrs:{year:e.year}})],1),a("el-tab-pane",{attrs:{label:"绿色优质农产品占比",name:"greenAgriculturalProducts"}},[a("greenAgriculturalProducts",{attrs:{year:e.year}})],1)],1)],1)])},n=[],r=a("55a1"),o=(a("d1a0"),a("bc3a"),a("0010")),l=(a("0706"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"box"},[a("el-dialog",{attrs:{visible:e.openDialog,width:"60%","before-close":e.handleClose},on:{"update:visible":function(t){e.openDialog=t}}},[a("el-form",{ref:"dynamicValidateForm",attrs:{model:e.dynamicValidateForm}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"年度："}},[a("el-row",[a("el-col",{attrs:{span:4}},[a("el-input",{attrs:{rules:[{required:!0,message:"请插入",trigger:"blur"},{type:"number",message:"插入号码",trigger:"blur"}],span:3},model:{value:e.inYear,callback:function(t){e.inYear=t},expression:"inYear"}})],1)],1)],1),a("el-form-item",{staticClass:"left-margin flex-box w-100 no-margin-IE"},[e._l(e.dynamicValidateForm.data,(function(t,i){return a("el-row",{key:i,staticClass:"margin-top-10"},[a("el-col",{attrs:{span:1}},[a("el-form-item",{staticClass:"margin-left-20"},[a("el-checkbox",{staticClass:"form-checkbox",attrs:{"true-label":"1","false-label":"0"},on:{change:function(t){return e.changeCheckStatus(i)}},model:{value:e.checked[i],callback:function(t){e.$set(e.checked,i,t)},expression:"checked[index]"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"板块：",prop:"data."+i+".town",rules:{required:!0,message:"请选择",trigger:"blur"}}},[a("el-select",{staticClass:"w-80",model:{value:t.town,callback:function(a){e.$set(t,"town",a)},expression:"rowData.town"}},e._l(e.township,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1),a("el-col",{attrs:{span:5}},[a("el-form-item",{staticClass:"margin-left-20",attrs:{label:"1-6月实绩:",prop:"data."+i+".halfYear"}},[a("el-input",{staticClass:"w-60",model:{value:t.halfYear,callback:function(a){e.$set(t,"halfYear",e._n(a))},expression:"rowData.halfYear"}})],1)],1),a("el-col",{attrs:{span:5}},[a("el-form-item",{staticClass:"margin-left-20",attrs:{label:"全年实绩:",prop:"data."+i+".fullYear"}},[a("el-input",{staticClass:"w-60",model:{value:t.fullYear,callback:function(a){e.$set(t,"fullYear",e._n(a))},expression:"rowData.fullYear"}})],1)],1)],1)})),a("el-row",{staticClass:"margin-left-40 margin-top-20"},[a("el-col",{attrs:{span:14}},[a("el-button",{attrs:{size:"small",type:"primary",plain:""},on:{click:function(t){return e.addFormRow()}}},[e._v("添加")]),a("el-button",{attrs:{size:"small",type:"danger",plain:""},on:{click:function(t){return e.deleteSelectedRows()}}},[e._v("删除")])],1),a("el-col",{directives:[{name:"show",rawName:"v-show",value:e.dynamicValidateForm.data.length>0,expression:"dynamicValidateForm.data.length > 0"}],attrs:{span:7}},[a("span",[e._v("插入时间: ")]),a("el-date-picker",{attrs:{type:"date"},model:{value:e.registerTime,callback:function(t){e.registerTime=t},expression:"registerTime"}})],1),a("el-col",{directives:[{name:"show",rawName:"v-show",value:e.dynamicValidateForm.data.length>0,expression:"dynamicValidateForm.data.length > 0"}],attrs:{span:2}},[a("el-button",{attrs:{size:"small",type:"success",plain:""},on:{click:function(t){return e.onSubmit("dynamicValidateForm")}}},[e._v("保存")])],1)],1)],2)],1)],1),a("el-dialog",{attrs:{visible:e.confirm_dialogVisible,width:"30%",modal:""},on:{"update:visible":function(t){e.confirm_dialogVisible=t}}},[a("span",[a("i",{staticClass:"el-icon-warning"},[e._v(" 继续？请再次检查")])]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small",type:"primary",plain:""},on:{click:function(t){e.confirm_dialogVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{size:"small",type:"success",plain:""},on:{click:function(t){return e.updateSelectedRows()}}},[e._v("确认")])],1)]),a("el-container",[a("el-header",{staticClass:"margin-bottom-10"},[e._v("镇（街道）、开发区推进高质量发展考核指标数据填报表")]),a("div",{staticClass:"iptBox"},[a("el-row",{staticClass:"w-80"},[a("el-col",{attrs:{span:2}},[a("el-button",{attrs:{size:"small",type:"success",plain:""},on:{click:function(t){return e.showAddDialog()}}},[e._v("添加")])],1),a("el-col",{attrs:{span:6}},[a("span",[e._v("开始日期: ")]),a("el-date-picker",{staticStyle:{width:"150px"},attrs:{type:"date"},model:{value:e.registerTimeFrom,callback:function(t){e.registerTimeFrom=t},expression:"registerTimeFrom"}})],1),a("el-col",{attrs:{span:6}},[a("span",[e._v("结束日期: ")]),a("el-date-picker",{staticStyle:{width:"150px"},attrs:{type:"date"},model:{value:e.registerTimeTo,callback:function(t){e.registerTimeTo=t},expression:"registerTimeTo"}})],1),a("el-col",{attrs:{span:4}},[a("span",[e._v("年度: ")]),a("el-input",{staticClass:"w-60",nativeOn:{keyup:function(t){return e.handleChange(t)}},model:{value:e.searchYear,callback:function(t){e.searchYear=t},expression:"searchYear"}})],1),a("el-col",{attrs:{span:1}},[a("el-button",{staticClass:"margin-left-10",attrs:{size:"small",type:"primary",plain:""},on:{click:function(t){return e.changeFilter()}}},[e._v("搜索")])],1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,"row-class-name":e.rowIndex,"highlight-current-row":"","span-method":e.spanMethod}},[a("el-table-column",{attrs:{formatter:e.order,label:"序号",width:"100"}}),a("el-table-column",{attrs:{prop:"town",label:"板块"}}),a("el-table-column",{attrs:{label:"绿色优质农产品比重(畜牧)",align:"center"}},e._l(e.columns,(function(e){return a("el-table-column",{key:e.prop,attrs:{prop:e.prop,label:e.label,align:"center"}})})),1)],1)],1)],1)}),s=[],c=(a("7f7f"),a("7514"),a("ac6a"),a("55dd"),a("6b54"),a("c5f6"),{name:"animalHusbandryBase",props:{year:{required:!0,type:Number}},data:function(){return{inYear:0,searchYear:(new Date).getFullYear().toString(),openDialog:!1,columns:[{prop:"halfYear",label:"1-6月实绩"},{prop:"fullYear",label:"全年实绩"}],dynamicValidateForm:{data:[]},selectedRows:[],township:[],confirm_dialogVisible:!1,checked:[],registerTime:(new Date).toString("YYYY-MM-DD"),registerTimeFrom:new Date((new Date).getFullYear(),0,1),registerTimeTo:new Date,sendcount:0,alert_dialogVisible:!1,loggedinUserType:null,total:0,tableData:[],listLoading:!0}},created:function(){this.getTown(),this.getData()},methods:{showAddDialog:function(){this.dynamicValidateForm.data=[],this.selectedRows=[],this.checked=[],this.inYear=Number((new Date).getFullYear()),this.addFormRow(),this.openDialog=!0},getTown:function(){var e=this;Object(r["a"])().get("/api/town/all").then((function(t){e.township=e.township.concat(t)})).catch((function(e){console.log(e)}))},handleClose:function(e){var t=this;this.$confirm("您确定要关闭此对话框吗？").then((function(a){t.getData(),e()})).catch((function(e){}))},addFormRow:function(){this.dynamicValidateForm.data.push({town:"",fullYear:0,halfYear:0})},deleteSelectedRows:function(){if(this.selectedRows.length){for(var e in this.selectedRows=this.selectedRows.sort((function(e,t){return e>t?-1:1})),this.selectedRows){var t=this.dynamicValidateForm.data[this.selectedRows[e]].id;t&&this.deletedRows.push(t),this.checked[this.selectedRows[e]]=!1,this.dynamicValidateForm.data.splice(this.selectedRows[e],1)}this.selectedRows=[]}},onSubmit:function(e){var t=this;this.$refs[e].validate((function(e){e&&(t.confirm_dialogVisible=!0)}))},changeCheckStatus:function(e){var t=this.selectedRows.indexOf(e);t>-1&&this.selectedRows.splice(t,1),1==this.checked[e]&&this.selectedRows.push(e)},updateSelectedRows:function(){var e=this;this.confirm_dialogVisible=!1,this.openDialog=!1;var t=new Date,a=new Date;this.listLoading=!0,this.sendcount=0,this.dynamicValidateForm.data.forEach((function(i){var n=new FormData;n.append("createTime",a.toDateString("YYYY-MM-DD")),n.append("createUserId",Object(o["a"])().user().id),n.append("fullYear",void 0==i.fullYear||""==i.fullYear?-1:i.fullYear),n.append("halfYear",void 0==i.halfYear||""==i.halfYear?-1:i.halfYear),n.append("id",0),n.append("registerTime",e.registerTime.toString("YYYY-MM-DD")),n.append("town",e.filterTownship(i.town)),n.append("year",e.inYear),n.append("updateTime",t.toDateString("YYYY-MM-DD")),n.append("updateUserId",Object(o["a"])().user().id),Object(r["a"])().post("/api/green/livestock/create",n).then((function(t){e.sendcount++,e.sendcount===e.dynamicValidateForm.data.length&&(e.listLoading=!1,e.getData())}))}))},changeFilter:function(){this.getData()},handleChange:function(){this.searchYear>1990&&(this.registerTimeFrom=new Date(this.searchYear,0,1))},getData:function(){var e=this;this.listLoading=!0;var t=new Date(this.registerTimeTo.getFullYear(),this.registerTimeTo.getMonth(),this.registerTimeTo.getDate(),23,59,59);Object(r["a"])().get("/api/green/livestock/all",{registerTimeFrom:""==this.registerTimeFrom||null==this.registerTimeFrom?"":this.registerTimeFrom,registerTimeTo:""==this.registerTimeTo||null==this.registerTimeTo?"":t,sortBy:"id",year:this.searchYear}).then((function(t){e.tableData=t.data,e.total=e.tableData.length,e.calculateTotal(),e.listLoading=!1,e.tableData.forEach((function(e){e.halfYear=-1==e.halfYear?"/":parseFloat(e.halfYear).toFixed(2),e.fullYear=-1==e.fullYear?"/":parseFloat(e.fullYear).toFixed(2)}))}))},filterTownship:function(e){var t=this.township.find((function(t){return t.id===e}));return t?t.name:""},calculateTotal:function(){var e=0,t=0;this.tableData.forEach((function(a){e+=-1==a.halfYear?0:a.halfYear,t+=-1==a.fullYear?0:a.fullYear})),this.tableData.push({town:"合计",halfYear:e,fullYear:t})},spanMethod:function(e){e.row,e.column;var t=e.rowIndex,a=e.columnIndex;if(t==this.tableData.length-1){if(1==a)return{rowspan:1,colspan:2};if(0==a)return{rowspan:0,colspan:0}}},rowIndex:function(e){var t=e.row,a=e.rowIndex;t.rowIndex=a},order:function(e){return e.rowIndex+1}}}),d=c,p=(a("3b62"),a("2877")),u=Object(p["a"])(d,l,s,!1,null,null,null),m=u.exports,h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"box"},[a("el-dialog",{attrs:{visible:e.openDialog,width:"90%","before-close":e.handleClose},on:{"update:visible":function(t){e.openDialog=t}}},[a("el-form",{ref:"dynamicValidateForm",attrs:{model:e.dynamicValidateForm}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"年度："}},[a("el-row",[a("el-col",{attrs:{span:2}},[a("el-input",{attrs:{rules:[{required:!0,message:"请插入",trigger:"blur"},{type:"number",message:"插入号码",trigger:"blur"}],span:3},model:{value:e.inYear,callback:function(t){e.inYear=t},expression:"inYear"}})],1)],1)],1),a("el-form-item",{staticClass:"left-margin flex-box w-100 no-margin-IE"},[e._l(e.dynamicValidateForm.data,(function(t,i){return a("el-row",{key:i},[a("el-col",{attrs:{span:1}},[a("el-form-item",{staticClass:"margin-left-20"},[a("el-checkbox",{staticClass:"form-checkbox",attrs:{"true-label":"1","false-label":"0"},on:{change:function(t){return e.changeCheckStatus(i)}},model:{value:e.checked[i],callback:function(t){e.$set(e.checked,i,t)},expression:"checked[index]"}})],1)],1),a("el-col",{attrs:{span:2}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"板块：",prop:"data."+i+".town",rules:{required:!0,message:"请选择",trigger:"blur"}}},[a("el-select",{staticClass:"w-100",model:{value:t.town,callback:function(a){e.$set(t,"town",a)},expression:"rowData.town"}},e._l(e.township,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1),a("el-col",{attrs:{span:2}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"种植业占比:",number:"",prop:"data."+i+".planting",rules:[{type:"number",message:"插入号码"}]}},[a("el-input",{model:{value:t.planting,callback:function(a){e.$set(t,"planting",e._n(a))},expression:"rowData.planting"}})],1)],1),a("el-col",{attrs:{span:2}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"畜牧业占比:",prop:"data."+i+".livestock",rules:[{type:"number",message:"插入号码"}]}},[a("el-input",{model:{value:t.livestock,callback:function(a){e.$set(t,"livestock",e._n(a))},expression:"rowData.livestock"}})],1)],1),a("el-col",{attrs:{span:4}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"绿色优质农产品占比:",prop:"data."+i+".highQuality",rules:[{type:"number",message:"插入号码"}]}},[a("el-input",{model:{value:t.highQuality,callback:function(a){e.$set(t,"highQuality",e._n(a))},expression:"rowData.highQuality"}})],1)],1),a("el-col",{attrs:{span:4}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"下半年种植业预计占比:",prop:"data."+i+".plantingHalfPlan",rules:[{type:"number",message:"插入号码"}]}},[a("el-input",{model:{value:t.plantingHalfPlan,callback:function(a){e.$set(t,"plantingHalfPlan",e._n(a))},expression:"rowData.plantingHalfPlan"}})],1)],1),a("el-col",{attrs:{span:4}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"下半年畜牧业预计占比:",prop:"data."+i+".livestockHalfPlan",rules:[{type:"number",message:"插入号码"}]}},[a("el-input",{model:{value:t.livestockHalfPlan,callback:function(a){e.$set(t,"livestockHalfPlan",e._n(a))},expression:"rowData.livestockHalfPlan"}})],1)],1),a("el-col",{attrs:{span:4}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"绿色优质农产品预计占比:",prop:"data."+i+".highQualityPlan",rules:[{type:"number",message:"插入号码"}]}},[a("el-input",{model:{value:t.highQualityPlan,callback:function(a){e.$set(t,"highQualityPlan",e._n(a))},expression:"rowData.highQualityPlan"}})],1)],1)],1)})),a("el-row",{staticClass:"margin-left-40 margin-top-20"},[a("el-col",{attrs:{span:17}},[a("el-button",{attrs:{size:"small",type:"primary",plain:""},on:{click:function(t){return e.addFormRow()}}},[e._v("添加")]),a("el-button",{attrs:{size:"small",type:"danger",plain:""},on:{click:function(t){return e.deleteSelectedRows()}}},[e._v("删除")])],1),a("el-col",{directives:[{name:"show",rawName:"v-show",value:e.dynamicValidateForm.data.length>0,expression:"dynamicValidateForm.data.length > 0"}],attrs:{span:4}},[a("span",[e._v("插入时间: ")]),a("el-date-picker",{staticStyle:{width:"180px"},attrs:{type:"date"},model:{value:e.registerTime,callback:function(t){e.registerTime=t},expression:"registerTime"}})],1),a("el-col",{directives:[{name:"show",rawName:"v-show",value:e.dynamicValidateForm.data.length>0,expression:"dynamicValidateForm.data.length > 0"}],attrs:{span:2}},[a("el-button",{attrs:{size:"small",type:"success",plain:""},on:{click:function(t){return e.onSubmit("dynamicValidateForm")}}},[e._v("保存")])],1)],1)],2)],1)],1),a("el-dialog",{attrs:{visible:e.confirm_dialogVisible,width:"30%",modal:""},on:{"update:visible":function(t){e.confirm_dialogVisible=t}}},[a("span",[a("i",{staticClass:"el-icon-warning"},[e._v(" 继续？请再次检查")])]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small",type:"primary",plain:""},on:{click:function(t){e.confirm_dialogVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{size:"small",type:"success",plain:""},on:{click:function(t){return e.updateSelectedRows()}}},[e._v("确认")])],1)]),a("el-container",[a("el-header",{staticClass:"margin-bottom-10"},[e._v("绿色优质农产品统计汇总")]),a("div",{staticClass:"iptBox"},[a("el-row",{staticClass:"w-80"},[a("el-col",{attrs:{span:2}},[a("el-button",{attrs:{size:"small",type:"success",plain:""},on:{click:function(t){return e.showAddDialog()}}},[e._v("添加")])],1),a("el-col",{attrs:{span:6}},[a("span",[e._v("开始日期: ")]),a("el-date-picker",{staticStyle:{width:"150px"},attrs:{type:"date"},model:{value:e.registerTimeFrom,callback:function(t){e.registerTimeFrom=t},expression:"registerTimeFrom"}})],1),a("el-col",{attrs:{span:6}},[a("span",[e._v("结束日期: ")]),a("el-date-picker",{staticStyle:{width:"150px"},attrs:{type:"date"},model:{value:e.registerTimeTo,callback:function(t){e.registerTimeTo=t},expression:"registerTimeTo"}})],1),a("el-col",{attrs:{span:4}},[a("span",[e._v("年度: ")]),a("el-input",{staticClass:"w-60",nativeOn:{keyup:function(t){return e.handleChange(t)}},model:{value:e.searchYear,callback:function(t){e.searchYear=t},expression:"searchYear"}})],1),a("el-col",{attrs:{span:1}},[a("el-button",{staticClass:"margin-left-10",attrs:{size:"small",type:"primary",plain:""},on:{click:function(t){return e.changeFilter()}}},[e._v("搜索")])],1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,"row-class-name":e.rowIndex,"highlight-current-row":"",border:"","span-method":e.spanMethod}},[a("el-table-column",{attrs:{formatter:e.order,label:"序号"}}),a("el-table-column",{attrs:{prop:"town",label:"板块"}}),a("el-table-column",{attrs:{prop:"planting",label:"种植业占比"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(a.planting=-1==a.planting?0:a.planting)+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"livestock",label:"畜牧业占比"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(a.livestock=-1==a.livestock?0:a.livestock)+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"highQuality",label:"绿色优质农产品占比"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(a.highQuality=-1==a.highQuality?"/":a.highQuality)+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"plantingHalfPlan",label:"下半年种植业预计占比"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(a.plantingHalfPlan=-1==a.plantingHalfPlan?"/":a.plantingHalfPlan)+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"livestockHalfPlan",label:"下半年畜牧业预计占比"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(a.livestockHalfPlan=-1==a.livestockHalfPlan?"/":a.livestockHalfPlan)+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"highQualityPlan",label:"绿色优质农产品预计占比"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n          "+e._s(a.highQualityPlan=-1==a.highQualityPlan?"/":a.highQualityPlan)+"\n        ")]}}])})],1)],1)],1)},g=[],f={name:"greenAgriculturalProducts",props:{year:{required:!0,type:Number}},data:function(){return{inYear:0,searchYear:(new Date).getFullYear().toString(),openDialog:!1,dynamicValidateForm:{data:[]},selectedRows:[],township:[],confirm_dialogVisible:!1,checked:[],registerTime:(new Date).toString("YYYY-MM-DD"),registerTimeFrom:new Date((new Date).getFullYear(),0,1),registerTimeTo:new Date,sendcount:0,alert_dialogVisible:!1,total:0,tableData:[],listLoading:!0}},created:function(){this.getTown(),this.getData()},methods:{showAddDialog:function(){this.dynamicValidateForm.data=[],this.selectedRows=[],this.checked=[],this.inYear=Number((new Date).getFullYear()),this.addFormRow(),this.openDialog=!0},handleClose:function(e){var t=this;this.$confirm("您确定要关闭此对话框吗？").then((function(a){t.getData(),e()})).catch((function(e){}))},getTown:function(){var e=this;Object(r["a"])().get("/api/town/all").then((function(t){e.township=e.township.concat(t)})).catch((function(e){console.log(e)}))},addFormRow:function(){this.dynamicValidateForm.data.push({town:"",fullYear:0,halfYear:0})},deleteSelectedRows:function(){if(this.selectedRows.length){for(var e in this.selectedRows=this.selectedRows.sort((function(e,t){return e>t?-1:1})),this.selectedRows){var t=this.dynamicValidateForm.data[this.selectedRows[e]].id;t&&this.deletedRows.push(t),this.checked[this.selectedRows[e]]=!1,this.dynamicValidateForm.data.splice(this.selectedRows[e],1)}this.selectedRows=[]}},onSubmit:function(e){var t=this;this.$refs[e].validate((function(e){e&&(t.confirm_dialogVisible=!0)}))},changeCheckStatus:function(e){var t=this.selectedRows.indexOf(e);t>-1&&this.selectedRows.splice(t,1),1==this.checked[e]&&this.selectedRows.push(e)},updateSelectedRows:function(){var e=this;this.confirm_dialogVisible=!1,this.openDialog=!1;var t=new Date,a=new Date;this.listLoading=!0,this.sendcount=0,this.dynamicValidateForm.data.forEach((function(i){var n=new FormData;n.append("createTime",a.toDateString("YYYY-MM-DD")),n.append("createUserId",Object(o["a"])().user().id),n.append("highQuality",void 0==i.highQuality||""==i.highQuality?-1:i.highQuality),n.append("highQualityPlan",void 0==i.highQualityPlan||""==i.highQualityPlan?-1:i.highQualityPlan),n.append("id",0),n.append("livestock",void 0==i.livestock||""==i.livestock?-1:i.livestock),n.append("livestockHalfPlan",void 0==i.livestockHalfPlan||""==i.livestockHalfPlan?-1:i.livestockHalfPlan),n.append("planting",void 0==i.planting||""==i.planting?-1:i.planting),n.append("plantingHalfPlan",void 0==i.plantingHalfPlan||""==i.plantingHalfPlan?-1:i.plantingHalfPlan),n.append("registerTime",e.registerTime.toString("YYYY-MM-DD")),n.append("town",e.filterTownship(i.town)),n.append("updateTime",t.toDateString("YYYY-MM-DD")),n.append("updateUserId",Object(o["a"])().user().id),n.append("year",e.inYear),Object(r["a"])().post("/api/green/product_ratio/create",n).then((function(t){e.sendcount++,e.sendcount===e.dynamicValidateForm.data.length&&(e.listLoading=!1,e.getData())}))}))},changeFilter:function(){this.getData()},filterTownship:function(e){var t=this.township.find((function(t){return t.id===e}));return t?t.name:""},handleChange:function(){this.searchYear>1990&&(this.registerTimeFrom=new Date(this.searchYear,0,1))},getData:function(){var e=this;this.listLoading=!0;var t=new Date(this.registerTimeTo.getFullYear(),this.registerTimeTo.getMonth(),this.registerTimeTo.getDate(),23,59,59);Object(r["a"])().get("/api/green/product_ratio/all",{registerTimeFrom:""==this.registerTimeFrom||null==this.registerTimeFrom?"":this.registerTimeFrom,registerTimeTo:""==this.registerTimeTo||null==this.registerTimeTo?"":t,sortBy:"id",year:this.searchYear}).then((function(t){e.tableData=t.data,e.total=e.tableData.length,e.calcualteTotal(),e.tableData.forEach((function(e){e.planting=-1==e.planting?"/":parseFloat(e.planting).toFixed(2),e.livestock=-1==e.livestock?"/":parseFloat(e.livestock).toFixed(2),e.highQuality=-1==e.highQuality?"/":parseFloat(e.highQuality).toFixed(2),e.plantingHalfPlan=-1==e.plantingHalfPlan?"/":parseFloat(e.plantingHalfPlan).toFixed(2),e.livestockHalfPlan=-1==e.livestockHalfPlan?"/":parseFloat(e.livestockHalfPlan).toFixed(2),e.highQualityPlan=-1==e.highQualityPlan?"/":parseFloat(e.highQualityPlan).toFixed(2)})),e.listLoading=!1}))},calcualteTotal:function(){var e=0,t=0,a=0,i=0,n=0,r=0;this.tableData.forEach((function(o){e+=-1==o.planting?0:o.planting,t+=-1==o.livestock?0:o.livestock,a+=-1==o.highQuality?0:o.highQuality,i+=-1==o.plantingHalfPlan?0:o.plantingHalfPlan,n+=-1==o.livestockHalfPlan?0:o.livestockHalfPlan,r+=-1==o.highQualityPlan?0:o.highQualityPlan})),this.tableData.push({town:"合计",planting:e,livestock:t,highQuality:a,plantingHalfPlan:i,livestockHalfPlan:n,highQualityPlan:r})},spanMethod:function(e){e.row,e.column;var t=e.rowIndex,a=e.columnIndex;if(t==this.tableData.length-1){if(0==a)return{rowspan:0,colspan:0};if(1==a)return{rowspan:1,colspan:2}}},rowIndex:function(e){var t=e.row,a=e.rowIndex;t.rowIndex=a},order:function(e){return e.rowIndex+1}}},b=f,w=(a("66ec"),Object(p["a"])(b,h,g,!1,null,null,null)),v=w.exports,y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"box padding-top-10"},[a("el-dialog",{attrs:{visible:e.show_addDialog,width:"80%","before-close":e.handleClose,title:"添加绿色食品"},on:{"update:visible":function(t){e.show_addDialog=t}}},[a("el-form",{ref:"dynamicValidateForm",attrs:{model:e.dynamicValidateForm}},[e._l(e.dynamicValidateForm.rowDatas,(function(t,i){return a("el-row",{key:i},[a("el-col",{attrs:{span:1}},[a("el-form-item",{staticClass:"margin-left-20"},[a("el-checkbox",{staticClass:"form-checkbox",attrs:{"true-label":"1","false-label":"0"},on:{change:function(t){return e.changeCheckStatus(i)}},model:{value:e.checked[i],callback:function(t){e.$set(e.checked,i,t)},expression:"checked[index]"}})],1)],1),a("el-col",{staticClass:"margin-left-10",attrs:{span:3}},[a("el-form-item",{attrs:{label:"板块：",prop:"rowDatas."+i+".town",rules:{required:!0,message:"请选择",trigger:"blur"}}},[a("el-select",{staticClass:"w-100",model:{value:t.town,callback:function(a){e.$set(t,"town",a)},expression:"rowData.town"}},e._l(e.township,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1),a("el-col",{staticClass:"margin-left-10",attrs:{span:4}},[a("el-form-item",{attrs:{label:"生产单位:",prop:"rowDatas."+i+".companyId",rules:{required:!0,message:"请选择",trigger:"blur"}}},[a("el-select",{staticClass:"w-100",model:{value:t.companyId,callback:function(a){e.$set(t,"companyId",a)},expression:"rowData.companyId"}},e._l(e.companyProduction,(function(e){return a("el-option",{key:e.companyId,attrs:{label:e.companyName,value:e.companyId}})})),1)],1)],1),a("el-col",{staticClass:"margin-left-10",attrs:{span:4}},[a("el-form-item",{attrs:{label:"产品名称:",prop:"rowDatas."+i+".productName"}},[a("el-input",{model:{value:t.productName,callback:function(a){e.$set(t,"productName",a)},expression:"rowData.productName"}})],1)],1),a("el-col",{staticClass:"margin-left-10",attrs:{span:3}},[a("el-form-item",{attrs:{label:"产品证书编号:",prop:"rowDatas."+i+".productCreditCode"}},[a("el-input",{model:{value:t.productCreditCode,callback:function(a){e.$set(t,"productCreditCode",a)},expression:"rowData.productCreditCode"}})],1)],1),a("el-col",{staticClass:"margin-left-10",attrs:{span:2}},[a("el-form-item",{attrs:{label:"基地面积(亩):",prop:"rowDatas."+i+".area",rules:[{type:"number",message:"插入号码"}]}},[a("el-input",{model:{value:t.area,callback:function(a){e.$set(t,"area",e._n(a))},expression:"rowData.area"}})],1)],1),a("el-col",{staticClass:"margin-left-10",attrs:{span:2}},[a("el-form-item",{attrs:{label:"产量(吨):",prop:"rowDatas."+i+".amount",rules:[{type:"number",message:"插入号码"}]}},[a("el-input",{model:{value:t.amount,callback:function(a){e.$set(t,"amount",e._n(a))},expression:"rowData.amount"}})],1)],1),a("el-col",{staticClass:"margin-left-10",attrs:{span:3}},[a("el-form-item",{attrs:{label:"基地地址(到村):",prop:"rowDatas."+i+".location",rules:{required:!0,message:"请插入",trigger:"blur"}}},[a("el-input",{model:{value:t.location,callback:function(a){e.$set(t,"location",a)},expression:"rowData.location"}})],1)],1)],1)})),a("el-row",[a("el-col",{attrs:{span:15}})],1),a("el-row",{staticClass:"left-margin flex-box w-100 no-margin-IE"},[a("el-col",{attrs:{span:4}},[a("el-button",{attrs:{size:"small",type:"primary",plain:""},on:{click:function(t){return e.addFormRow()}}},[e._v("添加")]),a("el-button",{attrs:{size:"small",type:"danger",plain:""},on:{click:function(t){return e.deleteSelectedRows()}}},[e._v("删除")])],1),a("el-col",{staticClass:"margin-top-10 text-right",attrs:{span:16}},[e._v("插入时间：")]),a("el-col",{attrs:{span:3}},[a("el-date-picker",{staticClass:"w-80",attrs:{align:"right",type:"date"},model:{value:e.registerTime,callback:function(t){e.registerTime=t},expression:"registerTime"}})],1),a("el-col",{attrs:{span:1}},[a("el-button",{staticClass:"margin-right-40",staticStyle:{float:"right"},attrs:{size:"small",type:"success",plain:""},on:{click:function(t){return e.onSubmit("dynamicValidateForm")}}},[e._v("保存")])],1)],1)],2)],1),a("el-dialog",{attrs:{visible:e.confirm_dialogVisible,width:"30%",modal:""},on:{"update:visible":function(t){e.confirm_dialogVisible=t}}},[a("span",[a("i",{staticClass:"el-icon-warning"},[e._v(" 继续？请再次检查")])]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small",type:"primary",plain:""},on:{click:function(t){e.confirm_dialogVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{size:"small",type:"success",plain:""},on:{click:function(t){return e.updateSelectedRows()}}},[e._v("确认")])],1)]),a("el-container",[a("el-header",{staticClass:"margin-bottom-10"},[e._v("常熟市"+e._s(e.curYear)+"年上半年度种植业绿色食品统计汇总")]),a("el-row",{staticClass:"margin-bottom-20"},[a("el-col",{attrs:{span:1}},[a("el-button",{attrs:{plain:"",type:"success",size:"small"},on:{click:function(t){return e.showAddDialog()}}},[e._v("添加")])],1),a("el-col",{attrs:{span:4}},[a("div",{staticClass:"select_label margin-left-20 margin-right-5"},[e._v("\n          开始日期 :\n        ")]),a("el-date-picker",{staticStyle:{width:"150px"},attrs:{align:"right",type:"date",placeholder:"插入时间 "},model:{value:e.registerTimeFrom,callback:function(t){e.registerTimeFrom=t},expression:"registerTimeFrom"}})],1),a("el-col",{attrs:{span:4}},[a("div",{staticClass:"select_label margin-left-20 margin-right-5"},[e._v("\n          结束日期 :\n        ")]),a("el-date-picker",{staticStyle:{width:"150px"},attrs:{align:"right",type:"date",placeholder:"插入时间 "},model:{value:e.registerTimeTo,callback:function(t){e.registerTimeTo=t},expression:"registerTimeTo"}})],1),a("el-col",{attrs:{span:4}},[a("div",{staticClass:"select_label margin-left-20 margin-right-5"},[e._v("板块 :")]),a("el-input",{staticClass:"w-60",attrs:{align:"right"},model:{value:e.searchTown,callback:function(t){e.searchTown=t},expression:"searchTown"}})],1),a("el-col",{attrs:{span:4}},[a("div",{staticClass:"select_label no-margin-left margin-right-5"},[e._v("\n          生产单位 :\n        ")]),a("el-input",{staticClass:"w-60",attrs:{align:"right"},model:{value:e.searchCompanyName,callback:function(t){e.searchCompanyName=t},expression:"searchCompanyName"}})],1),a("el-col",{attrs:{span:4}},[a("div",{staticClass:"select_label no-margin-left margin-right-5"},[e._v("\n          已获证书 :\n        ")]),a("el-select",{staticClass:"w-50",attrs:{align:"right",type:"date"},model:{value:e.isCredit,callback:function(t){e.isCredit=t},expression:"isCredit"}},e._l(e.option,(function(e){return a("el-option",{key:e.val,attrs:{label:e.label,value:e.val}})})),1)],1),a("el-col",{attrs:{span:2}},[a("el-button",{attrs:{plain:"",type:"primary",size:"small"},on:{click:function(t){return e.getData()}}},[e._v("搜索")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"","row-class-name":e.rowIndex,"span-method":e.mainSpanMethod,"highlight-current-row":""}},[a("el-table-column",{attrs:{formatter:e.order,label:"序号",width:"100"}}),a("el-table-column",{attrs:{prop:"plate.value",label:"板块"}}),a("el-table-column",{attrs:{prop:"productionUnit.value",label:"生产单位"}}),a("el-table-column",{attrs:{prop:"productName.value",label:"产品名称"}}),a("el-table-column",{attrs:{prop:"productCertificateNum.value",label:"产品证书编号",width:"200"}}),a("el-table-column",{attrs:{prop:"baseArea.value",label:"基地面积(亩)"}}),a("el-table-column",{attrs:{prop:"production.value",label:"产量(吨)"}}),a("el-table-column",{attrs:{prop:"baseAddress.value",label:"基地地址(到村)"}}),a("el-table-column",{staticStyle:{color:"black"},attrs:{label:"面积统计",align:"center"}},e._l(e.columns,(function(e){return a("el-table-column",{key:e.prop,attrs:{prop:e.prop,label:e.label,align:"center"}})})),1)],1)],1),a("div",{staticClass:"pageBox"},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],attrs:{total:e.total,page:e.page.pageIndex,limit:e.page.pageSize},on:{"update:page":function(t){return e.$set(e.page,"pageIndex",t)},"update:limit":function(t){return e.$set(e.page,"pageSize",t)},pagination:e.getData}})],1)],1)},D=[],k=a("062e"),x={name:"greenFood",components:{Pagination:k["default"]},props:{year:{required:!0,type:Number}},data:function(){return{curYear:(new Date).getFullYear(),option:[{val:0,label:"全部"},{val:1,label:"是"},{val:2,label:"否"}],columns:[{prop:"certified.value",label:"已获证"},{prop:"declared.value",label:"已申报"}],isCredit:0,searchTown:"",searchCompanyName:"",registerTimeTo:new Date,registerTimeFrom:new Date((new Date).getFullYear(),0,1),show_addDialog:!1,confirm_dialogVisible:!1,selectedTown:null,selectedRows:[],township:[],companyProduction:[],dynamicValidateForm:{rowDatas:[{town:null,companyId:-1,productName:"",productCreditCode:"",area:null,amount:null,location:""}]},registerTime:new Date,page:{pageIndex:1,pageSize:20},checked:[],total:0,tableData:[],objectData:[],listLoading:!1}},created:function(){this.getTown(),this.getCompanyProduction(),this.getData()},methods:{arrangeData:function(){var e=this,t=this.objectData;this.total=t.length;var a=0;t.forEach((function(t){var i=0;t.productionInfo.forEach((function(n){var r=0;n.productUnitInfo.forEach((function(i){e.tableData.push({plate:{value:t.plate,spaning:0},productionUnit:{value:n.productionUnit,spaning:0},productName:{value:i.productName,spaning:0},productCertificateNum:{value:i.productCertificateNum,spaning:0},baseArea:{value:i.baseArea,spaning:0},production:{value:i.production,spaning:0},baseAddress:{value:n.baseAddress,spaning:0},certified:{value:t.certified,spaning:0},declared:{value:t.declared,spaning:0}}),r++,a++})),e.tableData[a-r].productionUnit.spaning=r,e.tableData[a-r].baseAddress.spaning=r,i+=r})),e.tableData[a-i].plate.spaning=i,e.tableData[a-i].certified.spaning=i,e.tableData[a-i].declared.spaning=i})),this.tableData.push({plate:{value:"合计",spaning:0},productionUnit:{value:"",spaning:0},productName:{value:"",spaning:0},productCertificateNum:{value:"",spaning:0},baseArea:{value:this.baseQuality(),spaning:0},production:{value:this.productionQuality(),spaning:0},baseAddress:{value:"",spaning:0},certified:{value:this.cetifiyQuality(),spaning:0},declared:{value:this.declareQuality(),spaning:0}})},baseQuality:function(){var e=0;return this.objectData.forEach((function(t){t.productionInfo.forEach((function(t){t.productUnitInfo.forEach((function(t){e+="/"==t.baseArea?0:parseFloat(t.baseArea)}))}))})),e},productionQuality:function(){var e=0;return this.objectData.forEach((function(t){t.productionInfo.forEach((function(t){t.productUnitInfo.forEach((function(t){e+="/"==t.production?0:parseFloat(t.production)}))}))})),e},cetifiyQuality:function(){var e=0;return this.objectData.forEach((function(t){e+=t.certified})),e},declareQuality:function(){var e=0;return this.objectData.forEach((function(t){e+=t.declared})),e},mainSpanMethod:function(e){var t=e.row,a=(e.column,e.rowIndex),i=e.columnIndex;if(a<this.tableData.length-1){if(1===i)return t.plate.spaning>0?{rowspan:t.plate.spaning,colspan:1}:{rowspan:0,colspan:0};if(2===i)return t.productionUnit.spaning>0?{rowspan:t.productionUnit.spaning,colspan:1}:{rowspan:0,colspan:0};if(7===i)return t.baseAddress.spaning>0?{rowspan:t.baseAddress.spaning,colspan:1}:{rowspan:0,colspan:0};if(8===i)return t.certified.spaning>0?{rowspan:t.certified.spaning,colspan:1}:{rowspan:0,colspan:0};if(9===i)return t.declared.spaning>0?{rowspan:t.declared.spaning,colspan:1}:{rowspan:0,colspan:0}}else if(a==this.tableData.length-1){if(1==i)return{rowspan:1,colspan:2};if(2==i)return{rowspan:1,colspan:3};if(0==i||3==i||4==i)return{rowspan:0,colspan:0}}},getData:function(){var e=this;this.listLoading=!0,this.objectData=[],this.tableData=[];var t=new Date(this.registerTimeTo.getFullYear(),this.registerTimeTo.getMonth(),this.registerTimeTo.getDate(),23,59,59);console.log(this.registerTimeFrom,t),Object(r["a"])().get("/api/green/green_food/all",{registerTimeTo:t,registerTimeFrom:this.registerTimeFrom,companyName:this.searchCompanyName,town:this.searchTown,isCredit:this.isCredit}).then((function(t){var a,i,n=t.data,r="",o=[],l=[];if(n.length>0){for(var s=0;s<n.length;s++)r!==n[s].town?(o.length>0&&e.objectData.push({plate:r,productionInfo:o,certified:a,declared:i}),r=n[s].town,n[s].productCreditCode?(a=-1==n[s].area?0:n[s].area,i=0):(i=-1==n[s].area?0:n[s].area,a=0),l=[],o=[],l.push({productName:n[s].productName,productCertificateNum:n[s].productCreditCode,baseArea:-1==n[s].area?"/":parseFloat(n[s].area).toFixed(2),production:-1==n[s].amount?"/":parseFloat(n[s].amount).toFixed(2)}),o.push({productionUnit:n[s].companyName,productUnitInfo:l,baseAddress:n[s].location})):(n[s].productCreditCode?a+=parseFloat(-1==n[s].area?0:n[s].area):n[s].productCreditCode||(i+=parseFloat(-1==n[s].area?0:n[s].area)),n[s-1].companyName===n[s].companyName?l.push({productName:n[s].productName,productCertificateNum:n[s].productCreditCode,baseArea:-1==n[s].area?0:parseFloat(n[s].area).toFixed(2),production:-1==n[s].amount?"/":parseFloat(n[s].amount).toFixed(2)}):n[s-1].companyName!==n[s].companyName&&(l=[],l.push({productName:n[s].productName,productCertificateNum:n[s].productCreditCode,baseArea:-1==n[s].area?0:parseFloat(n[s].area).toFixed(2),production:-1==n[s].amount?"/":parseFloat(n[s].amount).toFixed(2)}),o.push({productionUnit:n[s].companyName,productUnitInfo:l,baseAddress:n[s].location})));o.length>0&&e.objectData.push({plate:r,productionInfo:o,certified:a,declared:i}),e.arrangeData()}else e.tableData=[];setTimeout((function(){e.listLoading=!1}),500)})).catch((function(e){console.log(e)}))},rowIndex:function(e){var t=e.row,a=e.rowIndex;t.rowIndex=a},order:function(e){return this.page.pageSize*(this.page.pageIndex-1)+e.rowIndex+1},showAddDialog:function(){this.dynamicValidateForm.rowDatas=[],this.addFormRow(),this.show_addDialog=!0},getTown:function(){var e=this;Object(r["a"])().get("/api/town/all").then((function(t){e.township=e.township.concat(t)})).catch((function(e){console.log(e)}))},getCompanyProduction:function(){var e=this;Object(r["a"])().get("/api/company_production/name").then((function(t){e.companyProduction=t})).catch((function(e){console.log(e)}))},addFormRow:function(){this.dynamicValidateForm.rowDatas.push({town:null,companyId:null,productName:"",productCreditCode:"",area:null,amount:null,location:"",registerTime:new Date})},showDialog:function(e,t){this.showWebMaster=2===t,this.selectedSupervisupervisorType=t,this.dynamicValidateForm.rowDatas=e,this.openDialog=!0,this.header=this.supervisorType[t-1]},changeCheckStatus:function(e){var t=this.selectedRows.indexOf(e);t>-1&&this.selectedRows.splice(t,1),1==this.checked[e]&&this.selectedRows.push(e)},deleteSelectedRows:function(){if(this.selectedRows.length){for(var e in this.selectedRows=this.selectedRows.sort((function(e,t){return e>t?-1:1})),this.selectedRows){var t=this.dynamicValidateForm.rowDatas[this.selectedRows[e]].id;t&&this.deletedRows.push(t),this.checked[this.selectedRows[e]]=!1,this.dynamicValidateForm.rowDatas.splice(this.selectedRows[e],1)}this.selectedRows=[]}},onSubmit:function(e){var t=this;this.$refs[e].validate((function(e){e&&(t.confirm_dialogVisible=!0)}))},handleClose:function(e){var t=this;this.$confirm("您确定要关闭此对话框吗？").then((function(a){t.getData(),t.deletedRows=[],e()})).catch((function(e){}))},updateSelectedRows:function(){var e=this;this.confirm_dialogVisible=!1,this.show_addDialog=!1;var t=new Date,a=new Date;if(this.dynamicValidateForm.rowDatas.length)for(var i=0;i<this.dynamicValidateForm.rowDatas.length;i++){this.listLoading=!0;var n=new FormData;n.append("amount",null==this.dynamicValidateForm.rowDatas[i].amount?-1:this.dynamicValidateForm.rowDatas[i].amount),n.append("area",null==this.dynamicValidateForm.rowDatas[i].area?-1:this.dynamicValidateForm.rowDatas[i].area),n.append("id",0),n.append("companyId",this.dynamicValidateForm.rowDatas[i].companyId),n.append("companyName",this.filterCompnay(this.dynamicValidateForm.rowDatas[i].companyId)),n.append("createTime",a),n.append("createUserId",Object(o["a"])().user().id),n.append("location",this.dynamicValidateForm.rowDatas[i].location),n.append("productCreditCode",this.dynamicValidateForm.rowDatas[i].productCreditCode),n.append("productName",this.dynamicValidateForm.rowDatas[i].productName),n.append("registerTime",this.registerTime),n.append("town",this.filterTownship(this.dynamicValidateForm.rowDatas[i].town)),n.append("updateTime",t),n.append("updateUserId",Object(o["a"])().user().id),Object(r["a"])().post("/api/green/green_food/create",n).then((function(t){setTimeout((function(){e.listLoading=!1}),500),e.getData()}))}},filterCompnay:function(e){var t=this.companyProduction.find((function(t){return t.companyId===e}));return t?t.companyName:""},filterTownship:function(e){var t=this.township.find((function(t){return t.id===e}));return t?t.name:""}}},C=x,F=(a("221d"),Object(p["a"])(C,y,D,!1,null,null,null)),T=F.exports,_=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"box padding-top-10"},[a("el-dialog",{attrs:{visible:e.show_addDialog,width:"85%","before-close":e.handleClose,title:"添加有机农产品"},on:{"update:visible":function(t){e.show_addDialog=t}}},[a("el-form",{ref:"dynamicValidateForm",attrs:{model:e.dynamicValidateForm}},[e._l(e.dynamicValidateForm.rowDatas,(function(t,i){return a("el-row",{key:i},[a("el-col",{attrs:{span:1}},[a("el-form-item",{staticClass:"margin-left-20"},[a("el-checkbox",{staticClass:"form-checkbox",attrs:{"true-label":"1","false-label":"0"},on:{change:function(t){return e.changeCheckStatus(i)}},model:{value:e.checked[i],callback:function(t){e.$set(e.checked,i,t)},expression:"checked[index]"}})],1)],1),a("el-col",{staticClass:"margin-left-10",attrs:{span:3}},[a("el-form-item",{attrs:{label:"板块：",prop:"rowDatas."+i+".town",rules:{required:!0,message:"请选择",trigger:"blur"}}},[a("el-select",{staticClass:"w-100",model:{value:t.town,callback:function(a){e.$set(t,"town",a)},expression:"rowData.town"}},e._l(e.township,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1),a("el-col",{staticClass:"margin-left-10",attrs:{span:4}},[a("el-form-item",{attrs:{label:"申报单位名称:",prop:"rowDatas."+i+".companyId",rules:{required:!0,message:"请选择",trigger:"blur"}}},[a("el-select",{staticClass:"w-100",model:{value:t.companyId,callback:function(a){e.$set(t,"companyId",a)},expression:"rowData.companyId"}},e._l(e.companyProduction,(function(e){return a("el-option",{key:e.companyId,attrs:{label:e.companyName,value:e.companyId}})})),1)],1)],1),a("el-col",{staticClass:"margin-left-10",attrs:{span:3}},[a("el-form-item",{attrs:{label:"编号:",prop:"rowDatas."+i+".productCreditCode",rules:{required:!0,message:"请选择",trigger:"blur"}}},[a("el-input",{model:{value:t.productCreditCode,callback:function(a){e.$set(t,"productCreditCode",a)},expression:"rowData.productCreditCode"}})],1)],1),a("el-col",{staticClass:"margin-left-10",attrs:{span:2}},[a("el-form-item",{attrs:{label:"产品种类:",prop:"rowDatas."+i+".productType"}},[a("el-input",{model:{value:t.productType,callback:function(a){e.$set(t,"productType",a)},expression:"rowData.productType"}})],1)],1),a("el-col",{staticClass:"margin-left-10",attrs:{span:2}},[a("el-form-item",{attrs:{label:"产品名称:",prop:"rowDatas."+i+".productName"}},[a("el-input",{model:{value:t.productName,callback:function(a){e.$set(t,"productName",a)},expression:"rowData.productName"}})],1)],1),a("el-col",{staticClass:"margin-left-10",attrs:{span:2}},[a("el-form-item",{attrs:{label:"面积(亩):",prop:"rowDatas."+i+".area",rules:[{type:"number",message:"插入号码",trigger:"blur"}]}},[a("el-input-number",{staticClass:"w-90",attrs:{controls:!1},model:{value:t.area,callback:function(a){e.$set(t,"area",a)},expression:"rowData.area"}})],1)],1),a("el-col",{attrs:{span:2}},[a("el-form-item",{attrs:{label:"产量(吨):",prop:"rowDatas."+i+".amount",rules:[{type:"number",message:"插入号码",trigger:"blur"}]}},[a("el-input-number",{staticClass:"w-90",attrs:{controls:!1},model:{value:t.amount,callback:function(a){e.$set(t,"amount",a)},expression:"rowData.amount"}})],1)],1),a("el-col",{attrs:{span:3}},[a("el-form-item",{attrs:{label:"详细地址:",prop:"rowDatas."+i+".location"}},[a("el-input",{model:{value:t.location,callback:function(a){e.$set(t,"location",a)},expression:"rowData.location"}})],1)],1)],1)})),a("el-row",[a("el-col",{attrs:{span:15}})],1),a("el-row",{staticClass:"left-margin flex-box w-100 no-margin-IE"},[a("el-col",{attrs:{span:4}},[a("el-button",{attrs:{size:"small",type:"primary",plain:""},on:{click:function(t){return e.addFormRow()}}},[e._v("添加")]),a("el-button",{attrs:{size:"small",type:"danger",plain:""},on:{click:function(t){return e.deleteSelectedRows()}}},[e._v("删除")])],1),a("el-col",{staticClass:"margin-top-10 text-right",attrs:{span:16}},[e._v("插入时间：")]),a("el-col",{attrs:{span:3}},[a("el-date-picker",{staticClass:"w-80",attrs:{align:"right",type:"date"},model:{value:e.registerTime,callback:function(t){e.registerTime=t},expression:"registerTime"}})],1),a("el-col",{attrs:{span:1}},[a("el-button",{staticClass:"margin-right-40",staticStyle:{float:"right"},attrs:{size:"small",type:"success",plain:""},on:{click:function(t){return e.onSubmit("dynamicValidateForm")}}},[e._v("保存")])],1)],1)],2)],1),a("el-dialog",{attrs:{visible:e.confirm_dialogVisible,width:"30%",modal:""},on:{"update:visible":function(t){e.confirm_dialogVisible=t}}},[a("span",[a("i",{staticClass:"el-icon-warning"},[e._v(" 继续？请再次检查")])]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small",type:"primary",plain:""},on:{click:function(t){e.confirm_dialogVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{size:"small",type:"success",plain:""},on:{click:function(t){return e.updateSelectedRows()}}},[e._v("确认")])],1)]),a("el-container",[a("el-header",{staticClass:"margin-bottom-10"},[e._v("有机农产品清单")]),a("el-row",{staticClass:"margin-bottom-20"},[a("el-col",{attrs:{span:1}},[a("el-button",{attrs:{plain:"",type:"success",size:"small"},on:{click:function(t){return e.showAddDialog()}}},[e._v("添加")])],1),a("el-col",{attrs:{span:4}},[a("div",{staticClass:"select_label margin-left-20 margin-right-5"},[e._v("\n          开始日期 :\n        ")]),a("el-date-picker",{staticStyle:{width:"150px"},attrs:{align:"right",type:"date",placeholder:"插入时间 "},model:{value:e.registerTimeFrom,callback:function(t){e.registerTimeFrom=t},expression:"registerTimeFrom"}})],1),a("el-col",{attrs:{span:4}},[a("div",{staticClass:"select_label margin-left-20 margin-right-5"},[e._v("\n          结束日期 :\n        ")]),a("el-date-picker",{staticStyle:{width:"150px"},attrs:{align:"right",type:"date",placeholder:"插入时间 "},model:{value:e.registerTimeTo,callback:function(t){e.registerTimeTo=t},expression:"registerTimeTo"}})],1),a("el-col",{attrs:{span:4}},[a("div",{staticClass:"select_label margin-left-20 margin-right-5"},[e._v("\n          所在镇(区) :\n        ")]),a("el-input",{staticClass:"w-50",attrs:{align:"right"},model:{value:e.searchTown,callback:function(t){e.searchTown=t},expression:"searchTown"}})],1),a("el-col",{attrs:{span:4}},[a("div",{staticClass:"select_label no-margin-left margin-right-5"},[e._v("\n          申报单位名称 :\n        ")]),a("el-input",{staticClass:"w-50",attrs:{align:"right"},model:{value:e.searchCompanyName,callback:function(t){e.searchCompanyName=t},expression:"searchCompanyName"}})],1),a("el-col",{attrs:{span:4}},[a("div",{staticClass:"select_label margin-left-20 margin-right-5"},[e._v("\n          已获证书 :\n        ")]),a("el-select",{staticClass:"w-50",attrs:{align:"right",type:"date"},model:{value:e.isCredit,callback:function(t){e.isCredit=t},expression:"isCredit"}},e._l(e.option,(function(e){return a("el-option",{key:e.val,attrs:{label:e.label,value:e.val}})})),1)],1),a("el-col",{attrs:{span:2}},[a("el-button",{staticClass:"margin-left-10",attrs:{plain:"",type:"primary",size:"small"},on:{click:function(t){return e.getData()}}},[e._v("搜索")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"","row-class-name":e.rowIndex,"span-method":e.objectSpanMethod,fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{formatter:e.order,label:"序号",width:"100"}}),a("el-table-column",{attrs:{prop:"townDistrict.value",label:"所在镇(区)"}}),a("el-table-column",{attrs:{prop:"declarationUnitName.value",label:"申报单位名称"}}),a("el-table-column",{attrs:{prop:"numbering.value",label:"编号"}}),a("el-table-column",{attrs:{prop:"kind.value",width:"150"}}),a("el-table-column",{attrs:{prop:"productName.value",label:"产品名称",align:"center"}}),a("el-table-column",{attrs:{prop:"area.value",label:"面积(亩)"}}),a("el-table-column",{attrs:{prop:"production.value",label:"产量(吨)"}}),a("el-table-column",{attrs:{prop:"address.value",label:"详细地址"}})],1)],1),a("div",{staticClass:"pageBox"},[a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],attrs:{total:e.total,page:e.page.pageIndex,limit:e.page.pageSize},on:{"update:page":function(t){return e.$set(e.page,"pageIndex",t)},"update:limit":function(t){return e.$set(e.page,"pageSize",t)},pagination:e.getData}})],1)],1)},A=[],N={name:"organicProduce",components:{Pagination:k["default"]},props:{year:{required:!0,type:Number}},data:function(){return{option:[{val:0,label:"全部"},{val:1,label:"是"},{val:2,label:"否"}],isCredit:0,searchTown:"",searchCompanyName:"",registerTimeTo:new Date,registerTimeFrom:new Date((new Date).getFullYear(),0,1),show_addDialog:!1,confirm_dialogVisible:!1,selectedTown:null,selectedRows:[],township:[],companyProduction:[],dynamicValidateForm:{rowDatas:[{town:null,companyId:-1,productName:"",productType:"",productCreditCode:"",area:null,amount:null,location:""}]},registerTime:new Date,page:{pageIndex:1,pageSize:20},checked:[],total:0,tableData:[],objData:[],listLoading:!1}},created:function(){this.getTown(),this.getCompanyProduction(),this.getData()},methods:{arrangData:function(){var e=this,t=this.objData;this.total=t.length;var a=0;t.forEach((function(t){var i=0;t.declarationUnit.forEach((function(n){var r=0;n.declaration.forEach((function(i){var o=0;i.product.forEach((function(r){e.tableData.push({townDistrict:{value:t.townDistrict,spaning:0},declarationUnitName:{value:n.declarationUnitName,spaning:0},kind:{value:i.kind,spaning:0},numbering:{value:i.numbering,spaning:0},productName:{value:r.productName,spaning:0},production:{value:r.production,spaning:0},address:{value:i.address,spaning:0},area:{value:n.area,spaning:0}}),o++,a++})),e.tableData[a-o].numbering.spaning=o,e.tableData[a-o].address.spaning=o,""!==e.tableData[a-o].kind.value&&(e.tableData[a-o].kind.spaning=o),r+=o})),e.tableData[a-r].declarationUnitName.spaning=r,e.tableData[a-r].area.spaning=r,i+=r})),e.tableData[a-i].townDistrict.spaning=i})),this.tableData.push({townDistrict:{value:"合计",spaning:0},declarationUnitName:{value:"",spaning:0},numbering:{value:"",spaning:0},productName:{value:"",spaning:0},production:{value:this.productionQuality(),spaning:0},address:{value:"预计下半年通过15000亩认证面积",spaning:0},area:{value:this.areaQualtiy(),spaning:0}})},areaQualtiy:function(){var e=0;return this.objData.forEach((function(t){t.declarationUnit.forEach((function(t){e+=parseFloat("/"==t.area?0:t.area)}))})),parseFloat(e).toFixed(2)},productionQuality:function(){var e=0;return this.objData.forEach((function(t){t.declarationUnit.forEach((function(t){t.declaration.forEach((function(t){t.product.forEach((function(t){e+=parseFloat("/"==t.production?0:t.production)}))}))}))})),parseFloat(e).toFixed(2)},objectSpanMethod:function(e){var t=e.row,a=(e.column,e.rowIndex),i=e.columnIndex;if(a<this.tableData.length-1){if(1==i)return t.townDistrict.spaning>0?{rowspan:t.townDistrict.spaning,colspan:1}:{rowspan:0,colspan:0};if(2==i)return t.declarationUnitName.spaning>0?{rowspan:t.declarationUnitName.spaning,colspan:1}:{rowspan:0,colspan:0};if(3==i)return t.numbering.spaning>0?{rowspan:t.numbering.spaning,colspan:1}:{rowspan:0,colspan:0};if(4==i)return t.kind.spaning>0?{rowspan:t.kind.spaning,colspan:1}:0==t.kind.spaning&&""===t.kind.value?{rowspan:0,colspan:2}:{rowspan:0,colspan:0};if(6==i)return t.area.spaning>0?{rowspan:t.area.spaning,colspan:1}:{rowspan:0,colspan:0};if(8==i)return t.address.spaning>0?{rowspan:t.address.spaning,colspan:1}:{rowspan:0,colspan:0}}else{if(1==i)return{rowspan:1,colspan:2};if(2==i)return{rowspan:1,colspan:3};if(0==i||3==i||5==i)return{rowspan:0,colspan:0}}},getData:function(){var e=this;this.listLoading=!0,this.objData=[],this.tableData=[];var t=new Date(this.registerTimeTo.getFullYear(),this.registerTimeTo.getMonth(),this.registerTimeTo.getDate(),23,59,59);Object(r["a"])().get("/api/green/organic_product/all",{registerTimeTo:t,registerTimeFrom:this.registerTimeFrom,companyName:this.searchCompanyName,town:this.searchTown,isCredit:this.isCredit}).then((function(t){var a=t.data,i="",n=[],r=[],o=[];if(a.length>0){for(var l=0;l<a.length;l++)i!==a[l].town?(n.length>0&&e.objData.push({townDistrict:i,declarationUnit:n}),i=a[l].town,o=[],r=[],n=[],o.push({productName:a[l].productName,production:-1==a[l].amount?"/":parseFloat(a[l].amount).toFixed(2)}),r.push({numbering:a[l].productCreditCode,kind:a[l].productType,product:o,address:a[l].location}),n.push({declarationUnitName:a[l].companyName,declaration:r,area:-1==a[l].area?"/":parseFloat(a[l].area).toFixed(2)})):a[l-1].companyName===a[l].companyName?a[l-1].productCreditCode===a[l].productCreditCode?o.push({productName:a[l].productName,production:-1==a[l].amount?"/":parseFloat(a[l].amount).toFixed(2)}):(o=[],o.push({productName:a[l].productName,production:-1==a[l].amount?"/":parseFloat(a[l].amount).toFixed(2)}),r.push({numbering:a[l].productCreditCode,kind:a[l].productType,product:o,address:a[l].location})):(o=[],o.push({productName:a[l].productName,production:-1==a[l].amount?"/":parseFloat(a[l].amount).toFixed(2)}),r=[],r.push({numbering:a[l].productCreditCode,kind:a[l].productType,product:o,address:a[l].location}),n.push({declarationUnitName:a[l].companyName,declaration:r,area:-1==a[l].area?"/":parseFloat(a[l].area).toFixed(2)}));n.length>0&&e.objData.push({townDistrict:i,declarationUnit:n}),e.arrangData()}else e.tableData=[];setTimeout((function(){e.listLoading=!1}),500)})).catch((function(e){console.log(e)}))},rowIndex:function(e){var t=e.row,a=e.rowIndex;t.rowIndex=a},order:function(e){return this.page.pageSize*(this.page.pageIndex-1)+e.rowIndex+1},showAddDialog:function(){this.dynamicValidateForm.rowDatas=[],this.addFormRow(),this.show_addDialog=!0},getTown:function(){var e=this;Object(r["a"])().get("/api/town/all").then((function(t){e.township=e.township.concat(t)})).catch((function(e){console.log(e)}))},getCompanyProduction:function(){var e=this;Object(r["a"])().get("/api/company_production/name").then((function(t){e.companyProduction=t})).catch((function(e){console.log(e)}))},addFormRow:function(){this.dynamicValidateForm.rowDatas.push({town:"",companyId:null,productType:"",productName:"",productCreditCode:"",area:null,amount:null,location:"",registerTime:new Date})},showDialog:function(e,t){this.showWebMaster=2===t,this.selectedSupervisupervisorType=t,this.dynamicValidateForm.rowDatas=e,this.openDialog=!0,this.header=this.supervisorType[t-1]},changeCheckStatus:function(e){var t=this.selectedRows.indexOf(e);t>-1&&this.selectedRows.splice(t,1),1==this.checked[e]&&this.selectedRows.push(e)},deleteSelectedRows:function(){if(this.selectedRows.length){for(var e in this.selectedRows=this.selectedRows.sort((function(e,t){return e>t?-1:1})),this.selectedRows){var t=this.dynamicValidateForm.rowDatas[this.selectedRows[e]].id;t&&this.deletedRows.push(t),this.checked[this.selectedRows[e]]=!1,this.dynamicValidateForm.rowDatas.splice(this.selectedRows[e],1)}this.selectedRows=[]}},onSubmit:function(e){var t=this;this.$refs[e].validate((function(e){e&&(t.confirm_dialogVisible=!0)}))},handleClose:function(e){var t=this;this.$confirm("您确定要关闭此对话框吗？").then((function(a){t.getData(),t.deletedRows=[],e()})).catch((function(e){}))},updateSelectedRows:function(){var e=this;this.confirm_dialogVisible=!1,this.show_addDialog=!1;var t=new Date,a=new Date;if(this.dynamicValidateForm.rowDatas.length)for(var i=0;i<this.dynamicValidateForm.rowDatas.length;i++){this.listLoading=!0;var n=new FormData;n.append("amount",null==this.dynamicValidateForm.rowDatas[i].amount||"undefined"==this.dynamicValidateForm.rowDatas[i].amount?-1:this.dynamicValidateForm.rowDatas[i].amount),n.append("area",null==this.dynamicValidateForm.rowDatas[i].area||"undefined"==this.dynamicValidateForm.rowDatas[i].area?-1:this.dynamicValidateForm.rowDatas[i].area),n.append("id",0),n.append("productType",""==this.dynamicValidateForm.rowDatas[i].productType?" ":this.dynamicValidateForm.rowDatas[i].productType),n.append("companyName",this.filterCompnay(this.dynamicValidateForm.rowDatas[i].companyId)),n.append("createTime",a),n.append("createUserId",Object(o["a"])().user().id),n.append("location",this.dynamicValidateForm.rowDatas[i].location),n.append("productCreditCode",this.dynamicValidateForm.rowDatas[i].productCreditCode),n.append("productName",this.dynamicValidateForm.rowDatas[i].productName),n.append("registerTime",this.registerTime),n.append("town",this.filterTownship(this.dynamicValidateForm.rowDatas[i].town)),n.append("updateTime",t),n.append("updateUserId",Object(o["a"])().user().id),Object(r["a"])().post("/api/green/organic_product/create",n).then((function(t){setTimeout((function(){e.listLoading=!1}),500),e.getData()}))}},filterCompnay:function(e){var t=this.companyProduction.find((function(t){return t.companyId===e}));return t?t.companyName:""},filterTownship:function(e){var t=this.township.find((function(t){return t.id===e}));return t?t.name:""}}},S=N,R=(a("bf83"),Object(p["a"])(S,_,A,!1,null,null,null)),V=R.exports,Y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"box"},[a("el-dialog",{attrs:{visible:e.openDialog,width:"90%","before-close":e.handleClose},on:{"update:visible":function(t){e.openDialog=t}}},[a("el-form",{ref:"dynamicValidateForm",attrs:{model:e.dynamicValidateForm}},[a("el-form-item",{staticClass:"left-margin flex-box w-100 no-margin-IE"},[e._l(e.dynamicValidateForm.data,(function(t,i){return a("el-row",{key:i},[a("el-col",{attrs:{span:1}},[a("el-form-item",{staticClass:"margin-left-20"},[a("el-checkbox",{staticClass:"form-checkbox",attrs:{"true-label":"1","false-label":"0"},on:{change:function(t){return e.changeCheckStatus(i)}},model:{value:e.checked[i],callback:function(t){e.$set(e.checked,i,t)},expression:"checked[index]"}})],1)],1),a("el-col",{attrs:{span:2}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"创建单位：",prop:"data."+i+".companyName",rules:{required:!0,message:"请插入",trigger:"blur"}}},[a("el-input",{model:{value:t.companyName,callback:function(a){e.$set(t,"companyName",a)},expression:"rowData.companyName"}})],1)],1),a("el-col",{attrs:{span:2}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"产品类型:",prop:"data."+i+".productType"}},[a("el-input",{model:{value:t.productType,callback:function(a){e.$set(t,"productType",a)},expression:"rowData.productType"}})],1)],1),a("el-col",{attrs:{span:2}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"基地面积:",prop:"data."+i+".area",rules:[{type:"number",message:"插入号码",trigger:"blur"}]}},[a("el-input",{model:{value:t.area,callback:function(a){e.$set(t,"area",e._n(a))},expression:"rowData.area"}})],1)],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"基地地址(到村)：",prop:"data."+i+".location"}},[a("el-input",{model:{value:t.location,callback:function(a){e.$set(t,"location",a)},expression:"rowData.location"}})],1)],1),a("el-col",{attrs:{span:3}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"与部基地,产品基地重合：",prop:"data."+i+".isCoincidence"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.isCoincidence,callback:function(a){e.$set(t,"isCoincidence",a)},expression:"rowData.isCoincidence"}},e._l([{value:0,label:"否"},{value:1,label:"是"}],(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("el-col",{staticClass:"margin-left-10",attrs:{span:3}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"重合企业/部基地：",prop:"data."+i+".coincidenceBase"}},[a("el-input",{attrs:{disabled:0==t.isCoincidence},model:{value:t.coincidenceBase,callback:function(a){e.$set(t,"coincidenceBase",a)},expression:"rowData.coincidenceBase"}})],1)],1),a("el-col",{staticClass:"margin-left-10",attrs:{span:2}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"重合面积：",prop:"data."+i+".coincidneceArea",rules:[{type:"number",message:"插入号码"}]}},[a("el-input",{attrs:{disabled:0==t.isCoincidence},model:{value:t.coincidneceArea,callback:function(a){e.$set(t,"coincidneceArea",e._n(a))},expression:"rowData.coincidneceArea"}})],1)],1),a("el-col",{attrs:{span:2}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"备注：",prop:"data."+i+".other"}},[a("el-input",{model:{value:t.other,callback:function(a){e.$set(t,"other",a)},expression:"rowData.other"}})],1)],1)],1)})),a("el-row",{staticClass:"margin-left-40 margin-top-20"},[a("el-col",{attrs:{span:17}},[a("el-button",{attrs:{size:"small",type:"primary",plain:""},on:{click:function(t){return e.addFormRow()}}},[e._v("添加")]),a("el-button",{attrs:{size:"small",type:"danger",plain:""},on:{click:function(t){return e.deleteSelectedRows()}}},[e._v("删除")])],1),a("el-col",{directives:[{name:"show",rawName:"v-show",value:e.dynamicValidateForm.data.length>0,expression:"dynamicValidateForm.data.length > 0"}],attrs:{span:4}},[a("span",[e._v("插入时间: ")]),a("el-date-picker",{staticStyle:{width:"150px"},attrs:{type:"date"},model:{value:e.registerTime,callback:function(t){e.registerTime=t},expression:"registerTime"}})],1),a("el-col",{directives:[{name:"show",rawName:"v-show",value:e.dynamicValidateForm.data.length>0,expression:"dynamicValidateForm.data.length > 0"}],attrs:{span:2}},[a("el-button",{attrs:{size:"small",type:"success",plain:""},on:{click:function(t){return e.onSubmit("dynamicValidateForm")}}},[e._v("保存")])],1)],1)],2)],1)],1),a("el-dialog",{attrs:{visible:e.confirm_dialogVisible,width:"30%",modal:""},on:{"update:visible":function(t){e.confirm_dialogVisible=t}}},[a("span",[a("i",{staticClass:"el-icon-warning"},[e._v(" 继续？请再次检查")])]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small",type:"primary",plain:""},on:{click:function(t){e.confirm_dialogVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{size:"small",type:"success",plain:""},on:{click:function(t){return e.updateSelectedRows()}}},[e._v("确认")])],1)]),a("el-container",[a("el-header",{staticClass:"margin-bottom-10"},[e._v("建设中待验收种植业绿色优质基地")]),a("div",{staticClass:"iptBox"},[a("el-row",{staticClass:"w-80"},[a("el-col",{attrs:{span:2}},[a("el-button",{attrs:{size:"small",type:"success",plain:""},on:{click:function(t){return e.showAddDialog()}}},[e._v("添加")])],1),a("el-col",{attrs:{span:6}},[a("span",[e._v("开始日期: ")]),a("el-date-picker",{staticStyle:{width:"150px"},attrs:{type:"date"},model:{value:e.registerTimeFrom,callback:function(t){e.registerTimeFrom=t},expression:"registerTimeFrom"}})],1),a("el-col",{attrs:{span:6}},[a("span",[e._v("结束日期: ")]),a("el-date-picker",{staticStyle:{width:"150px"},attrs:{type:"date"},model:{value:e.registerTimeTo,callback:function(t){e.registerTimeTo=t},expression:"registerTimeTo"}})],1),a("el-col",{attrs:{span:9}},[a("span",[e._v("创建单位: ")]),a("el-input",{staticClass:"w-60",model:{value:e.companyName,callback:function(t){e.companyName=t},expression:"companyName"}})],1),a("el-col",{attrs:{span:1}},[a("el-button",{staticClass:"margin-left-10",attrs:{size:"small",type:"primary",plain:""},on:{click:function(t){return e.changeFilter()}}},[e._v("搜索")])],1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,"row-class-name":e.rowIndex,"span-method":e.objectSpanMethod,"highlight-current-row":""}},[a("el-table-column",{attrs:{formatter:e.order,label:"序号",width:"100"}}),a("el-table-column",{attrs:{prop:"companyName",label:"创建单位"}}),a("el-table-column",{attrs:{prop:"productType",label:"产品类型"}}),a("el-table-column",{attrs:{prop:"area",label:"基地面积"}}),a("el-table-column",{attrs:{prop:"location",label:"基地地址(到村)"}}),a("el-table-column",{attrs:{label:"与部基地,产品基地重合"}},[a("el-table-column",{attrs:{prop:"isCoincidence",label:"(是/否)",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(e._s("0"==a.isCoincidence?"否":"1"==a.isCoincidence?"是":a.isCoincidence))]}}])})],1),a("el-table-column",{attrs:{label:"应扣除的重合部分",align:"center"}},e._l(e.columns,(function(e){return a("el-table-column",{key:e.prop,attrs:{prop:e.prop,label:e.label}})})),1),a("el-table-column",{attrs:{prop:"other",label:"备注",align:"center"}})],1)],1)],1)},I=[],Q={name:"plantingGreenBase",props:{year:{required:!0,type:Number}},data:function(){return{openDialog:!1,dynamicValidateForm:{data:[]},selectedRows:[],confirm_dialogVisible:!1,checked:[],registerTime:(new Date).toString("YYYY-MM-DD"),registerTimeFrom:new Date((new Date).getFullYear(),0,1),registerTimeTo:new Date,companyName:"",sendcount:0,columns:[{prop:"coincidenceBase",label:"重合企业/部基地"},{prop:"coincidneceArea",label:"重合面积"}],alert_dialogVisible:!1,total:0,tableData:[],listLoading:!0}},created:function(){this.getData()},methods:{showAddDialog:function(){this.dynamicValidateForm.data=[],this.selectedRows=[],this.checked=[],this.openDialog=!0,this.addFormRow()},handleClose:function(e){var t=this;this.$confirm("您确定要关闭此对话框吗？").then((function(a){t.getData(),e()})).catch((function(e){}))},addFormRow:function(){this.dynamicValidateForm.data.push({companyName:"",productType:"",area:0,location:"",isCoincidence:0,coincidenceBase:"",coincidneceArea:0,other:""})},deleteSelectedRows:function(){if(this.selectedRows.length){for(var e in this.selectedRows=this.selectedRows.sort((function(e,t){return e>t?-1:1})),this.selectedRows){var t=this.dynamicValidateForm.data[this.selectedRows[e]].id;t&&this.deletedRows.push(t),this.checked[this.selectedRows[e]]=!1,this.dynamicValidateForm.data.splice(this.selectedRows[e],1)}this.selectedRows=[]}},onSubmit:function(e){var t=this;this.$refs[e].validate((function(e){e&&(t.confirm_dialogVisible=!0)}))},changeCheckStatus:function(e){var t=this.selectedRows.indexOf(e);t>-1&&this.selectedRows.splice(t,1),1==this.checked[e]&&this.selectedRows.push(e)},updateSelectedRows:function(){var e=this;this.confirm_dialogVisible=!1,this.openDialog=!1;var t=new Date,a=new Date;this.listLoading=!0,this.sendcount=0,this.dynamicValidateForm.data.forEach((function(i){var n=new FormData;n.append("area",null==i.area||void 0==i.area?-1:i.area),n.append("coincidenceBase",0==i.isCoincidence?"":i.coincidenceBase),n.append("coincidneceArea",0==i.isCoincidence?-1:null==i.coincidneceArea||void 0==i.coincidneceArea?-1:i.coincidneceArea),n.append("companyName",i.companyName),n.append("createTime",a.toDateString("YYYY-MM-DD")),n.append("createUserId",Object(o["a"])().user().id),n.append("id",0),n.append("isCoincidence",i.isCoincidence),n.append("location",i.location),n.append("other",i.other),n.append("productType",i.productType),n.append("registerTime",e.registerTime.toString("YYYY-MM-DD")),n.append("updateTime",t.toDateString("YYYY-MM-DD")),n.append("updateUserId",Object(o["a"])().user().id),Object(r["a"])().post("/api/green/green_quality_base/create",n).then((function(t){e.sendcount++,e.sendcount===e.dynamicValidateForm.data.length&&(e.listLoading=!1,e.getData())}))}))},changeFilter:function(){this.getData()},getData:function(){var e=this;this.listLoading=!0;var t=new Date(this.registerTimeTo.getFullYear(),this.registerTimeTo.getMonth(),this.registerTimeTo.getDate(),23,59,59);Object(r["a"])().get("/api/green/green_quality_base/all",{companyName:this.companyName,registerTimeFrom:""==this.registerTimeFrom||null==this.registerTimeFrom?"":this.registerTimeFrom,registerTimeTo:""==this.registerTimeTo||null==this.registerTimeTo?"":t,sortBy:"id"}).then((function(t){e.tableData=t.data,e.total=e.tableData.length,e.calculateTotal(),e.Total(),e.listLoading=!1}))},calculateTotal:function(){this.tableData.forEach((function(e){e.area=-1==e.area?"/":parseFloat(e.area).toFixed(2),e.coincidneceArea=-1==e.coincidneceArea?"/":parseFloat(e.coincidneceArea).toFixed(2)})),this.tableData.push({companyName:"合计",productType:"",area:this.baseQuality(),location:"",isCoincidence:"",coincidenceBase:"",coincidneceArea:this.coincidentQuality(),other:""})},baseQuality:function(){var e=0;return this.tableData.forEach((function(t){"/"!==t.area&&(e+=parseFloat(t.area))})),parseFloat(e).toFixed(2)},coincidentQuality:function(){var e=0;return this.tableData.forEach((function(t){"/"!==t.coincidneceArea&&(e+=parseFloat(t.coincidneceArea))})),parseFloat(e).toFixed(2)},Total:function(){this.tableData.push({companyName:"纳入统计范围的基地面积（扣除重合后）：",productType:"",area:0,location:"",isCoincidence:this.totalQuality(),coincidenceBase:"",coincidneceArea:0,other:""})},totalQuality:function(){var e=this,t=0,a=0;return this.tableData.forEach((function(i){if(a===e.tableData.length-1)return parseFloat(t).toFixed(2);"/"!==i.area&&"/"!==i.coincidneceArea&&(t+=parseFloat(i.area)-parseFloat(i.coincidneceArea)),a++})),parseFloat(t).toFixed(2)},objectSpanMethod:function(e){e.row,e.column;var t=e.rowIndex,a=e.columnIndex;if(t==this.tableData.length-2){if(0==a)return{rowspan:0,colspan:0};if(1==a)return{rowspan:1,colspan:2}}else if(t==this.tableData.length-1){if(1==a)return{rowspan:1,colspan:5};if(5==a)return{rowspan:1,colspan:4};if(0==a||2==a||3==a||4==a||6==a||7==a||8==a)return{rowspan:0,colspan:0}}},rowIndex:function(e){var t=e.row,a=e.rowIndex;t.rowIndex=a},order:function(e){return e.rowIndex+1}}},O=Q,E=(a("dfd2"),Object(p["a"])(O,Y,I,!1,null,null,null)),P=E.exports,j=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"box"},[a("el-dialog",{attrs:{visible:e.openDialog,width:"90%","before-close":e.handleClose},on:{"update:visible":function(t){e.openDialog=t}}},[a("el-form",{ref:"dynamicValidateForm",attrs:{model:e.dynamicValidateForm}},[a("el-form-item",{staticClass:"left-margin flex-box w-100 no-margin-IE"},[e._l(e.dynamicValidateForm.data,(function(t,i){return a("el-row",{key:i},[a("el-col",{attrs:{span:1}},[a("el-form-item",{staticClass:"margin-left-20"},[a("el-checkbox",{staticClass:"form-checkbox",attrs:{"true-label":"1","false-label":"0"},on:{change:function(t){return e.changeCheckStatus(i)}},model:{value:e.checked[i],callback:function(t){e.$set(e.checked,i,t)},expression:"checked[index]"}})],1)],1),a("el-col",{attrs:{span:2}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"板块：",prop:"data."+i+".town",rules:{required:!0,message:"请选择",trigger:"blur"}}},[a("el-select",{staticClass:"w-100",model:{value:t.town,callback:function(a){e.$set(t,"town",a)},expression:"rowData.town"}},e._l(e.township,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1),a("el-col",{attrs:{span:2}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"绿色食品面积:",prop:"data."+i+".productName"}},[a("el-input",{model:{value:t.productName,callback:function(a){e.$set(t,"productName",a)},expression:"rowData.productName"}})],1)],1),a("el-col",{attrs:{span:2}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"有机面积:",prop:"data."+i+".organicArea"}},[a("el-input",{model:{value:t.organicArea,callback:function(a){e.$set(t,"organicArea",e._n(a))},expression:"rowData.organicArea"}})],1)],1),a("el-col",{attrs:{span:3}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"绿色优质基地面积:",prop:"data."+i+".highQualityArea"}},[a("el-input",{model:{value:t.highQualityArea,callback:function(a){e.$set(t,"highQualityArea",e._n(a))},expression:"rowData.highQualityArea"}})],1)],1),a("el-col",{attrs:{span:2}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"重复面积:",prop:"data."+i+".repeatArea"}},[a("el-input",{model:{value:t.repeatArea,callback:function(a){e.$set(t,"repeatArea",e._n(a))},expression:"rowData.repeatArea"}})],1)],1),a("el-col",{attrs:{span:2}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"合计:",prop:"data."+i+".sum"}},[a("el-input",{model:{value:t.sum,callback:function(a){e.$set(t,"sum",e._n(a))},expression:"rowData.sum"}})],1)],1),a("el-col",{attrs:{span:2}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"耕地面积:",prop:"data."+i+".cultivatedArea"}},[a("el-input",{model:{value:t.cultivatedArea,callback:function(a){e.$set(t,"cultivatedArea",e._n(a))},expression:"rowData.cultivatedArea"}})],1)],1),a("el-col",{attrs:{span:2}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"绿色,有机:",prop:"data."+i+".greenOrganic"}},[a("el-input",{model:{value:t.greenOrganic,callback:function(a){e.$set(t,"greenOrganic",e._n(a))},expression:"rowData.greenOrganic"}})],1)],1),a("el-col",{attrs:{span:2}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"地标:",prop:"data."+i+".target"}},[a("el-input",{model:{value:t.target,callback:function(a){e.$set(t,"target",a)},expression:"rowData.target"}})],1)],1),a("el-col",{attrs:{span:2}},[a("el-form-item",{staticClass:"margin-left-10",attrs:{label:"预计面积:",prop:"data."+i+".predictArea"}},[a("el-input",{model:{value:t.predictArea,callback:function(a){e.$set(t,"predictArea",e._n(a))},expression:"rowData.predictArea"}})],1)],1)],1)})),a("el-row",{staticClass:"margin-left-40 margin-top-20"},[a("el-col",{attrs:{span:17}},[a("el-button",{attrs:{size:"small",type:"primary",plain:""},on:{click:function(t){return e.addFormRow()}}},[e._v("添加")]),a("el-button",{attrs:{size:"small",type:"danger",plain:""},on:{click:function(t){return e.deleteSelectedRows()}}},[e._v("删除")])],1),a("el-col",{directives:[{name:"show",rawName:"v-show",value:e.dynamicValidateForm.data.length>0,expression:"dynamicValidateForm.data.length > 0"}],attrs:{span:4}},[a("span",[e._v("插入时间: ")]),a("el-date-picker",{staticStyle:{width:"180px"},attrs:{type:"date"},model:{value:e.registerTime,callback:function(t){e.registerTime=t},expression:"registerTime"}})],1),a("el-col",{directives:[{name:"show",rawName:"v-show",value:e.dynamicValidateForm.data.length>0,expression:"dynamicValidateForm.data.length > 0"}],attrs:{span:2}},[a("el-button",{attrs:{size:"small",type:"success",plain:""},on:{click:function(t){return e.onSubmit("dynamicValidateForm")}}},[e._v("保存")])],1)],1)],2)],1)],1),a("el-dialog",{attrs:{visible:e.confirm_dialogVisible,width:"30%",modal:""},on:{"update:visible":function(t){e.confirm_dialogVisible=t}}},[a("span",[a("i",{staticClass:"el-icon-warning"},[e._v(" 继续？请再次检查")])]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small",type:"primary",plain:""},on:{click:function(t){e.confirm_dialogVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{size:"small",type:"success",plain:""},on:{click:function(t){return e.updateSelectedRows()}}},[e._v("确认")])],1)]),a("el-container",[a("el-header",{staticClass:"margin-bottom-10"},[e._v("种植业绿色优质农产品统计汇总")]),a("div",{staticClass:"iptBox"},[a("el-row",{staticClass:"w-80"},[a("el-col",{attrs:{span:2}},[a("el-button",{attrs:{size:"small",type:"success",plain:""},on:{click:function(t){return e.showAddDialog()}}},[e._v("添加")])],1),a("el-col",{attrs:{span:6}},[a("span",[e._v("开始日期: ")]),a("el-date-picker",{staticStyle:{width:"150px"},attrs:{type:"date"},model:{value:e.registerTimeFrom,callback:function(t){e.registerTimeFrom=t},expression:"registerTimeFrom"}})],1),a("el-col",{attrs:{span:6}},[a("span",[e._v("结束日期: ")]),a("el-date-picker",{staticStyle:{width:"150px"},attrs:{type:"date"},model:{value:e.registerTimeTo,callback:function(t){e.registerTimeTo=t},expression:"registerTimeTo"}})],1),a("el-col",{attrs:{span:9}},[a("span",[e._v("创建单位: ")]),a("el-input",{staticClass:"w-60",model:{value:e.town,callback:function(t){e.town=t},expression:"town"}})],1),a("el-col",{attrs:{span:1}},[a("el-button",{staticClass:"margin-left-10",attrs:{size:"small",type:"primary",plain:""},on:{click:function(t){return e.changeFilter()}}},[e._v("搜索")])],1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,"row-class-name":e.rowIndex,"highlight-current-row":"",border:"","span-method":e.objectSpanMethod}},[a("el-table-column",{attrs:{formatter:e.order,label:"序号"}}),a("el-table-column",{attrs:{prop:"town",label:"板块"}}),a("el-table-column",{attrs:{prop:"productName",label:"绿色食品面积"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n        "+e._s(a.productName=-1==a.productName?"/":a.productName)+"\n      ")]}}])}),a("el-table-column",{attrs:{prop:"organicArea",label:"有机面积"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n        "+e._s(a.organicArea=-1==a.organicArea?"/":a.organicArea)+"\n      ")]}}])}),a("el-table-column",{attrs:{prop:"highQualityArea",label:"绿色优质基地面积"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n        "+e._s(a.highQualityArea=-1==a.highQualityArea?"/":a.highQualityArea)+"\n      ")]}}])}),a("el-table-column",{attrs:{prop:"repeatArea",label:"重复面积"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n        "+e._s(a.repeatArea=-1==a.repeatArea?"/":a.repeatArea)+"\n      ")]}}])}),a("el-table-column",{attrs:{prop:"sum",label:"合计"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n        "+e._s(a.sum=-1==a.sum?"/":a.sum)+"\n      ")]}}])}),a("el-table-column",{attrs:{prop:"cultivatedArea",label:"耕地面积"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n        "+e._s(a.cultivatedArea=-1==a.cultivatedArea?"/":a.cultivatedArea)+"\n      ")]}}])}),a("el-table-column",{attrs:{prop:"proportion",label:"占比"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n        "+e._s(a.proportion=-1==a.proportion?"/":a.proportion)+"\n      ")]}}])}),a("el-table-column",{attrs:{prop:"greenOrganic",label:"绿色,有机"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n        "+e._s(a.greenOrganic=-1==a.greenOrganic?"/":a.greenOrganic)+"\n      ")]}}])}),a("el-table-column",{attrs:{prop:"target",label:"地标"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n        "+e._s(a.target=-1==a.target?"/":a.target)+"\n      ")]}}])}),a("el-table-column",{attrs:{prop:"predictArea",label:"预计面积"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n        "+e._s(a.predictArea=-1==a.predictArea?"/":a.predictArea)+"\n      ")]}}])}),a("el-table-column",{attrs:{prop:"expectedRatio",label:"预计占比"}})],1)],1)],1)},$=[],M=(a("28a5"),a("6762"),a("2fdb"),{name:"plantingTownshipStatistics",props:{year:{required:!0,type:Number}},data:function(){return{openDialog:!1,dynamicValidateForm:{data:[]},selectedRows:[],township:[],confirm_dialogVisible:!1,checked:[],registerTime:(new Date).toString("YYYY-MM-DD"),registerTimeFrom:new Date((new Date).getFullYear(),0,1),registerTimeTo:new Date,town:"",sendcount:0,alert_dialogVisible:!1,tableData:[],listLoading:!0}},created:function(){this.getTown(),this.getData()},methods:{getTown:function(){var e=this;Object(r["a"])().get("/api/town/all").then((function(t){e.township=e.township.concat(t)})).catch((function(e){console.log(e)}))},showAddDialog:function(){this.dynamicValidateForm.data=[],this.selectedRows=[],this.checked=[],this.addFormRow(),this.openDialog=!0},handleClose:function(e){var t=this;this.$confirm("您确定要关闭此对话框吗？").then((function(a){t.getData(),e()})).catch((function(e){}))},addFormRow:function(){this.dynamicValidateForm.data.push({town:"",productName:"",organicArea:0,highQualityArea:0,repeatArea:0,sum:0,cultivatedArea:0,greenOrganic:0,target:"",predictArea:0})},deleteSelectedRows:function(){if(this.selectedRows.length){for(var e in this.selectedRows=this.selectedRows.sort((function(e,t){return e>t?-1:1})),this.selectedRows){var t=this.dynamicValidateForm.data[this.selectedRows[e]].id;t&&this.deletedRows.push(t),this.checked[this.selectedRows[e]]=!1,this.dynamicValidateForm.data.splice(this.selectedRows[e],1)}this.selectedRows=[]}},onSubmit:function(e){var t=this;this.$refs[e].validate((function(e){e&&(t.confirm_dialogVisible=!0)}))},filterTownship:function(e){var t=this.township.find((function(t){return t.id===e}));return t?t.name:""},changeCheckStatus:function(e){var t=this.selectedRows.indexOf(e);t>-1&&this.selectedRows.splice(t,1),1==this.checked[e]&&this.selectedRows.push(e)},updateSelectedRows:function(){var e=this;this.confirm_dialogVisible=!1,this.openDialog=!1;var t=new Date,a=new Date;this.listLoading=!0,this.sendcount=0,this.dynamicValidateForm.data.forEach((function(i){var n=new FormData;n.append("createTime",a.toDateString("YYYY-MM-DD")),n.append("createUserId",Object(o["a"])().user().id),n.append("cultivatedArea",""==i.cultivatedArea||void 0==i.cultivatedArea?-1:i.cultivatedArea),n.append("greenOrganic",""==i.greenOrganic||void 0==i.greenOrganic?-1:i.greenOrganic),n.append("highQualityArea",""==i.highQualityArea||void 0==i.highQualityArea?-1:i.highQualityArea),n.append("id",0),n.append("organicArea",""==i.organicArea||void 0==i.organicArea?-1:i.organicArea),n.append("predictArea",""==i.predictArea||void 0==i.predictArea?-1:i.predictArea),n.append("productName",i.productName),n.append("registerTime",e.registerTime.toString("YYYY-MM-DD")),n.append("repeatArea",""==i.repeatArea||void 0==i.repeatArea?-1:i.repeatArea),n.append("sum",""==i.sum||void 0==i.sum?-1:i.sum),n.append("target",i.target),n.append("town",e.filterTownship(i.town)),n.append("updateTime",t.toDateString("YYYY-MM-DD")),n.append("updateUserId",Object(o["a"])().user().id),Object(r["a"])().post("/api/green/plants_statistics/create",n).then((function(t){e.sendcount++,e.sendcount===e.dynamicValidateForm.data.length&&(e.listLoading=!1,e.getData())}))}))},changeFilter:function(){this.getData()},getData:function(){var e=this;this.listLoading=!0;var t=new Date(this.registerTimeTo.getFullYear(),this.registerTimeTo.getMonth(),this.registerTimeTo.getDate(),23,59,59);Object(r["a"])().get("/api/green/plants_statistics/all",{town:this.town,registerTimeFrom:""==this.registerTimeFrom||null==this.registerTimeFrom?"":this.registerTimeFrom,registerTimeTo:""==this.registerTimeTo||null==this.registerTimeTo?"":t,sortBy:"id"}).then((function(t){e.tableData=t.data,e.total=e.tableData.length,e.getTotal(),e.tableData.forEach((function(e){-1!==e.organicArea?e.organicArea=parseFloat(e.organicArea).toFixed(2):e.organicArea="/",-1!==e.highQualityArea?e.highQualityArea=parseFloat(e.highQualityArea).toFixed(2):e.highQualityArea="/",-1!==e.repeatArea?e.repeatArea=parseFloat(e.repeatArea).toFixed(2):e.repeatArea="/",-1!==e.sum?e.sum=parseFloat(e.sum).toFixed(2):e.sum="/",-1!==e.cultivatedArea?e.cultivatedArea=parseFloat(e.cultivatedArea).toFixed(2):e.cultivatedArea="/",-1!==e.greenOrganic?e.greenOrganic=parseFloat(e.greenOrganic).toFixed(2):e.greenOrganic="/",-1!==e.predictArea?e.predictArea=parseFloat(e.predictArea).toFixed(2):e.predictArea="/",-1!==e.expectedRatio?e.expectedRatio=parseFloat(e.expectedRatio).toFixed(2):e.expectedRatio="/",-1!==e.proportion?e.proportion=parseFloat(e.proportion).toFixed(2):e.proportion="/"})),e.listLoading=!1}))},getTotal:function(){this.tableData.forEach((function(e){-1!==e.sum&&-1!==e.cultivatedArea?e.proportion=100*e.sum/e.cultivatedArea:e.proportion=-1,-1!==e.predictArea&&-1!==e.cultivatedArea?e.expectedRatio=100*e.predictArea/e.cultivatedArea:e.expectedRatio=-1})),this.tableData.push({town:"合计",productName:"",organicArea:this.organicAreaQuality(),highQualityArea:this.greenHighQuality(),repeatArea:this.repeatAreaQuality(),sum:this.totalQuality(),cultivatedArea:this.cultivateQuality(),proportion:0,greenOrganic:this.greenOrganicQuality(),target:this.landmarkQuality(),predictArea:this.estimateQuality(),expectedRatio:0}),this.tableData[this.tableData.length-1].proportion=this.tableData[this.tableData.length-1].sum/this.tableData[this.tableData.length-1].cultivatedArea,this.tableData[this.tableData.length-1].expectedRatio=this.tableData[this.tableData.length-1].predictArea/this.tableData[this.tableData.length-1].cultivatedArea},greenFoodQuality:function(){var e=0;return this.tableData.forEach((function(t){e+=-1==t.productName?0:t.productName})),e},organicAreaQuality:function(){var e=0;return this.tableData.forEach((function(t){e+=-1==t.organicArea?0:t.organicArea})),e},greenHighQuality:function(){var e=0;return this.tableData.forEach((function(t){e+=-1==t.highQualityArea?0:t.highQualityArea})),e},repeatAreaQuality:function(){var e=0;return this.tableData.forEach((function(t){e+=-1==t.repeatArea?0:t.repeatArea})),e},totalQuality:function(){var e=0;return this.tableData.forEach((function(t){e+=-1==t.sum?0:t.sum})),e},cultivateQuality:function(){var e=0;return this.tableData.forEach((function(t){e+=-1==t.cultivatedArea?0:t.cultivatedArea})),e},proportionQuality:function(){var e=0;return this.tableData.forEach((function(t){e+=-1==t.proportion?0:t.proportion})),e},greenOrganicQuality:function(){var e=0;return this.tableData.forEach((function(t){e+=-1==t.greenOrganic?0:t.greenOrganic})),e},landmarkQuality:function(){var e=0,t=0;return this.tableData.forEach((function(a){if(-1!=a.target)if(a.target.includes("%")){var i=a.target.split("%");e+=Number(i[0]),t+=Number(i[1].substring(1,i[1].length-1))}else isNaN(a.target)||(t+=Number(a.target))})),e>0?parseFloat(e).toFixed(2)+"%("+t+")":t},estimateQuality:function(){var e=0;return this.tableData.forEach((function(t){e+=-1==t.predictArea?0:t.predictArea})),e},objectSpanMethod:function(e){e.row,e.col;var t=e.rowIndex,a=e.columnIndex;if(t==this.tableData.length-1){if(0==a)return{rowspan:0,colspan:0};if(1==a)return{rowspan:1,colspan:2}}},expectedQuality:function(){var e=0;return this.tableData.forEach((function(t){e+=-1==t.expectedRatio?0:t.expectedRatio})),e},rowIndex:function(e){var t=e.row,a=e.rowIndex;t.rowIndex=a},order:function(e){return e.rowIndex+1}}}),z=M,L=(a("fa39"),Object(p["a"])(z,j,$,!1,null,null,null)),U=L.exports,H={name:"greenProducts",components:{animalHusbandryBase:m,greenAgriculturalProducts:v,greenFood:T,organicProduce:V,plantingGreenBase:P,plantingTownshipStatistics:U},data:function(){return{activeTabName:"greeFood",page:{pageIndex:1,pageSize:20},total:0,listLoading:!1,year:2019,options:[{value:2018},{value:2019},{value:2020},{value:2021},{value:2022},{value:2023}]}},created:function(){},methods:{getList:function(){this.listLoading=!1},getYear:function(){},handleClick:function(){},rowIndex:function(e){var t=e.row,a=e.rowIndex;t.rowIndex=a},order:function(e){return this.page.pageSize*(this.page.pageIndex-1)+e.rowIndex+1}}},B=H,q=(a("d53e"),Object(p["a"])(B,i,n,!1,null,null,null));t["default"]=q.exports},2550:function(e,t,a){},3846:function(e,t,a){a("9e1e")&&"g"!=/./g.flags&&a("86cc").f(RegExp.prototype,"flags",{configurable:!0,get:a("0bfb")})},"3b62":function(e,t,a){"use strict";var i=a("51a7"),n=a.n(i);n.a},"51a7":function(e,t,a){},"5ffa":function(e,t,a){},"66ec":function(e,t,a){"use strict";var i=a("1f0c"),n=a.n(i);n.a},"6b54":function(e,t,a){"use strict";a("3846");var i=a("cb7c"),n=a("0bfb"),r=a("9e1e"),o="toString",l=/./[o],s=function(e){a("2aba")(RegExp.prototype,o,e,!0)};a("79e5")((function(){return"/a/b"!=l.call({source:"a",flags:"b"})}))?s((function(){var e=i(this);return"/".concat(e.source,"/","flags"in e?e.flags:!r&&e instanceof RegExp?n.call(e):void 0)})):l.name!=o&&s((function(){return l.call(this)}))},"6b6c":function(e,t,a){},bdeb:function(e,t,a){},bf83:function(e,t,a){"use strict";var i=a("bdeb"),n=a.n(i);n.a},d53e:function(e,t,a){"use strict";var i=a("d784"),n=a.n(i);n.a},d784:function(e,t,a){},dfd2:function(e,t,a){"use strict";var i=a("5ffa"),n=a.n(i);n.a},fa39:function(e,t,a){"use strict";var i=a("6b6c"),n=a.n(i);n.a}}]);
//# sourceMappingURL=chunk-79771d3d.8990e37b.js.map
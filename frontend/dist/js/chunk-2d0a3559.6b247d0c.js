(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0a3559"],{"0278":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("div",{staticClass:"title"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[e._v("监管网格")]),a("el-breadcrumb-item",{staticClass:"actived"},[e._v("管理")])],1)],1),a("div",{staticClass:"box no-padding-bottom"},[a("div",{staticClass:"container no-padding-bottom"},[a("el-button",{attrs:{size:"small",type:"primary",plain:""},on:{click:function(t){return e.$router.go(-1)}}},[e._v("返回")])],1)]),a("el-dialog",{attrs:{visible:e.openDialog,width:"60%","before-close":e.handleClose,title:e.header},on:{"update:visible":function(t){e.openDialog=t}}},[a("el-form",{ref:"dynamicValidateForm",attrs:{model:e.dynamicValidateForm,"label-width":"100px"}},[e.showWebMaster?a("el-row",[a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{prop:"webMaster",label:"站长：",rules:{required:!0,message:"请插入",trigger:"change"}}},[a("el-input",{model:{value:e.dynamicValidateForm.webMaster,callback:function(t){e.$set(e.dynamicValidateForm,"webMaster",t)},expression:"dynamicValidateForm.webMaster"}})],1)],1)],1):e._e(),e._l(e.dynamicValidateForm.rowDatas,(function(t,i){return a("el-row",{key:i},[a("el-col",{attrs:{span:1}},[a("el-form-item",{staticClass:"margin-left-20"},[a("el-checkbox",{staticClass:"form-checkbox",attrs:{"true-label":"1","false-label":"0"},on:{change:function(t){return e.changeCheckStatus(i)}},model:{value:e.checked[i],callback:function(t){e.$set(e.checked,i,t)},expression:"checked[index]"}})],1)],1),a("el-col",{attrs:{span:7}},[a("el-form-item",{attrs:{label:"职能：",prop:"rowDatas."+i+".title",rules:{required:!0,message:"请插入",trigger:"blur"}}},[a("el-input",{model:{value:t.title,callback:function(a){e.$set(t,"title",a)},expression:"rowData.title"}})],1)],1),a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{label:"姓名:",prop:"rowDatas."+i+".name",rules:{required:!0,message:"请插入",trigger:"blur"}}},[a("el-input",{model:{value:t.name,callback:function(a){e.$set(t,"name",a)},expression:"rowData.name"}})],1)],1),a("el-col",{attrs:{span:4}},[a("el-form-item",{attrs:{label:"年龄:",prop:"rowDatas."+i+".age",rules:[{required:!0,message:"请插入"},{type:"number",message:"插入号码"}]}},[a("el-input",{model:{value:t.age,callback:function(a){e.$set(t,"age",e._n(a))},expression:"rowData.age"}})],1)],1),a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{label:"手机号:",prop:"rowDatas."+i+".phoneNumber",rules:{required:!0,message:"请插入",trigger:"blur"}}},[a("el-input",{model:{value:t.phoneNumber,callback:function(a){e.$set(t,"phoneNumber",a)},expression:"rowData.phoneNumber"}})],1)],1)],1)})),a("el-row",[a("el-col",{attrs:{span:15}})],1),a("el-form-item",{staticClass:"left-margin flex-box w-100 no-margin-IE"},[a("el-button",{attrs:{size:"small",type:"primary",plain:""},on:{click:function(t){return e.addFormRow()}}},[e._v("添加")]),a("el-button",{attrs:{size:"small",type:"danger",plain:""},on:{click:function(t){return e.deleteSelectedRows()}}},[e._v("删除")]),a("el-button",{staticClass:"margin-right-40",staticStyle:{float:"right"},attrs:{size:"small",type:"success",plain:""},on:{click:function(t){return e.onSubmit("dynamicValidateForm")}}},[e._v("保存")])],1)],2)],1),a("el-dialog",{attrs:{visible:e.confirm_dialogVisible,width:"30%",modal:""},on:{"update:visible":function(t){e.confirm_dialogVisible=t}}},[a("span",[a("i",{staticClass:"el-icon-warning"},[e._v(" 继续？请再次检查")])]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small",type:"primary",plain:""},on:{click:function(t){e.confirm_dialogVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{size:"small",type:"success",plain:""},on:{click:function(t){return e.updateSelectedRows()}}},[e._v("确认")])],1)]),a("div",{staticClass:"box"},[a("el-row",e._l(4,(function(t){return a("el-col",{key:t,attrs:{span:6}},[a("div",{staticClass:"container"},[a("div",{staticClass:"iptBox margin-bottom-10"},[a("div",{staticClass:"w-50 inline-block-IE"},[a("p",[e._v(e._s(e.supervisorType[t-1]))])]),a("div",{staticClass:"w-50 inline-block-IE text-right",staticStyle:{"margin-left":"auto"}},[a("el-button",{staticClass:"margin-left-60-IE",attrs:{size:"small",type:"success",plain:""},on:{click:function(a){return e.showDialog(e.tableData["group"+t],t)}}},[e._v("修改")])],1)]),a("el-container",[2!==t?a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData["group"+t],"highlight-current-row":""}},[a("el-table-column",{attrs:{prop:"title",label:e.functionName[t-1]}}),a("el-table-column",{attrs:{prop:"name",label:e.headerName[t-1]}})],1):2===t?a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData["group"+t],"highlight-current-row":""}},[a("el-table-column",{attrs:{prop:"title",label:"站长："+e.dynamicValidateForm.webMaster}},[a("el-table-column",{attrs:{prop:"title",label:e.functionName[t-1]}}),a("el-table-column",{attrs:{prop:"name",label:e.headerName[t-1]}})],1)],1):e._e()],1)],1)])})),1)],1)],1)},l=[],s=(a("55dd"),a("7f7f"),a("3b2b"),a("55a1")),o=(a("062e"),a("0010"),{name:"manageSupervisionGrid",data:function(){return{page:{pageIndex:1,pageSize:50},dynamicValidateForm:{rowDatas:[{id:null,title:"",name:"",age:null,phoneNumber:""}],webMaster:""},openDialog:!1,checked:[],selectedTownId:-1,total:0,tableData:{},listLoading:!1,supervisorType:["分管副镇长","农服办","站所","村级协管"],functionName:["职能","职能","站所","村"],headerName:["姓名","姓名","人员","协管员"],webMasterData:null,selectedRows:[],deletedRows:[],showWebMaster:!1,confirm_dialogVisible:!1,selectedSupervisupervisorType:null,header:""}},created:function(){this.selectedTownId=this.$route.params.id,this.getData()},methods:{getData:function(){var e=this;this.listLoading=!0,Object(s["a"])().get("/api/town/get/"+this.selectedTownId).then((function(t){var a=t,i=new RegExp(/(?<="level1":)(.*)(?=,"level2leader")/g),l=i.exec(a.superviseSystem),s=l?l[1]:"[]",o=new RegExp(/(?<="level2leader":)(.*)(?=,"level2")/g),r=o.exec(a.superviseSystem),n=r?r[1]:{},c=new RegExp(/(?<="level2":)(.*)(?=,"level3")/g),d=c.exec(a.superviseSystem),u=d?d[1]:"[]",m=new RegExp(/(?<="level3":)(.*)(?=,"level4")/g),p=m.exec(a.superviseSystem),h=p?p[1]:"[]",g=new RegExp(/(?<="level4":)(.*)(?=}")/g),b=g.exec(a.superviseSystem),w=b?b[1]:"[]";a["level2leader"]=JSON.parse(n),a["level2leader"]["name"]?(e.webMasterData=a["level2leader"],e.dynamicValidateForm.webMaster=a["level2leader"]["name"]):(e.webMasterData="",e.dynamicValidateForm.webMaster=""),a["group1"]=JSON.parse(s),a["group2"]=JSON.parse(u),a["group3"]=JSON.parse(h),a["group4"]=JSON.parse(w),e.tableData=a,setTimeout((function(){e.listLoading=!1}),500)})).catch((function(e){console.log(e)}))},addFormRow:function(){this.dynamicValidateForm.rowDatas.push({id:null,title:"",name:"",age:null,phoneNumber:"",$$hashKey:""})},showDialog:function(e,t){this.showWebMaster=2===t,this.selectedSupervisupervisorType=t,this.dynamicValidateForm.rowDatas=e,this.openDialog=!0,this.header=this.supervisorType[t-1]},changeCheckStatus:function(e){var t=this.selectedRows.indexOf(e);t>-1&&this.selectedRows.splice(t,1),1==this.checked[e]&&this.selectedRows.push(e)},deleteSelectedRows:function(){if(this.selectedRows.length){for(var e in this.selectedRows=this.selectedRows.sort((function(e,t){return e>t?-1:1})),this.selectedRows){var t=this.dynamicValidateForm.rowDatas[this.selectedRows[e]].id;t&&this.deletedRows.push(t),this.checked[this.selectedRows[e]]=!1,this.dynamicValidateForm.rowDatas.splice(this.selectedRows[e],1)}this.selectedRows=[]}},onSubmit:function(e){var t=this;console.log(this.dynamicValidateForm.rowDatas),this.$refs[e].validate((function(e){e&&(t.confirm_dialogVisible=!0)}))},updateSelectedRows:function(){var e=this;if(this.confirm_dialogVisible=!1,this.openDialog=!1,this.dynamicValidateForm.rowDatas.length){this.listLoading=!0;for(var t={},a=1;a<5;a++)this.selectedSupervisupervisorType==a?t["level"+a]=this.dynamicValidateForm.rowDatas:t["level"+a]=this.tableData["group"+a],1==a&&(t["level2leader"]={name:this.dynamicValidateForm.webMaster});Object(s["a"])().put("/api/town/update/"+this.selectedTownId,{divisionCode:this.tableData.divisionCode,id:this.selectedTownId,name:this.tableData.name,superviseSystem:JSON.stringify(t)}).then((function(t){setTimeout((function(){e.listLoading=!1}),500),e.getData()}))}},handleClose:function(e){var t=this;this.$confirm("您确定要关闭此对话框吗？").then((function(a){t.getData(),t.deletedRows=[],e()})).catch((function(e){}))}}}),r=o,n=a("2877"),c=Object(n["a"])(r,i,l,!1,null,null,null);t["default"]=c.exports}}]);
//# sourceMappingURL=chunk-2d0a3559.6b247d0c.js.map